<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>firebird.driver.interfaces &#8212; firebird-driver 1.9.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/bootstrap-sphinx.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../../_static/bootstrap-2.3.2/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>

        <a class="brand" href="../../../index.html">
          firebird-driver</a>
        <span class="navbar-text pull-left"><b>1.9.0</b></span>

        <div class="nav-collapse">
          <ul class="nav">
            <li class="divider-vertical"></li>
            
                <li><a href="../../../usage-guide.html">Usage Guide</a></li>
                <li><a href="../../../reference.html">Reference</a></li>
                <li><a href="../../../genindex.html">Index</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">Content <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../getting-started.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../getting-started.html#installation">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../getting-started.html#installation-from-pypi">Installation from PYPI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../getting-started.html#quick-start-guide">Quick-start Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../getting-started.html#driver-configuration">Driver configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../getting-started.html#connecting-to-a-database">Connecting to a Database</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../getting-started.html#creating-a-database">Creating a Database</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../getting-started.html#executing-sql-statements">Executing SQL Statements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../getting-started.html#calling-stored-procedures">Calling Stored Procedures</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage-guide.html">Usage Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../usage-guide.html#driver-structure">Driver structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../usage-guide.html#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#the-driver-config-object">The ‘driver_config’ object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#server-and-database-configuration">Server and database configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../usage-guide.html#databases">Databases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#using-connect">Using connect()</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#using-create-database">Using create_database()</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#deleting-databases">Deleting databases</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#connection-object">Connection object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#closing-the-connection">Closing the connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#getting-information-about-connection">Getting information about connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#getting-information-about-database">Getting information about database</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../usage-guide.html#executing-sql-statements">Executing SQL Statements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#cursor-object">Cursor object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#sql-execution-basics">SQL Execution Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#fetching-data-from-server">Fetching data from server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#index-13">Scrollable cursors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#id3">Parameterized statements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#id5">Prepared Statements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#named-cursors">Named Cursors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#working-with-stored-procedures">Working with stored procedures</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../usage-guide.html#data-handling-and-conversions">Data handling and conversions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#implicit-conversion-of-input-parameters-from-strings">Implicit Conversion of Input Parameters from Strings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#automatic-conversion-from-to-unicode">Automatic conversion from/to Unicode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#working-with-blobs">Working with BLOBs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#firebird-array-type">Firebird ARRAY type</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../usage-guide.html#transanction-management">Transanction management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#basics">Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#auto-commit">Auto-commit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#transaction-parameters">Transaction parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#getting-information-about-transaction">Getting information about transaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#retaining-transactions">Retaining transactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#savepoints">Savepoints</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#using-multiple-transactions-with-the-same-connection">Using multiple transactions with the same connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#distributed-transactions">Distributed Transactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#transaction-context-manager">Transaction Context Manager</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../usage-guide.html#database-events">Database Events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#what-they-are">What they are</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#why-use-them">Why use them</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#how-events-are-exposed">How events are exposed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#api-for-python-developers">API for Python developers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../usage-guide.html#working-with-services">Working with Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#services-api-connections">Services API Connections</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#text-output-from-services">Text output from Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#server-configuration-and-state-information">Server Configuration and State information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#database-options">Database options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#database-maintenance">Database maintenance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#user-maintenance">User maintenance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#trace-sessions">Trace sessions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../usage-guide.html#logging-driver-activities">Logging driver activities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../usage-guide.html#index-43">Driver hooks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#apihook">APIHook</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#connectionhook">ConnectionHook</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../usage-guide.html#serverhook">ServerHook</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../python-db-api-compliance.html">Compliance to PyDB API 2.0</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../python-db-api-compliance.html#unsupported-optional-features">Unsupported Optional Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../python-db-api-compliance.html#supported-optional-features">Supported Optional Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../python-db-api-compliance.html#nominally-supported-optional-features">Nominally Supported Optional Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../python-db-api-compliance.html#extensions-and-caveats">Extensions and Caveats</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference.html">Firebird-driver Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../reference.html#driver-modules">Driver modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../ref-main.html">Main driver namespace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ref-types.html">firebird.driver.types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ref-config.html">firebird.driver.config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ref-core.html">firebird.driver.core</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ref-hooks.html">firebird.driver.hooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ref-intf.html">firebird.driver.interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../ref-fbapi.html">firebird.driver.fbapi</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-1-9-0">Version 1.9.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-1-8-0">Version 1.8.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-1-7-0">Version 1.7.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-1-6-0">Version 1.6.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-1-5-2">Version 1.5.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-1-5-1">Version 1.5.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-1-5-0">Version 1.5.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#potentially-breaking-changes">Potentially breaking changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-1-4-3">Version 1.4.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-1-4-2">Version 1.4.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-1-4-1">Version 1.4.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-1-4-0">Version 1.4.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#improvements">Improvements:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../changelog.html#backward-incompatible-changes">Backward incompatible changes:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-1-3-4">Version 1.3.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-1-3-3">Version 1.3.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-1-3-2">Version 1.3.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-1-3-1">Version 1.3.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-1-3-0">Version 1.3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-1-2-1">Version 1.2.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-1-2-0">Version 1.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-1-1-0">Version 1.1.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-1-0-0">Version 1.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-0-8-0">Version 0.8.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-0-7-0">Version 0.7.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-0-6-0">Version 0.6.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../changelog.html#version-0-5-0">Version 0.5.0</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
      </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body span12 content" role="main">
      
  <h1>Source code for firebird.driver.interfaces</h1><div class="highlight"><pre>
<span></span><span class="c1"># coding:utf-8</span>
<span class="c1">#</span>
<span class="c1"># PROGRAM/MODULE: firebird-driver</span>
<span class="c1"># FILE:           firebird/driver/interfaces.py</span>
<span class="c1"># DESCRIPTION:    Interface wrappers for Firebird new API</span>
<span class="c1"># CREATED:        11.6.2020</span>
<span class="c1">#</span>
<span class="c1"># The contents of this file are subject to the MIT License</span>
<span class="c1">#</span>
<span class="c1"># Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="c1"># of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="c1"># in the Software without restriction, including without limitation the rights</span>
<span class="c1"># to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
<span class="c1"># copies of the Software, and to permit persons to whom the Software is</span>
<span class="c1"># furnished to do so, subject to the following conditions:</span>
<span class="c1">#</span>
<span class="c1"># The above copyright notice and this permission notice shall be included in all</span>
<span class="c1"># copies or substantial portions of the Software.</span>
<span class="c1">#</span>
<span class="c1"># THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="c1"># IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="c1"># FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span class="c1"># AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class="c1"># LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
<span class="c1"># OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
<span class="c1"># SOFTWARE.</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020 Firebird Project (www.firebirdsql.org)</span>
<span class="c1"># All Rights Reserved.</span>
<span class="c1">#</span>
<span class="c1"># Contributor(s): Pavel Císař (original code)</span>
<span class="c1">#                 ______________________________________</span>
<span class="c1"># pylint: disable=C0302, W0212, R0902, R0912,R0913, R0914, R0915, R0904</span>

<span class="sd">&quot;&quot;&quot;firebird-driver - Interface wrappers for Firebird new API</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">ByteString</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">warnings</span> <span class="kn">import</span> <span class="n">warn</span>
<span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">suppress</span>
<span class="kn">from</span> <span class="nn">ctypes</span> <span class="kn">import</span> <span class="n">memmove</span><span class="p">,</span> <span class="n">memset</span><span class="p">,</span> <span class="n">create_string_buffer</span><span class="p">,</span> <span class="n">cast</span><span class="p">,</span> <span class="n">byref</span><span class="p">,</span> <span class="n">string_at</span><span class="p">,</span> <span class="n">sizeof</span><span class="p">,</span> \
     <span class="n">c_char_p</span><span class="p">,</span> <span class="n">c_void_p</span><span class="p">,</span> <span class="n">c_byte</span><span class="p">,</span> <span class="n">c_ulong</span>
<span class="kn">from</span> <span class="nn">.types</span> <span class="kn">import</span> <span class="n">Error</span><span class="p">,</span> <span class="n">DatabaseError</span><span class="p">,</span> <span class="n">InterfaceError</span><span class="p">,</span> <span class="n">FirebirdWarning</span><span class="p">,</span> <span class="n">BCD</span><span class="p">,</span> \
     <span class="n">StateResult</span><span class="p">,</span> <span class="n">DirectoryCode</span><span class="p">,</span> <span class="n">BlobInfoCode</span><span class="p">,</span> <span class="n">SQLDataType</span><span class="p">,</span> <span class="n">XpbKind</span><span class="p">,</span> \
     <span class="n">StatementType</span><span class="p">,</span> <span class="n">StateFlag</span><span class="p">,</span> <span class="n">CursorFlag</span><span class="p">,</span> <span class="n">StatementFlag</span><span class="p">,</span> <span class="n">PreparePrefetchFlag</span><span class="p">,</span> <span class="n">get_timezone</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">fbapi</span> <span class="k">as</span> <span class="n">a</span>
<span class="kn">from</span> <span class="nn">.hooks</span> <span class="kn">import</span> <span class="n">APIHook</span><span class="p">,</span> <span class="n">add_hook</span>

<span class="c1"># Internal</span>
<span class="n">_master</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">_util</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">_thns</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">local</span><span class="p">()</span>

<span class="c1"># Info structural codes</span>
<span class="n">isc_info_end</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># ------------------------------------------------------------------------------</span>
<span class="c1"># Interface wrappers</span>
<span class="c1"># ------------------------------------------------------------------------------</span>
<div class="viewcode-block" id="iVersionedMeta"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iVersionedMeta">[docs]</a><span class="k">class</span> <span class="nc">iVersionedMeta</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Metaclass for iVersioned interfaces.</span>

<span class="sd">This metaclass uses MRO to instantiate wrapper interface with version that matches version</span>
<span class="sd">of wrapped interface.</span>
<span class="sd">&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">iVersioned</span><span class="p">,</span> <span class="n">intf</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">intf</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">version</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__mro__</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s1">&#39;VERSION&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">v</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">iVersionedMeta</span><span class="p">,</span> <span class="n">iVersionedMeta</span><span class="p">)</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">intf</span><span class="p">)</span>
                <span class="c1">#print(f&quot;{result.__class__.__name__}.{getattr(c, &#39;VERSION&#39;, 0)}&quot;)</span>
                <span class="k">return</span> <span class="n">result</span>
                <span class="c1">#return super(iVersionedMeta, iVersionedMeta).__call__(c, intf)</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<span class="c1"># IVersioned(1)</span>
<div class="viewcode-block" id="iVersioned"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iVersioned">[docs]</a><span class="k">class</span> <span class="nc">iVersioned</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">iVersionedMeta</span><span class="p">):</span>
    <span class="s2">&quot;IVersioned interface wrapper&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">intf</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_as_parameter_</span> <span class="o">=</span> <span class="n">intf</span>
        <span class="k">if</span> <span class="n">intf</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">version</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">VERSION</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="n">InterfaceError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrong interface version </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">version</span><span class="si">}</span><span class="s2">, expected </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">VERSION</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Error</span><span class="p">,</span> <span class="n">FirebirdWarning</span><span class="p">],</span> <span class="n">vector_ptr</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_STATUS_ARRAY_PTR</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">_util</span><span class="o">.</span><span class="n">format_status</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="n">sqlstate</span> <span class="o">=</span> <span class="n">create_string_buffer</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">fb_sqlstate</span><span class="p">(</span><span class="n">sqlstate</span><span class="p">,</span> <span class="n">vector_ptr</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">gds_codes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sqlcode</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">isc_sqlcode</span><span class="p">(</span><span class="n">vector_ptr</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">vector_ptr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vector_ptr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">vector_ptr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x14000000</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x14000000</span><span class="p">:</span>
                    <span class="n">gds_codes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vector_ptr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">vector_ptr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">335544436</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">vector_ptr</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">):</span>
                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>
                        <span class="n">sqlcode</span> <span class="o">=</span> <span class="n">vector_ptr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># We need to clean up the iStatus before returning</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">sqlstate</span><span class="o">=</span><span class="n">sqlstate</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(),</span>
                   <span class="n">gds_codes</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">gds_codes</span><span class="p">),</span> <span class="n">sqlcode</span><span class="o">=</span><span class="n">sqlcode</span><span class="p">,)</span>
    <span class="k">def</span> <span class="nf">_check</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">get_state</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">StateFlag</span><span class="o">.</span><span class="n">ERRORS</span> <span class="ow">in</span> <span class="n">state</span><span class="p">:</span>
            <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">__report</span><span class="p">(</span><span class="n">DatabaseError</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">get_errors</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">StateFlag</span><span class="o">.</span><span class="n">WARNINGS</span> <span class="ow">in</span> <span class="n">state</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="c1">#raise self.__report(FirebirdWarning, self.status.get_warning())</span>
            <span class="n">warn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__report</span><span class="p">(</span><span class="n">FirebirdWarning</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">get_warning</span><span class="p">()),</span>
                 <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">status</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iStatus</span><span class="p">:</span>
        <span class="s2">&quot;iStatus for interface&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">_thns</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">_master</span><span class="o">.</span><span class="n">get_status</span><span class="p">()</span>
            <span class="n">_thns</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">result</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vtable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Interface method table&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_parameter_</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">contents</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Interface version&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_parameter_</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">value</span></div>

<span class="c1"># IReferenceCounted(2)</span>
<div class="viewcode-block" id="iReferenceCounted"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iReferenceCounted">[docs]</a><span class="k">class</span> <span class="nc">iReferenceCounted</span><span class="p">(</span><span class="n">iVersioned</span><span class="p">):</span>
    <span class="s2">&quot;IReferenceCounted interface wrapper&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">intf</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">intf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iReferenceCounted</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
<div class="viewcode-block" id="iReferenceCounted.add_ref"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iReferenceCounted.add_ref">[docs]</a>    <span class="k">def</span> <span class="nf">add_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Increase the reference by one&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">addRef</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">IReferenceCounted</span><span class="p">))</span></div>
<div class="viewcode-block" id="iReferenceCounted.release"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iReferenceCounted.release">[docs]</a>    <span class="k">def</span> <span class="nf">release</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Decrease the reference by one&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">release</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">IReferenceCounted</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span></div></div>

<span class="c1"># IDisposable(2)</span>
<div class="viewcode-block" id="iDisposable"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iDisposable">[docs]</a><span class="k">class</span> <span class="nc">iDisposable</span><span class="p">(</span><span class="n">iVersioned</span><span class="p">):</span>
    <span class="s2">&quot;IDisposable interface wrapper&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">intf</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">intf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_disposed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_disposed</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dispose</span><span class="p">()</span>
    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dispose</span><span class="p">()</span>
<div class="viewcode-block" id="iDisposable.dispose"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iDisposable.dispose">[docs]</a>    <span class="k">def</span> <span class="nf">dispose</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Dispose the interfaced object&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_disposed</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">dispose</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">IDisposable</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_disposed</span> <span class="o">=</span> <span class="kc">True</span></div></div>

<span class="c1"># IStatus(3) : Disposable</span>
<div class="viewcode-block" id="iStatus"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatus">[docs]</a><span class="k">class</span> <span class="nc">iStatus</span><span class="p">(</span><span class="n">iDisposable</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class that wraps IStatus interface for use from Python</span>

<span class="sd">    IStatus replaces ISC_STATUS_ARRAY. Functionality is extended – Status has separate</span>
<span class="sd">    access to errors and warnings vectors, can hold vectors of unlimited length, itself</span>
<span class="sd">    stores strings used in vectors avoiding need in circular strings buffer. Interface is</span>
<span class="sd">    on purpose minimized (methods like convert it to text are moved to Util interface) in</span>
<span class="sd">    order to simplify it&#39;s implementation by users when needed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
<div class="viewcode-block" id="iStatus.init"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatus.init">[docs]</a>    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Cleanup interface, set it to initial state&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>
<div class="viewcode-block" id="iStatus.get_state"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatus.get_state">[docs]</a>    <span class="k">def</span> <span class="nf">get_state</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StateFlag</span><span class="p">:</span>
        <span class="s2">&quot;Returns state flags, may be OR-ed.&quot;</span>
        <span class="k">return</span> <span class="n">StateFlag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getState</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>
<div class="viewcode-block" id="iStatus.set_errors2"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatus.set_errors2">[docs]</a>    <span class="k">def</span> <span class="nf">set_errors2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">ByteString</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Set contents of errors vector with length explicitly specified in a call&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setErrors2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="iStatus.set_warning2"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatus.set_warning2">[docs]</a>    <span class="k">def</span> <span class="nf">set_warning2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">ByteString</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Set contents of warnings vector with length explicitly specified in a call&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setWarnings2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="iStatus.set_errors"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatus.set_errors">[docs]</a>    <span class="k">def</span> <span class="nf">set_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">ByteString</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Set contents of errors vector, length is defined by value context&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setErrors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="iStatus.set_warnings"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatus.set_warnings">[docs]</a>    <span class="k">def</span> <span class="nf">set_warnings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">ByteString</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Set contents of warnings vector, length is defined by value context&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setWarnings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="iStatus.get_errors"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatus.get_errors">[docs]</a>    <span class="k">def</span> <span class="nf">get_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_STATUS_ARRAY_PTR</span><span class="p">:</span>
        <span class="s2">&quot;Returns errors vector&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getErrors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>
<div class="viewcode-block" id="iStatus.get_warning"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatus.get_warning">[docs]</a>    <span class="k">def</span> <span class="nf">get_warning</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_STATUS_ARRAY_PTR</span><span class="p">:</span>
        <span class="s2">&quot;Returns warnings vector&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getWarnings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>
<div class="viewcode-block" id="iStatus.clone"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatus.clone">[docs]</a>    <span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iStatus</span><span class="p">:</span>
        <span class="s2">&quot;Create clone of current interface&quot;</span>
        <span class="k">return</span> <span class="n">iStatus</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div></div>

<span class="c1"># IPluginBase(3) : ReferenceCounted</span>
<div class="viewcode-block" id="iPluginBase"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iPluginBase">[docs]</a><span class="k">class</span> <span class="nc">iPluginBase</span><span class="p">(</span><span class="n">iReferenceCounted</span><span class="p">):</span>
    <span class="s2">&quot;IPluginBase interface wrapper&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
<div class="viewcode-block" id="iPluginBase.set_owner"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iPluginBase.set_owner">[docs]</a>    <span class="k">def</span> <span class="nf">set_owner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="n">iReferenceCounted</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Set the owner&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setOwner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span></div>
<div class="viewcode-block" id="iPluginBase.get_owner"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iPluginBase.get_owner">[docs]</a>    <span class="k">def</span> <span class="nf">get_owner</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iReferenceCounted</span><span class="p">:</span>
        <span class="s2">&quot;Returns owner&quot;</span>
        <span class="k">return</span> <span class="n">iReferenceCounted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getOwner</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div></div>

<span class="c1"># IConfigEntry(3) : ReferenceCounted</span>
<div class="viewcode-block" id="iConfigEntry"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iConfigEntry">[docs]</a><span class="k">class</span> <span class="nc">iConfigEntry</span><span class="p">(</span><span class="n">iReferenceCounted</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IConfigEntry interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
<div class="viewcode-block" id="iConfigEntry.get_name"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iConfigEntry.get_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s2">&quot;Returns key name&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span></div>
<div class="viewcode-block" id="iConfigEntry.get_value"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iConfigEntry.get_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s2">&quot;Returnd value string value&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span></div>
<div class="viewcode-block" id="iConfigEntry.get_int_value"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iConfigEntry.get_int_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_int_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Returns value as integer&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getIntValue</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">value</span></div>
<div class="viewcode-block" id="iConfigEntry.get_bool_value"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iConfigEntry.get_bool_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_bool_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s2">&quot;Returns value as boolean&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getBoolValue</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">value</span></div>
<div class="viewcode-block" id="iConfigEntry.get_sub_config"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iConfigEntry.get_sub_config">[docs]</a>    <span class="k">def</span> <span class="nf">get_sub_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">:</span> <span class="n">iStatus</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iConfig</span><span class="p">:</span>
        <span class="s2">&quot;Treats sub-entries as separate configuration file and returns IConfig interface for it&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">iConfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getSubConfig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span></div></div>

<span class="c1"># IConfig(3) : ReferenceCounted</span>
<div class="viewcode-block" id="iConfig"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iConfig">[docs]</a><span class="k">class</span> <span class="nc">iConfig</span><span class="p">(</span><span class="n">iReferenceCounted</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IConfig interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
<div class="viewcode-block" id="iConfig.find"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iConfig.find">[docs]</a>    <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iConfigEntry</span><span class="p">:</span>
        <span class="s2">&quot;Find entry by name&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iConfigEntry</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iConfig.find_value"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iConfig.find_value">[docs]</a>    <span class="k">def</span> <span class="nf">find_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iConfigEntry</span><span class="p">:</span>
        <span class="s2">&quot;Find entry by name and value&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">findValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iConfigEntry</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iConfig.find_pos"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iConfig.find_pos">[docs]</a>    <span class="k">def</span> <span class="nf">find_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iConfigEntry</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find entry by name and position.</span>
<span class="sd">If configuration file contains lines::</span>

<span class="sd">  Db=DBA</span>
<span class="sd">  Db=DBB</span>
<span class="sd">  Db=DBC</span>

<span class="sd">call to `find_pos(status, “Db”, 2)` will return entry with value DBB.</span>
<span class="sd">&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">findPos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iConfigEntry</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div></div>

<span class="c1"># IFirebirdConf(3) : ReferenceCounted</span>
<div class="viewcode-block" id="iFirebirdConf_v3"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iFirebirdConf_v3">[docs]</a><span class="k">class</span> <span class="nc">iFirebirdConf_v3</span><span class="p">(</span><span class="n">iReferenceCounted</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IFirebirdConf v3 interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
<div class="viewcode-block" id="iFirebirdConf_v3.get_key"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iFirebirdConf_v3.get_key">[docs]</a>    <span class="k">def</span> <span class="nf">get_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns key for configuration parameter.</span>

<span class="sd">Note:</span>
<span class="sd">    If parameter with given name does not exists, returns 0xffffffff.</span>
<span class="sd">&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getKey</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span></div>
<div class="viewcode-block" id="iFirebirdConf_v3.as_integer"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iFirebirdConf_v3.as_integer">[docs]</a>    <span class="k">def</span> <span class="nf">as_integer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Returns integer value of conf. parameter&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">asInteger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span></div>
<div class="viewcode-block" id="iFirebirdConf_v3.as_string"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iFirebirdConf_v3.as_string">[docs]</a>    <span class="k">def</span> <span class="nf">as_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s2">&quot;Returns string value of conf. parameter&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">asString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">value</span></div>
<div class="viewcode-block" id="iFirebirdConf_v3.as_boolean"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iFirebirdConf_v3.as_boolean">[docs]</a>    <span class="k">def</span> <span class="nf">as_boolean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s2">&quot;Returns boolean value of conf. parameter&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">asBoolean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span></div></div>

<span class="c1"># IFirebirdConf(4) : IFirebirdConf(3)</span>
<div class="viewcode-block" id="iFirebirdConf"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iFirebirdConf">[docs]</a><span class="k">class</span> <span class="nc">iFirebirdConf</span><span class="p">(</span><span class="n">iFirebirdConf_v3</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IFirebirdConf v4 interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">4</span>
<div class="viewcode-block" id="iFirebirdConf.get_version"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iFirebirdConf.get_version">[docs]</a>    <span class="k">def</span> <span class="nf">get_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Returns configuration version&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">asBoolean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div></div>

<span class="c1"># &gt;&gt;&gt; Firebird 4</span>
<span class="c1"># IPluginManager(2) : Versioned</span>
<div class="viewcode-block" id="iPluginManager"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iPluginManager">[docs]</a><span class="k">class</span> <span class="nc">iPluginManager</span><span class="p">(</span><span class="n">iVersioned</span><span class="p">):</span>
    <span class="s2">&quot;IPluginManager interface wrapper. This is only STUB.&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">2</span></div>

<span class="c1"># IConfigManager(2) : Versioned</span>
<div class="viewcode-block" id="iConfigManager_v2"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iConfigManager_v2">[docs]</a><span class="k">class</span> <span class="nc">iConfigManager_v2</span><span class="p">(</span><span class="n">iVersioned</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IConfigManager v2 interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">2</span>
<div class="viewcode-block" id="iConfigManager_v2.get_directory"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iConfigManager_v2.get_directory">[docs]</a>    <span class="k">def</span> <span class="nf">get_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dirspec</span><span class="p">:</span> <span class="n">DirectoryCode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s2">&quot;Returns location of appropriate directory in current firebird instance&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getDirectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">(</span><span class="n">dirspec</span><span class="p">))</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span></div>
<div class="viewcode-block" id="iConfigManager_v2.get_firebird_conf"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iConfigManager_v2.get_firebird_conf">[docs]</a>    <span class="k">def</span> <span class="nf">get_firebird_conf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iFirebirdConf</span><span class="p">:</span>
        <span class="s2">&quot;Returns interface to access default configuration values (from firebird.conf)&quot;</span>
        <span class="k">return</span> <span class="n">iFirebirdConf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getFirebirdConf</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>
<div class="viewcode-block" id="iConfigManager_v2.get_database_conf"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iConfigManager_v2.get_database_conf">[docs]</a>    <span class="k">def</span> <span class="nf">get_database_conf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iFirebirdConf</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns interface to access db-specific configuration.</span>
<span class="sd">Takes into an account firebird.conf and appropriate part of databases.conf.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">iFirebirdConf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getDatabaseConf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database</span><span class="o">.</span><span class="n">encode</span><span class="p">()))</span></div>
<div class="viewcode-block" id="iConfigManager_v2.get_plugin_config"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iConfigManager_v2.get_plugin_config">[docs]</a>    <span class="k">def</span> <span class="nf">get_plugin_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plugin</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iConfig</span><span class="p">:</span>
        <span class="s2">&quot;Returns interface to access named plugin configuration&quot;</span>
        <span class="k">return</span> <span class="n">iConfig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getPluginConfig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plugin</span><span class="o">.</span><span class="n">encode</span><span class="p">()))</span></div>
<div class="viewcode-block" id="iConfigManager_v2.get_install_directory"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iConfigManager_v2.get_install_directory">[docs]</a>    <span class="k">def</span> <span class="nf">get_install_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s2">&quot;Returns directory where firebird is installed&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getInstallDirectory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span></div>
<div class="viewcode-block" id="iConfigManager_v2.get_root_directory"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iConfigManager_v2.get_root_directory">[docs]</a>    <span class="k">def</span> <span class="nf">get_root_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s2">&quot;Returns root directory of current instance, in single-instance case usually matches install directory&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getRootDirectory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span></div></div>

<span class="c1"># &gt;&gt;&gt; Firebird 4</span>
<span class="c1"># IConfigManager(3) : IConfigManager(2)</span>
<div class="viewcode-block" id="iConfigManager"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iConfigManager">[docs]</a><span class="k">class</span> <span class="nc">iConfigManager</span><span class="p">(</span><span class="n">iConfigManager_v2</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IConfigManager v3 interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
<div class="viewcode-block" id="iConfigManager.get_default_security_db"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iConfigManager.get_default_security_db">[docs]</a>    <span class="k">def</span> <span class="nf">get_default_security_db</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s2">&quot;Returns default security database.&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getDefaultSecurityDb</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span></div></div>

<span class="c1"># IBlob(3) : ReferenceCounted</span>
<div class="viewcode-block" id="iBlob_v3"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBlob_v3">[docs]</a><span class="k">class</span> <span class="nc">iBlob_v3</span><span class="p">(</span><span class="n">iReferenceCounted</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IBlob interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
<div class="viewcode-block" id="iBlob_v3.get_info"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBlob_v3.get_info">[docs]</a>    <span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">buffer</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_blob_info()`&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">),</span> <span class="n">items</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">buffer</span><span class="p">),</span> <span class="n">buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iBlob_v3.get_segment"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBlob_v3.get_segment">[docs]</a>    <span class="k">def</span> <span class="nf">get_segment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">buffer</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">,</span> <span class="n">bytes_read</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StateResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Replaces `isc_get_segment()`. Unlike it never returns `isc_segstr_eof`</span>
<span class="sd">        and `isc_segment` errors (that are actually not errors), instead returns completion</span>
<span class="sd">        codes `.StateResult.NO_DATA` and `.StateResult.SEGMENT`, normal return is `.StateResult.OK`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getSegment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">bytes_read</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">StateResult</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iBlob_v3.put_segment"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBlob_v3.put_segment">[docs]</a>    <span class="k">def</span> <span class="nf">put_segment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">buffer</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_put_segment()`&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">putSegment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iBlob_v3.cancel"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBlob_v3.cancel">[docs]</a>    <span class="k">def</span> <span class="nf">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_cancel_blob()`. On success releases interface.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">deprecatedCancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span></div>
<div class="viewcode-block" id="iBlob_v3.close"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBlob_v3.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_close_blob()`. On success releases interface.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">deprecatedClose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span></div>
<div class="viewcode-block" id="iBlob_v3.seek"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBlob_v3.seek">[docs]</a>    <span class="k">def</span> <span class="nf">seek</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Replaces isc_seek_blob()&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iBlob_v3.get_info2"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBlob_v3.get_info2">[docs]</a>    <span class="k">def</span> <span class="nf">get_info2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="n">BlobInfoCode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="s2">&quot;Returns information about BLOB&quot;</span>
        <span class="n">blob_info</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;little&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_info</span><span class="p">(</span><span class="nb">bytes</span><span class="p">([</span><span class="n">code</span><span class="p">]),</span> <span class="n">blob_info</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">blob_info</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">isc_info_end</span><span class="p">:</span>
            <span class="n">_code</span> <span class="o">=</span> <span class="n">blob_info</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">_code</span> <span class="o">==</span> <span class="n">code</span><span class="p">:</span>
                <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">blob_info</span><span class="p">[</span><span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;little&#39;</span><span class="p">)</span>
                <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">blob_info</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">size</span><span class="p">],</span> <span class="s1">&#39;little&#39;</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="n">size</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="n">result</span></div></div>

<span class="c1"># IBlob(4) : IBlob(3)</span>
<div class="viewcode-block" id="iBlob"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBlob">[docs]</a><span class="k">class</span> <span class="nc">iBlob</span><span class="p">(</span><span class="n">iBlob_v3</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IBlob interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">4</span>
<div class="viewcode-block" id="iBlob.cancel"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBlob.cancel">[docs]</a>    <span class="k">def</span> <span class="nf">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_cancel_blob()`. On success releases interface.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span></div>
<div class="viewcode-block" id="iBlob.close"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBlob.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_close_blob()`. On success releases interface.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span></div></div>

<span class="c1"># ITransaction(3) : ReferenceCounted</span>
<div class="viewcode-block" id="iTransaction_v3"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iTransaction_v3">[docs]</a><span class="k">class</span> <span class="nc">iTransaction_v3</span><span class="p">(</span><span class="n">iReferenceCounted</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps ITransaction interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
<div class="viewcode-block" id="iTransaction_v3.get_info"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iTransaction_v3.get_info">[docs]</a>    <span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">buffer</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_transaction_info()`&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">),</span> <span class="n">items</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">buffer</span><span class="p">),</span> <span class="n">buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iTransaction_v3.prepare"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iTransaction_v3.prepare">[docs]</a>    <span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_prepare_transaction2()`&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">),</span> <span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iTransaction_v3.commit"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iTransaction_v3.commit">[docs]</a>    <span class="k">def</span> <span class="nf">commit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_commit_transaction()`&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">deprecatedCommit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span></div>
<div class="viewcode-block" id="iTransaction_v3.commit_retaining"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iTransaction_v3.commit_retaining">[docs]</a>    <span class="k">def</span> <span class="nf">commit_retaining</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_commit_retaining()`&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">commitRetaining</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iTransaction_v3.rollback"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iTransaction_v3.rollback">[docs]</a>    <span class="k">def</span> <span class="nf">rollback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_rollback_transaction()`&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">deprecatedRollback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span></div>
<div class="viewcode-block" id="iTransaction_v3.rollback_retaining"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iTransaction_v3.rollback_retaining">[docs]</a>    <span class="k">def</span> <span class="nf">rollback_retaining</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_rollback_retaining()`&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">rollbackRetaining</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iTransaction_v3.disconnect"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iTransaction_v3.disconnect">[docs]</a>    <span class="k">def</span> <span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `fb_disconnect_transaction()`&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">deprecatedDisconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iTransaction_v3.join"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iTransaction_v3.join">[docs]</a>    <span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">iTransaction</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iTransaction</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Joins current transaction and passed as parameter transaction into</span>
<span class="sd">single distributed transaction (using Dtc). On success both current transaction</span>
<span class="sd">and passed as parameter transaction are released and should not be used any more.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">transaction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">transaction</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">iTransaction</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iTransaction_v3.validate"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iTransaction_v3.validate">[docs]</a>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attachment</span><span class="p">:</span> <span class="n">iAttachment</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iTransaction</span><span class="p">:</span>
        <span class="s2">&quot;This method is used to support distributed transactions coordinator&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">attachment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="iTransaction_v3.enter_dtc"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iTransaction_v3.enter_dtc">[docs]</a>    <span class="k">def</span> <span class="nf">enter_dtc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iTransaction</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
        <span class="s2">&quot;This method is used to support distributed transactions coordinator&quot;</span>
        <span class="k">raise</span> <span class="n">InterfaceError</span><span class="p">(</span><span class="s2">&quot;Method not supported&quot;</span><span class="p">)</span></div></div>

<span class="c1"># ITransaction(4) : ITransaction(3)</span>
<div class="viewcode-block" id="iTransaction"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iTransaction">[docs]</a><span class="k">class</span> <span class="nc">iTransaction</span><span class="p">(</span><span class="n">iTransaction_v3</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps ITransaction interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">4</span>
<div class="viewcode-block" id="iTransaction.commit"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iTransaction.commit">[docs]</a>    <span class="k">def</span> <span class="nf">commit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_commit_transaction()`&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">commit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span></div>
<div class="viewcode-block" id="iTransaction.rollback"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iTransaction.rollback">[docs]</a>    <span class="k">def</span> <span class="nf">rollback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_rollback_transaction()`&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">rollback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span></div>
<div class="viewcode-block" id="iTransaction.disconnect"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iTransaction.disconnect">[docs]</a>    <span class="k">def</span> <span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `fb_disconnect_transaction()`&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div></div>

<span class="c1"># IMessageMetadata(3) : ReferenceCounted</span>
<div class="viewcode-block" id="iMessageMetadata_v3"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMessageMetadata_v3">[docs]</a><span class="k">class</span> <span class="nc">iMessageMetadata_v3</span><span class="p">(</span><span class="n">iReferenceCounted</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IMessageMetadata v3 interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
<div class="viewcode-block" id="iMessageMetadata_v3.get_count"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMessageMetadata_v3.get_count">[docs]</a>    <span class="k">def</span> <span class="nf">get_count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns number of fields/parameters in a message. In all calls,</span>
<span class="sd">containing index parameter, it&#39;s value should be: 0 &lt;= index &lt; getCount().&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getCount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iMessageMetadata_v3.get_field"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMessageMetadata_v3.get_field">[docs]</a>    <span class="k">def</span> <span class="nf">get_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s2">&quot;Returns field name&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getField</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iMessageMetadata_v3.get_relation"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMessageMetadata_v3.get_relation">[docs]</a>    <span class="k">def</span> <span class="nf">get_relation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s2">&quot;Returns relation name (from which given field is selected)&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getRelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iMessageMetadata_v3.get_owner"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMessageMetadata_v3.get_owner">[docs]</a>    <span class="k">def</span> <span class="nf">get_owner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s2">&quot;Returns relation&#39;s owner name&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getOwner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iMessageMetadata_v3.get_alias"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMessageMetadata_v3.get_alias">[docs]</a>    <span class="k">def</span> <span class="nf">get_alias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s2">&quot;Returns field alias&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getAlias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iMessageMetadata_v3.get_type"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMessageMetadata_v3.get_type">[docs]</a>    <span class="k">def</span> <span class="nf">get_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SQLDataType</span><span class="p">:</span>
        <span class="s2">&quot;Returns field SQL type&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">SQLDataType</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iMessageMetadata_v3.is_nullable"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMessageMetadata_v3.is_nullable">[docs]</a>    <span class="k">def</span> <span class="nf">is_nullable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s2">&quot;Returns True if field is nullable&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">isNullable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iMessageMetadata_v3.get_subtype"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMessageMetadata_v3.get_subtype">[docs]</a>    <span class="k">def</span> <span class="nf">get_subtype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Returns blob field subtype (0 – binary, 1 – text, etc.)&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getSubType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iMessageMetadata_v3.get_length"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMessageMetadata_v3.get_length">[docs]</a>    <span class="k">def</span> <span class="nf">get_length</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Returns maximum field length&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getLength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iMessageMetadata_v3.get_scale"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMessageMetadata_v3.get_scale">[docs]</a>    <span class="k">def</span> <span class="nf">get_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Returns scale factor for numeric field&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getScale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iMessageMetadata_v3.get_charset"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMessageMetadata_v3.get_charset">[docs]</a>    <span class="k">def</span> <span class="nf">get_charset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Returns character set for character field and text blob&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getCharSet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iMessageMetadata_v3.get_offset"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMessageMetadata_v3.get_offset">[docs]</a>    <span class="k">def</span> <span class="nf">get_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Returns offset of field data in message buffer (use it to access data in message buffer)&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getOffset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iMessageMetadata_v3.get_null_offset"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMessageMetadata_v3.get_null_offset">[docs]</a>    <span class="k">def</span> <span class="nf">get_null_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Returns offset of null indicator for a field in message buffer&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getNullOffset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iMessageMetadata_v3.get_builder"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMessageMetadata_v3.get_builder">[docs]</a>    <span class="k">def</span> <span class="nf">get_builder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iMetadataBuilder</span><span class="p">:</span>
        <span class="s2">&quot;Returns MetadataBuilder interface initialized with this message metadata&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">iMetadataBuilder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getBuilder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iMessageMetadata_v3.get_message_length"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMessageMetadata_v3.get_message_length">[docs]</a>    <span class="k">def</span> <span class="nf">get_message_length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Returns length of message buffer (use it to allocate memory for the buffer)&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getMessageLength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div></div>

<span class="c1"># &gt;&gt;&gt; Firebird 4</span>
<span class="c1"># IMessageMetadata(4) : IMessageMetadata(3)</span>
<div class="viewcode-block" id="iMessageMetadata"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMessageMetadata">[docs]</a><span class="k">class</span> <span class="nc">iMessageMetadata</span><span class="p">(</span><span class="n">iMessageMetadata_v3</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IMessageMetadata v4 interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">4</span>
<div class="viewcode-block" id="iMessageMetadata.get_alignment"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMessageMetadata.get_alignment">[docs]</a>    <span class="k">def</span> <span class="nf">get_alignment</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns alignment required for message buffer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getAlignment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iMessageMetadata.get_aligned_length"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMessageMetadata.get_aligned_length">[docs]</a>    <span class="k">def</span> <span class="nf">get_aligned_length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns length of message buffer taking into an account alignment requirements</span>
<span class="sd">        (use it to allocate memory for an array of buffers and navigate through that array).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getAlignedLength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div></div>

<span class="c1"># IMetadataBuilder(3) : ReferenceCounted</span>
<div class="viewcode-block" id="iMetadataBuilder_v3"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMetadataBuilder_v3">[docs]</a><span class="k">class</span> <span class="nc">iMetadataBuilder_v3</span><span class="p">(</span><span class="n">iReferenceCounted</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IMetadataBuilder v3 interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
<div class="viewcode-block" id="iMetadataBuilder_v3.set_type"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMetadataBuilder_v3.set_type">[docs]</a>    <span class="k">def</span> <span class="nf">set_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">field_type</span><span class="p">:</span> <span class="n">SQLDataType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Set SQL type of a field&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">field_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iMetadataBuilder_v3.set_subtype"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMetadataBuilder_v3.set_subtype">[docs]</a>    <span class="k">def</span> <span class="nf">set_subtype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">subtype</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Set blob field subtype&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setSubType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">subtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iMetadataBuilder_v3.set_length"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMetadataBuilder_v3.set_length">[docs]</a>    <span class="k">def</span> <span class="nf">set_length</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Set maximum length of character field&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setLength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iMetadataBuilder_v3.set_charset"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMetadataBuilder_v3.set_charset">[docs]</a>    <span class="k">def</span> <span class="nf">set_charset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">charset</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Set character set for character field and text blob&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setCharSet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">charset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iMetadataBuilder_v3.set_scale"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMetadataBuilder_v3.set_scale">[docs]</a>    <span class="k">def</span> <span class="nf">set_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Set scale factor for numeric field&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setScale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iMetadataBuilder_v3.truncate"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMetadataBuilder_v3.truncate">[docs]</a>    <span class="k">def</span> <span class="nf">truncate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Truncate message to contain not more than count fields&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iMetadataBuilder_v3.move_name_to_index"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMetadataBuilder_v3.move_name_to_index">[docs]</a>    <span class="k">def</span> <span class="nf">move_name_to_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Reorganize fields in a message – move field “name” to given position&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">moveNameToIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iMetadataBuilder_v3.remove"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMetadataBuilder_v3.remove">[docs]</a>    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Remove field&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iMetadataBuilder_v3.add_field"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMetadataBuilder_v3.add_field">[docs]</a>    <span class="k">def</span> <span class="nf">add_field</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Add field&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">addField</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iMetadataBuilder_v3.get_metadata"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMetadataBuilder_v3.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iMessageMetadata</span><span class="p">:</span>
        <span class="s2">&quot;Returns MessageMetadata interface built by this builder&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">iMessageMetadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getMetadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div></div>

<span class="c1"># &gt;&gt;&gt; Firebird 4</span>
<span class="c1"># IMetadataBuilder(4) : IMetadataBuilder(3)</span>
<div class="viewcode-block" id="iMetadataBuilder"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMetadataBuilder">[docs]</a><span class="k">class</span> <span class="nc">iMetadataBuilder</span><span class="p">(</span><span class="n">iMetadataBuilder_v3</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IMetadataBuilder v4 interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">4</span>
<div class="viewcode-block" id="iMetadataBuilder.set_field"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMetadataBuilder.set_field">[docs]</a>    <span class="k">def</span> <span class="nf">set_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Set field name&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setField</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">field</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iMetadataBuilder.set_relation"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMetadataBuilder.set_relation">[docs]</a>    <span class="k">def</span> <span class="nf">set_relation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">relation</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Set relation name&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setRelation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">relation</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iMetadataBuilder.set_owner"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMetadataBuilder.set_owner">[docs]</a>    <span class="k">def</span> <span class="nf">set_owner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">owner</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Set owner name&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setOwner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">owner</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iMetadataBuilder.set_alias"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMetadataBuilder.set_alias">[docs]</a>    <span class="k">def</span> <span class="nf">set_alias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Set the alias&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setAlias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">alias</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div></div>

<span class="c1"># IResultSet(3) : ReferenceCounted</span>
<div class="viewcode-block" id="iResultSet_v3"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iResultSet_v3">[docs]</a><span class="k">class</span> <span class="nc">iResultSet_v3</span><span class="p">(</span><span class="n">iReferenceCounted</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IResultSet interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
<div class="viewcode-block" id="iResultSet_v3.fetch_next"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iResultSet_v3.fetch_next">[docs]</a>    <span class="k">def</span> <span class="nf">fetch_next</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StateResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch next record, replaces isc_dsql_fetch(). This method (and other</span>
<span class="sd">fetch methods) returns completion code Status::RESULT_NO_DATA when EOF is reached,</span>
<span class="sd">Status::RESULT_OK on success.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">fetchNext</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">StateResult</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iResultSet_v3.fetch_prior"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iResultSet_v3.fetch_prior">[docs]</a>    <span class="k">def</span> <span class="nf">fetch_prior</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StateResult</span><span class="p">:</span>
        <span class="s2">&quot;Fetch previous record&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">fetchPrior</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">StateResult</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iResultSet_v3.fetch_first"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iResultSet_v3.fetch_first">[docs]</a>    <span class="k">def</span> <span class="nf">fetch_first</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StateResult</span><span class="p">:</span>
        <span class="s2">&quot;Fetch first record&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">fetchFirst</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">StateResult</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iResultSet_v3.fetch_last"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iResultSet_v3.fetch_last">[docs]</a>    <span class="k">def</span> <span class="nf">fetch_last</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StateResult</span><span class="p">:</span>
        <span class="s2">&quot;Fetch last record&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">fetchLast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">StateResult</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iResultSet_v3.fetch_absolute"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iResultSet_v3.fetch_absolute">[docs]</a>    <span class="k">def</span> <span class="nf">fetch_absolute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StateResult</span><span class="p">:</span>
        <span class="s2">&quot;Fetch record by it&#39;s absolute position in result set&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">fetchAbsolute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">StateResult</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iResultSet_v3.fetch_relative"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iResultSet_v3.fetch_relative">[docs]</a>    <span class="k">def</span> <span class="nf">fetch_relative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StateResult</span><span class="p">:</span>
        <span class="s2">&quot;Fetch record by position relative to current&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">fetchRelative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">StateResult</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iResultSet_v3.is_eof"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iResultSet_v3.is_eof">[docs]</a>    <span class="k">def</span> <span class="nf">is_eof</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s2">&quot;Check for EOF&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">isEof</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iResultSet_v3.is_bof"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iResultSet_v3.is_bof">[docs]</a>    <span class="k">def</span> <span class="nf">is_bof</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s2">&quot;Check for BOF&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">isBof</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iResultSet_v3.get_metadata"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iResultSet_v3.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iMessageMetadata</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get metadata for messages in result set, specially useful when result</span>
<span class="sd">set is opened by IAttachment::openCursor() call with NULL output metadata format</span>
<span class="sd">parameter (this is the only way to obtain message format in this case)&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getMetadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iMessageMetadata</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iResultSet_v3.close"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iResultSet_v3.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Close result set, releases interface on success&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">deprecatedClose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span></div>
<div class="viewcode-block" id="iResultSet_v3.set_delayed_output_format"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iResultSet_v3.set_delayed_output_format">[docs]</a>    <span class="k">def</span> <span class="nf">set_delayed_output_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmt</span><span class="p">:</span> <span class="n">iMessageMetadata</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Important:</span>
<span class="sd">             This item is for ISC API emulation only. It may be gone in future versions.</span>
<span class="sd">             Please do not use it!</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setDelayedOutputFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div></div>

<span class="c1"># IResultSet(4) : ReferenceCounted</span>
<span class="k">class</span> <span class="nc">iResultSet_v4</span><span class="p">(</span><span class="n">iResultSet_v3</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IResultSet interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Close result set, releases interface on success&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span>

<span class="c1"># IResultSet(5) : ReferenceCounted</span>
<div class="viewcode-block" id="iResultSet"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iResultSet">[docs]</a><span class="k">class</span> <span class="nc">iResultSet</span><span class="p">(</span><span class="n">iResultSet_v3</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IResultSet interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">5</span>
<div class="viewcode-block" id="iResultSet.get_info"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iResultSet.get_info">[docs]</a>    <span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">buffer</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Returns information about result set.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">),</span> <span class="n">items</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">buffer</span><span class="p">),</span> <span class="n">buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div></div>

<span class="c1"># IStatement(3) : ReferenceCounted</span>
<div class="viewcode-block" id="iStatement_v3"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatement_v3">[docs]</a><span class="k">class</span> <span class="nc">iStatement_v3</span><span class="p">(</span><span class="n">iReferenceCounted</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IStatement v3 interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
<div class="viewcode-block" id="iStatement_v3.get_info"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatement_v3.get_info">[docs]</a>    <span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">buffer</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_dsql_sql_info()`&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">),</span> <span class="n">items</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">buffer</span><span class="p">),</span> <span class="n">buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iStatement_v3.get_type"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatement_v3.get_type">[docs]</a>    <span class="k">def</span> <span class="nf">get_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StatementType</span><span class="p">:</span>
        <span class="s2">&quot;Statement type, currently can be found only in firebird sources in `dsql/dsql.h`&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">StatementType</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iStatement_v3.get_plan"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatement_v3.get_plan">[docs]</a>    <span class="k">def</span> <span class="nf">get_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">detailed</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s2">&quot;Returns statement execution plan&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getPlan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">detailed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span> <span class="k">if</span> <span class="n">result</span> <span class="k">else</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iStatement_v3.get_affected_records"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatement_v3.get_affected_records">[docs]</a>    <span class="k">def</span> <span class="nf">get_affected_records</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Returns number of records affected by statement&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getAffectedRecords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iStatement_v3.get_input_metadata"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatement_v3.get_input_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_input_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iMessageMetadata</span><span class="p">:</span>
        <span class="s2">&quot;Returns parameters metadata&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getInputMetadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iMessageMetadata</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iStatement_v3.get_output_metadata"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatement_v3.get_output_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_output_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iMessageMetadata</span><span class="p">:</span>
        <span class="s2">&quot;Returns output values metadata&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getOutputMetadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iMessageMetadata</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iStatement_v3.execute"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatement_v3.execute">[docs]</a>    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">iTransaction</span><span class="p">,</span> <span class="n">in_meta</span><span class="p">:</span> <span class="n">iMessageMetadata</span><span class="p">,</span> <span class="n">in_buffer</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span>
                <span class="n">out_meta</span><span class="p">:</span> <span class="n">iMessageMetadata</span><span class="p">,</span> <span class="n">out_buffer</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Executes any SQL statement except returning multiple rows of data.</span>
<span class="sd">Partial analogue of `isc_dsql_execute2()` - in and out XSLQDAs replaced with input</span>
<span class="sd">and output messages with appropriate buffers.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">transaction</span><span class="p">,</span> <span class="n">in_meta</span><span class="p">,</span> <span class="n">in_buffer</span><span class="p">,</span> <span class="n">out_meta</span><span class="p">,</span> <span class="n">out_buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="n">transaction</span><span class="o">.</span><span class="n">_as_parameter_</span> <span class="o">=</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iStatement_v3.open_cursor"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatement_v3.open_cursor">[docs]</a>    <span class="k">def</span> <span class="nf">open_cursor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">iTransaction</span><span class="p">,</span> <span class="n">in_meta</span><span class="p">:</span> <span class="n">iMessageMetadata</span><span class="p">,</span> <span class="n">in_buffer</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span>
                    <span class="n">out_meta</span><span class="p">:</span> <span class="n">iMessageMetadata</span><span class="p">,</span> <span class="n">flags</span><span class="p">:</span> <span class="n">CursorFlag</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iResultSet</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Executes SQL statement potentially returning multiple rows of data.</span>
<span class="sd">Returns ResultSet interface which should be used to fetch that data. Format of</span>
<span class="sd">output data is defined by outMetadata parameter, leaving it NULL default format</span>
<span class="sd">may be used. Parameter flags is needed to open bidirectional cursor setting it&#39;s</span>
<span class="sd">value to IStatement::CURSOR_TYPE_SCROLLABLE.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">openCursor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">transaction</span><span class="p">,</span> <span class="n">in_meta</span><span class="p">,</span> <span class="n">in_buffer</span><span class="p">,</span> <span class="n">out_meta</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iResultSet</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iStatement_v3.set_cursor_name"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatement_v3.set_cursor_name">[docs]</a>    <span class="k">def</span> <span class="nf">set_cursor_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_dsql_set_cursor_name()`&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setCursorName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iStatement_v3.free"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatement_v3.free">[docs]</a>    <span class="k">def</span> <span class="nf">free</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Free statement, releases interface on success&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">deprecatedFree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span></div>
<div class="viewcode-block" id="iStatement_v3.get_flags"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatement_v3.get_flags">[docs]</a>    <span class="k">def</span> <span class="nf">get_flags</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StatementFlag</span><span class="p">:</span>
        <span class="s2">&quot;Returns flags describing how this statement should be executed, simplified replacement of getType() method&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getFlags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">StatementFlag</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div></div>

<span class="c1"># &gt;&gt;&gt; Firebird 4</span>
<span class="c1"># IStatement(4) : IStatement(3)</span>
<div class="viewcode-block" id="iStatement_v4"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatement_v4">[docs]</a><span class="k">class</span> <span class="nc">iStatement_v4</span><span class="p">(</span><span class="n">iStatement_v3</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IStatement v4 interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">4</span>
<div class="viewcode-block" id="iStatement_v4.get_timeout"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatement_v4.get_timeout">[docs]</a>    <span class="k">def</span> <span class="nf">get_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Return statement timeout&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getTimeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iStatement_v4.set_timeout"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatement_v4.set_timeout">[docs]</a>    <span class="k">def</span> <span class="nf">set_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Set the statement timeout&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setTimeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iStatement_v4.create_batch"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatement_v4.create_batch">[docs]</a>    <span class="k">def</span> <span class="nf">create_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_meta</span><span class="p">:</span> <span class="n">iMessageMetadata</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iBatch</span><span class="p">:</span>
        <span class="s2">&quot;Create new batch&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">createBatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">in_meta</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">),</span> <span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iBatch</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div></div>

<span class="c1"># IStatement(5) : IStatement(4)</span>
<div class="viewcode-block" id="iStatement"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatement">[docs]</a><span class="k">class</span> <span class="nc">iStatement</span><span class="p">(</span><span class="n">iStatement_v4</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IStatement v4 interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">5</span>
<div class="viewcode-block" id="iStatement.free"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iStatement.free">[docs]</a>    <span class="k">def</span> <span class="nf">free</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Free statement, releases interface on success&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span></div></div>

<span class="c1"># IBatch(3) : ReferenceCounted</span>
<div class="viewcode-block" id="iBatch_v3"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBatch_v3">[docs]</a><span class="k">class</span> <span class="nc">iBatch_v3</span><span class="p">(</span><span class="n">iReferenceCounted</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IBatch interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">TAG_MULTIERROR</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">TAG_RECORD_COUNTS</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">TAG_BUFFER_BYTES_SIZE</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">TAG_BLOB_POLICY</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">TAG_DETAILED_ERRORS</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">INF_BUFFER_BYTES_SIZE</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">INF_DATA_BYTES_SIZE</span> <span class="o">=</span> <span class="mi">11</span>
    <span class="n">INF_BLOBS_BYTES_SIZE</span> <span class="o">=</span> <span class="mi">12</span>
    <span class="n">INF_BLOB_ALIGNMENT</span> <span class="o">=</span> <span class="mi">13</span>
    <span class="n">INF_BLOB_HEADER</span> <span class="o">=</span> <span class="mi">14</span>
    <span class="n">BLOB_NONE</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">BLOB_ID_ENGINE</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">BLOB_ID_USER</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">BLOB_STREAM</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">BLOB_SEGHDR_ALIGN</span> <span class="o">=</span> <span class="mi">2</span>
<div class="viewcode-block" id="iBatch_v3.add"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBatch_v3.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">in_buffer</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds count messages from inBuffer to the batch. Total size of messages that can</span>
<span class="sd">        be added to the batch is limited by TAG_BUFFER_BYTES_SIZE parameter of batch creation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">in_buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iBatch_v3.add_blob"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBatch_v3.add_blob">[docs]</a>    <span class="k">def</span> <span class="nf">add_blob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">in_buffer</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">id_</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_QUAD</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds single blob having length bytes from `in_buffer` to the batch,</span>
<span class="sd">        blob identifier is located at `id_` address. If blob should be created with</span>
<span class="sd">        non-default parameters BPB may be passed (format matches one used in</span>
<span class="sd">        `~.iAttachment_v3.create_blob`). Total size of inline blobs that can be added to the</span>
<span class="sd">        batch (including optional BPBs, blob headers, segment sizes and taking into an</span>
<span class="sd">        accoount alignment) is limited by TAG_BUFFER_BYTES_SIZE parameter of batch creation</span>
<span class="sd">        (affects all blob-oriented methods except `register_blob()`).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">addBlob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">in_buffer</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">id_</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">),</span> <span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iBatch_v3.append_blob_data"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBatch_v3.append_blob_data">[docs]</a>    <span class="k">def</span> <span class="nf">append_blob_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">in_buffer</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extend last added blob: append length bytes taken from `in_buffer` to it.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">appendBlobData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">in_buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iBatch_v3.add_blob_stream"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBatch_v3.add_blob_stream">[docs]</a>    <span class="k">def</span> <span class="nf">add_blob_stream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">in_buffer</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds blob data (this can be multiple objects or part of single blob) to the batch.</span>
<span class="sd">        Header of each blob in the stream is aligned at `get_blob_alignment()` boundary</span>
<span class="sd">        and contains 3 fields: first - 8-bytes blob identifier (in ISC_QUAD format),</span>
<span class="sd">        second - 4-bytes length of blob, third – 4-bytes length of BPB. Blob header should</span>
<span class="sd">        not cross boundaries of buffer in this function call. BPB data is placed right after</span>
<span class="sd">        header, blob data goes next. Length of blob includes BPB (if it present). All data</span>
<span class="sd">        may be distributed between multiple `add_blob_stream()` calls. Blob data in turn</span>
<span class="sd">        may be structured in case of segmented blob, see chapter “Modifying data in a batch”</span>
<span class="sd">        in `Using_OO_API` guide.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">addBlobStream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">in_buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iBatch_v3.register_blob"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBatch_v3.register_blob">[docs]</a>    <span class="k">def</span> <span class="nf">register_blob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">existing</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_QUAD</span><span class="p">,</span> <span class="n">id_</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_QUAD</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Makes it possible to use in batch blobs added using standard Blob interface.</span>
<span class="sd">        This function contains 2 ISC_QUAD* parameters, it’s important not to mix them –</span>
<span class="sd">        first parameter (`existing`) is a blob identifier, already added out of batch scope,</span>
<span class="sd">        second (`id_`) is blob identifier that will be placed in a message in this batch.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">registerBlob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">existing</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="n">id_</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iBatch_v3.execute"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBatch_v3.execute">[docs]</a>    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">iTransaction</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iBatchCompletionState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute batch with parameters passed to it in the messages. If parameter</span>
<span class="sd">        MULTIERROR is not set in parameters block when creating the batch execution will be</span>
<span class="sd">        stopped after first error, in MULTIERROR mode an unlimited number of errors can</span>
<span class="sd">        happen, after an error execution is continued from the next message. This function</span>
<span class="sd">        returns `.iBatchCompletionState` interface that contains all requested information</span>
<span class="sd">        about the results of batch execution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">transaction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iBatchCompletionState</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iBatch_v3.cancel"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBatch_v3.cancel">[docs]</a>    <span class="k">def</span> <span class="nf">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear messages and blobs buffers, return batch to a state it had right after</span>
<span class="sd">        creation.</span>

<span class="sd">        Note:</span>
<span class="sd">           Being reference counted interface batch does not contain any special function to</span>
<span class="sd">           close it, please use release() for this purposes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iBatch_v3.get_blob_alignment"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBatch_v3.get_blob_alignment">[docs]</a>    <span class="k">def</span> <span class="nf">get_blob_alignment</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns required alignment for the data placed into the buffer of `.add_blob_stream()`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getBlobAlignment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iBatch_v3.get_metadata"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBatch_v3.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iMessageMetadata</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns format of metadata used in batch’s messages.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getMetadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iMessageMetadata</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iBatch_v3.set_default_bpb"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBatch_v3.set_default_bpb">[docs]</a>    <span class="k">def</span> <span class="nf">set_default_bpb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bpb</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets BPB which will be used for all blobs missing non-default BPB. Must be called</span>
<span class="sd">        before adding any message or blob to batch.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setDefaultBpb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bpb</span><span class="p">),</span> <span class="n">bpb</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iBatch_v3.close"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBatch_v3.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets BPB which will be used for all blobs missing non-default BPB. Must be called</span>
<span class="sd">        before adding any message or blob to batch.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">deprecatedClose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div></div>

<span class="c1"># IBatch(4) : IBatch(3)</span>
<div class="viewcode-block" id="iBatch"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBatch">[docs]</a><span class="k">class</span> <span class="nc">iBatch</span><span class="p">(</span><span class="n">iBatch_v3</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IBatch interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">4</span>
<div class="viewcode-block" id="iBatch.close"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBatch.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets BPB which will be used for all blobs missing non-default BPB. Must be called</span>
<span class="sd">        before adding any message or blob to batch.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iBatch.get_info"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBatch.get_info">[docs]</a>    <span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">buffer</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Requests information about batch.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">),</span> <span class="n">items</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">buffer</span><span class="p">),</span> <span class="n">buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div></div>

<span class="c1"># IBatchCompletionState(3) : Disposable</span>
<div class="viewcode-block" id="iBatchCompletionState"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBatchCompletionState">[docs]</a><span class="k">class</span> <span class="nc">iBatchCompletionState</span><span class="p">(</span><span class="n">iDisposable</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IBatchCompletionState interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">EXECUTE_FAILED</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">SUCCESS_NO_INFO</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
    <span class="n">NO_MORE_ERRORS</span> <span class="o">=</span> <span class="mh">0xffffffff</span>
<div class="viewcode-block" id="iBatchCompletionState.get_size"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBatchCompletionState.get_size">[docs]</a>    <span class="k">def</span> <span class="nf">get_size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the total number of processed messages.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iBatchCompletionState.get_state"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBatchCompletionState.get_state">[docs]</a>    <span class="k">def</span> <span class="nf">get_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the result of execution of message number `pos`. On any error with the</span>
<span class="sd">        message this is `.EXECUTE_FAILED` constant, value returned on success depends upon</span>
<span class="sd">        presence of `.RECORD_COUNTS` parameter of batch creation. When it present and has</span>
<span class="sd">        non-zero value number of records inserted, updated or deleted during particular</span>
<span class="sd">        message processing is returned, else `.SUCCESS_NO_INFO` constant is returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iBatchCompletionState.find_error"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBatchCompletionState.find_error">[docs]</a>    <span class="k">def</span> <span class="nf">find_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Finds next (starting with pos) message which processing caused an error. When</span>
<span class="sd">        such message is missing NO_MORE_ERRORS constant is returned. Number of status vectors,</span>
<span class="sd">        returned in this interface, is limited by the value of `.DETAILED_ERRORS` parameter</span>
<span class="sd">        of batch creation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">findError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iBatchCompletionState.get_status"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iBatchCompletionState.get_status">[docs]</a>    <span class="k">def</span> <span class="nf">get_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iStatus</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns detailed information (full status vector) about an error that took place</span>
<span class="sd">        when processing `pos` message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_master</span><span class="o">.</span><span class="n">get_status</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getStatus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div></div>

<span class="c1"># IRequest(3) : ReferenceCounted</span>
<div class="viewcode-block" id="iRequest_v3"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iRequest_v3">[docs]</a><span class="k">class</span> <span class="nc">iRequest_v3</span><span class="p">(</span><span class="n">iReferenceCounted</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IRequest interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
<div class="viewcode-block" id="iRequest_v3.receive"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iRequest_v3.receive">[docs]</a>    <span class="k">def</span> <span class="nf">receive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">msg_type</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Information not available&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">msg_type</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">),</span> <span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iRequest_v3.send"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iRequest_v3.send">[docs]</a>    <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">msg_type</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Information not available&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">msg_type</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">),</span> <span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iRequest_v3.get_info"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iRequest_v3.get_info">[docs]</a>    <span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">items</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">buffer</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Information not available&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">),</span> <span class="n">items</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">buffer</span><span class="p">),</span> <span class="n">buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iRequest_v3.start"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iRequest_v3.start">[docs]</a>    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">iTransaction</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Information not available&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">transaction</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iRequest_v3.start_and_send"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iRequest_v3.start_and_send">[docs]</a>    <span class="k">def</span> <span class="nf">start_and_send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">iTransaction</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">msg_type</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Information not available&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">startAndSend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">transaction</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">msg_type</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="p">),</span> <span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iRequest_v3.unwind"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iRequest_v3.unwind">[docs]</a>    <span class="k">def</span> <span class="nf">unwind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Information not available&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">unwind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iRequest_v3.free"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iRequest_v3.free">[docs]</a>    <span class="k">def</span> <span class="nf">free</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Information not available&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">deprecatedFree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span></div></div>

<span class="c1"># IRequest(4) : IRequest(3)</span>
<div class="viewcode-block" id="iRequest"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iRequest">[docs]</a><span class="k">class</span> <span class="nc">iRequest</span><span class="p">(</span><span class="n">iRequest_v3</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IRequest interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">4</span>
<div class="viewcode-block" id="iRequest.free"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iRequest.free">[docs]</a>    <span class="k">def</span> <span class="nf">free</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Information not available&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span></div></div>

<span class="c1"># IEvents(3) : ReferenceCounted</span>
<div class="viewcode-block" id="iEvents_v3"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iEvents_v3">[docs]</a><span class="k">class</span> <span class="nc">iEvents_v3</span><span class="p">(</span><span class="n">iReferenceCounted</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IEvents interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
<div class="viewcode-block" id="iEvents_v3.cancel"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iEvents_v3.cancel">[docs]</a>    <span class="k">def</span> <span class="nf">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Cancels events monitoring started by IAttachment::queEvents()&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">deprecatedCancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div></div>

<span class="c1"># IEvents(4) : IEvents(3)</span>
<div class="viewcode-block" id="iEvents"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iEvents">[docs]</a><span class="k">class</span> <span class="nc">iEvents</span><span class="p">(</span><span class="n">iEvents_v3</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IEvents interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">4</span>
<div class="viewcode-block" id="iEvents.cancel"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iEvents.cancel">[docs]</a>    <span class="k">def</span> <span class="nf">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Cancels events monitoring started by IAttachment::queEvents()&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div></div>

<span class="c1"># IAttachment(3) : ReferenceCounted</span>
<div class="viewcode-block" id="iAttachment_v3"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v3">[docs]</a><span class="k">class</span> <span class="nc">iAttachment_v3</span><span class="p">(</span><span class="n">iReferenceCounted</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IAttachment v3 interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">intf</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">intf</span><span class="p">)</span>
        <span class="c1">#: Encoding used for string values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ascii&#39;</span>
<div class="viewcode-block" id="iAttachment_v3.get_info"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v3.get_info">[docs]</a>    <span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">buffer</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_database_info()`&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">),</span> <span class="n">items</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">buffer</span><span class="p">),</span> <span class="n">buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iAttachment_v3.start_transaction"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v3.start_transaction">[docs]</a>    <span class="k">def</span> <span class="nf">start_transaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tpb</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iTransaction</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Partially replaces `isc_start_multiple()`, to start &gt;1 transaction</span>
<span class="sd">distributed transactions coordinator should be used, also possible to join 2</span>
<span class="sd">transactions into single distributed transaction&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">startTransaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tpb</span><span class="p">),</span> <span class="n">tpb</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iTransaction</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iAttachment_v3.reconnect_transaction"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v3.reconnect_transaction">[docs]</a>    <span class="k">def</span> <span class="nf">reconnect_transaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iTransaction</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Makes it possible to connect to a transaction in limbo. Id parameter</span>
<span class="sd">contains transaction number in network format of given length.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">reconnectTransaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">id_</span><span class="p">),</span> <span class="n">id_</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iTransaction</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iAttachment_v3.compile_request"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v3.compile_request">[docs]</a>    <span class="k">def</span> <span class="nf">compile_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">blr</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iRequest</span><span class="p">:</span>
        <span class="s2">&quot;Support of ISC API&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">compileRequest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">blr</span><span class="p">),</span> <span class="n">blr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iRequest</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iAttachment_v3.transact_request"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v3.transact_request">[docs]</a>    <span class="k">def</span> <span class="nf">transact_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">iTransaction</span><span class="p">,</span> <span class="n">blr</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">in_msg</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">out_msg</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Support of ISC API&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">transactRequest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">transaction</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">blr</span><span class="p">),</span> <span class="n">blr</span><span class="p">,</span>
                                    <span class="nb">len</span><span class="p">(</span><span class="n">in_msg</span><span class="p">),</span> <span class="n">in_msg</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">out_msg</span><span class="p">),</span> <span class="n">out_msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iAttachment_v3.create_blob"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v3.create_blob">[docs]</a>    <span class="k">def</span> <span class="nf">create_blob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">iTransaction</span><span class="p">,</span> <span class="n">id_</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_QUAD</span><span class="p">,</span> <span class="n">bpb</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iBlob</span><span class="p">:</span>
        <span class="s2">&quot;Creates new blob, stores it&#39;s identifier in id, replaces `isc_create_blob2()`&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">createBlob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">transaction</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">id_</span><span class="p">),</span>
                                        <span class="nb">len</span><span class="p">(</span><span class="n">bpb</span><span class="p">)</span> <span class="k">if</span> <span class="n">bpb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">bpb</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iBlob</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iAttachment_v3.open_blob"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v3.open_blob">[docs]</a>    <span class="k">def</span> <span class="nf">open_blob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">iTransaction</span><span class="p">,</span> <span class="n">id_</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_QUAD</span><span class="p">,</span> <span class="n">bpb</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iBlob</span><span class="p">:</span>
        <span class="s2">&quot;Opens existing blob, replaces `isc_open_blob2()`&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">openBlob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">transaction</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">id_</span><span class="p">),</span>
                                      <span class="nb">len</span><span class="p">(</span><span class="n">bpb</span><span class="p">)</span> <span class="k">if</span> <span class="n">bpb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">bpb</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iBlob</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iAttachment_v3.get_slice"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v3.get_slice">[docs]</a>    <span class="k">def</span> <span class="nf">get_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">iTransaction</span><span class="p">,</span> <span class="n">id_</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_QUAD</span><span class="p">,</span> <span class="n">sdl</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span>
                  <span class="n">param</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">slice_</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Support of ISC API&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getSlice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">transaction</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">id_</span><span class="p">),</span>
                                      <span class="nb">len</span><span class="p">(</span><span class="n">sdl</span><span class="p">),</span> <span class="n">sdl</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">param</span><span class="p">),</span> <span class="n">param</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">slice_</span><span class="p">),</span> <span class="n">slice_</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iAttachment_v3.put_slice"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v3.put_slice">[docs]</a>    <span class="k">def</span> <span class="nf">put_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">iTransaction</span><span class="p">,</span> <span class="n">id_</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_QUAD</span><span class="p">,</span> <span class="n">sdl</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span>
                  <span class="n">param</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">slice_</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Support of ISC API&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">putSlice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">transaction</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">id_</span><span class="p">),</span>
                             <span class="nb">len</span><span class="p">(</span><span class="n">sdl</span><span class="p">),</span> <span class="n">sdl</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">param</span><span class="p">),</span> <span class="n">param</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">slice_</span><span class="p">),</span> <span class="n">slice_</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iAttachment_v3.execute_dyn"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v3.execute_dyn">[docs]</a>    <span class="k">def</span> <span class="nf">execute_dyn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">iTransaction</span><span class="p">,</span> <span class="n">dyn</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Support of ISC API&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">executeDyn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">transaction</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dyn</span><span class="p">),</span> <span class="n">dyn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iAttachment_v3.prepare"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v3.prepare">[docs]</a>    <span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">iTransaction</span><span class="p">,</span> <span class="n">stmt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dialect</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                <span class="n">flags</span><span class="p">:</span> <span class="n">PreparePrefetchFlag</span> <span class="o">=</span> <span class="n">PreparePrefetchFlag</span><span class="o">.</span><span class="n">METADATA</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iStatement</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Replaces `isc_dsql_prepare()`. Additional parameter flags makes it</span>
<span class="sd">possible to control what information will be preloaded from engine at once</span>
<span class="sd">(i.e. in single network packet for remote operation).&quot;&quot;&quot;</span>
        <span class="n">b_stmt</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">transaction</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_stmt</span><span class="p">),</span> <span class="n">b_stmt</span><span class="p">,</span>
                                     <span class="n">dialect</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iStatement</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iAttachment_v3.execute"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v3.execute">[docs]</a>    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">iTransaction</span><span class="p">,</span> <span class="n">stmt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dialect</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                <span class="n">in_metadata</span><span class="p">:</span> <span class="n">iMessageMetadata</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">in_buffer</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">out_metadata</span><span class="p">:</span> <span class="n">iMessageMetadata</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">out_buffer</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Executes any SQL statement except returning multiple rows of data.</span>
<span class="sd">Partial analogue of `isc_dsql_execute2()` - in and out XSLQDAs replaced with</span>
<span class="sd">input and output messages with appropriate buffers.&quot;&quot;&quot;</span>
        <span class="n">b_stmt</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">transaction</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_stmt</span><span class="p">),</span> <span class="n">b_stmt</span><span class="p">,</span>
                                     <span class="n">dialect</span><span class="p">,</span> <span class="n">in_metadata</span><span class="p">,</span> <span class="n">in_buffer</span><span class="p">,</span> <span class="n">out_metadata</span><span class="p">,</span> <span class="n">out_buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="n">transaction</span><span class="o">.</span><span class="n">_as_parameter_</span> <span class="o">=</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iAttachment_v3.open_cursor"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v3.open_cursor">[docs]</a>    <span class="k">def</span> <span class="nf">open_cursor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">iTransaction</span><span class="p">,</span> <span class="n">stmt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dialect</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="n">in_metadata</span><span class="p">:</span> <span class="n">iMessageMetadata</span><span class="p">,</span> <span class="n">in_buffer</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span>
                    <span class="n">out_metadata</span><span class="p">:</span> <span class="n">iMessageMetadata</span><span class="p">,</span> <span class="n">cursor_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">cursor_flags</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iResultSet</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Executes SQL statement potentially returning multiple rows of data.</span>
<span class="sd">Returns iResultSet interface which should be used to fetch that data. Format of</span>
<span class="sd">output data is defined by out_metadata parameter, leaving it NULL default format</span>
<span class="sd">may be used. Parameter cursor_name specifies name of opened cursor (analogue of</span>
<span class="sd">`isc_dsql_set_cursor_name()`). Parameter cursor_flags is needed to open</span>
<span class="sd">bidirectional cursor setting it&#39;s value to Istatement::CURSOR_TYPE_SCROLLABLE.&quot;&quot;&quot;</span>
        <span class="n">b_stmt</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">openCursor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">transaction</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_stmt</span><span class="p">),</span> <span class="n">b_stmt</span><span class="p">,</span>
                                        <span class="n">dialect</span><span class="p">,</span> <span class="n">in_metadata</span><span class="p">,</span> <span class="n">in_buffer</span><span class="p">,</span> <span class="n">out_metadata</span><span class="p">,</span>
                                        <span class="n">cursor_name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">),</span> <span class="n">cursor_flags</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iResultSet</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iAttachment_v3.que_events"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v3.que_events">[docs]</a>    <span class="k">def</span> <span class="nf">que_events</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">iEventCallbackImpl</span><span class="p">,</span> <span class="n">events</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iEvents</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Replaces `isc_que_events()` call. Instead callback function with</span>
<span class="sd">void* parameter callback interface is used.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">queEvents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">events</span><span class="p">),</span> <span class="n">events</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iEvents</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iAttachment_v3.cancel_operation"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v3.cancel_operation">[docs]</a>    <span class="k">def</span> <span class="nf">cancel_operation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `fb_cancel_operation()`&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">cancelOperation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iAttachment_v3.ping"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v3.ping">[docs]</a>    <span class="k">def</span> <span class="nf">ping</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks connection status. If test fails the only operation possible</span>
<span class="sd">with attachment is to close it.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">ping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iAttachment_v3.detach"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v3.detach">[docs]</a>    <span class="k">def</span> <span class="nf">detach</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_detach_database()`. On success releases interface.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">deprecatedDetach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span></div>
<div class="viewcode-block" id="iAttachment_v3.drop_database"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v3.drop_database">[docs]</a>    <span class="k">def</span> <span class="nf">drop_database</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_drop_database()`. On success releases interface.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">deprecatedDropDatabase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span></div></div>

<span class="c1"># &gt;&gt;&gt; Firebird 4</span>
<span class="c1"># IAttachment(4) : IAttachment(3)</span>
<div class="viewcode-block" id="iAttachment_v4"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v4">[docs]</a><span class="k">class</span> <span class="nc">iAttachment_v4</span><span class="p">(</span><span class="n">iAttachment_v3</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IAttachment v4 interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">4</span>
<div class="viewcode-block" id="iAttachment_v4.get_idle_timeout"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v4.get_idle_timeout">[docs]</a>    <span class="k">def</span> <span class="nf">get_idle_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Returns idle timeout for attachment.&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getIdleTimeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iAttachment_v4.set_idle_timeout"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v4.set_idle_timeout">[docs]</a>    <span class="k">def</span> <span class="nf">set_idle_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Sets idle timeout for attachment.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setIdleTimeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iAttachment_v4.get_statement_timeout"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v4.get_statement_timeout">[docs]</a>    <span class="k">def</span> <span class="nf">get_statement_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Returns idle timeout for statement.&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getStatementTimeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iAttachment_v4.set_statement_timeout"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v4.set_statement_timeout">[docs]</a>    <span class="k">def</span> <span class="nf">set_statement_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Sets idle timeout for statement.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setStatementTimeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iAttachment_v4.create_batch"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment_v4.create_batch">[docs]</a>    <span class="k">def</span> <span class="nf">create_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">iTransaction</span><span class="p">,</span> <span class="n">stmt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dialect</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                     <span class="n">in_metadata</span><span class="p">:</span> <span class="n">iMessageMetadata</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iBatch</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepares `stmt` and creates `.iBatch` interface ready to accept multiple sets</span>
<span class="sd">        of input parameters in `in_metadata` format. Leaving `in_metadata` `None` makes</span>
<span class="sd">        batch use default format for `stmt`. Parameters block may be passed to `create_batch`</span>
<span class="sd">        making it possible to adjust batch behavior.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">b_stmt</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">createBatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">transaction</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_stmt</span><span class="p">),</span> <span class="n">b_stmt</span><span class="p">,</span>
                                         <span class="n">dialect</span><span class="p">,</span> <span class="n">in_metadata</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">),</span> <span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iBatch</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div></div>

<span class="c1"># IAttachment(5) : IAttachment(4)</span>
<div class="viewcode-block" id="iAttachment"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment">[docs]</a><span class="k">class</span> <span class="nc">iAttachment</span><span class="p">(</span><span class="n">iAttachment_v4</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IAttachment v4 interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">5</span>
<div class="viewcode-block" id="iAttachment.detach"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment.detach">[docs]</a>    <span class="k">def</span> <span class="nf">detach</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_detach_database()`. On success releases interface.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span></div>
<div class="viewcode-block" id="iAttachment.drop_database"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iAttachment.drop_database">[docs]</a>    <span class="k">def</span> <span class="nf">drop_database</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_drop_database()`. On success releases interface.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">dropDatabase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span></div></div>

<span class="c1"># IService(3) : ReferenceCounted</span>
<div class="viewcode-block" id="iService_v3"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iService_v3">[docs]</a><span class="k">class</span> <span class="nc">iService_v3</span><span class="p">(</span><span class="n">iReferenceCounted</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IService interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
<div class="viewcode-block" id="iService_v3.detach"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iService_v3.detach">[docs]</a>    <span class="k">def</span> <span class="nf">detach</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Close attachment to services manager, on success releases interface.</span>
<span class="sd">        Replaces `isc_service_detach()`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">deprecatedDetach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span></div>
<div class="viewcode-block" id="iService_v3.query"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iService_v3.query">[docs]</a>    <span class="k">def</span> <span class="nf">query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">send</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">receive</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">buffer</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Send and request information to/from service, with different `receive`</span>
<span class="sd">        may be used for both running services and to obtain various server-wide information.</span>
<span class="sd">        Replaces `isc_service_query()`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">send</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">send</span><span class="p">),</span>
                          <span class="n">send</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">receive</span><span class="p">),</span> <span class="n">receive</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">buffer</span><span class="p">),</span> <span class="n">buffer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iService_v3.start"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iService_v3.start">[docs]</a>    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spb</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Start utility in services manager. Replaces `isc_service_start()`.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spb</span><span class="p">),</span> <span class="n">spb</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div></div>

<span class="c1"># IService(4) : IService(3)</span>
<div class="viewcode-block" id="iService_v4"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iService_v4">[docs]</a><span class="k">class</span> <span class="nc">iService_v4</span><span class="p">(</span><span class="n">iService_v3</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IService interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">4</span>
<div class="viewcode-block" id="iService_v4.detach"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iService_v4.detach">[docs]</a>    <span class="k">def</span> <span class="nf">detach</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Close attachment to services manager, on success releases interface.</span>
<span class="sd">        Replaces `isc_service_detach()`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">detach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span></div></div>

<span class="c1"># IService(5) : IService(4)</span>
<div class="viewcode-block" id="iService"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iService">[docs]</a><span class="k">class</span> <span class="nc">iService</span><span class="p">(</span><span class="n">iService_v4</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IService interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">5</span>
<div class="viewcode-block" id="iService.cancel"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iService.cancel">[docs]</a>    <span class="k">def</span> <span class="nf">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cancel wait of current `query()` call. Supported only for embedded connections.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span></div></div>

<span class="c1"># IProvider(4) : PluginBase</span>
<div class="viewcode-block" id="iProvider"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iProvider">[docs]</a><span class="k">class</span> <span class="nc">iProvider</span><span class="p">(</span><span class="n">iPluginBase</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IProvider interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">4</span>
<div class="viewcode-block" id="iProvider.attach_database"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iProvider.attach_database">[docs]</a>    <span class="k">def</span> <span class="nf">attach_database</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dpb</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ascii&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iAttachment</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_attach_database()`&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">attachDatabase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">filename</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">),</span>
                                            <span class="mi">0</span> <span class="k">if</span> <span class="n">dpb</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">dpb</span><span class="p">),</span> <span class="n">dpb</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iAttachment</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iProvider.create_database"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iProvider.create_database">[docs]</a>    <span class="k">def</span> <span class="nf">create_database</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dpb</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">encoding</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ascii&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iAttachment</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_create_database()`&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">createDatabase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">filename</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">dpb</span><span class="p">),</span> <span class="n">dpb</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iAttachment</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iProvider.attach_service_manager"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iProvider.attach_service_manager">[docs]</a>    <span class="k">def</span> <span class="nf">attach_service_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">spb</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iService</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_service_attach()`&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">attachServiceManager</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">service</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="n">spb</span><span class="p">),</span> <span class="n">spb</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iService</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iProvider.shutdown"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iProvider.shutdown">[docs]</a>    <span class="k">def</span> <span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reason</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `fb_shutdown()`&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">reason</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iProvider.set_dbcrypt_callback"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iProvider.set_dbcrypt_callback">[docs]</a>    <span class="k">def</span> <span class="nf">set_dbcrypt_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">iCryptKeyCallbackImpl</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Sets database encryption callback interface that will be used for following database and service attachments&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setDbCryptCallback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div></div>

<span class="c1"># IDtcStart(3) : Disposable</span>
<div class="viewcode-block" id="iDtcStart"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iDtcStart">[docs]</a><span class="k">class</span> <span class="nc">iDtcStart</span><span class="p">(</span><span class="n">iDisposable</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IDtcStart interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
<div class="viewcode-block" id="iDtcStart.add_attachment"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iDtcStart.add_attachment">[docs]</a>    <span class="k">def</span> <span class="nf">add_attachment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attachment</span><span class="p">:</span> <span class="n">iAttachment</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Adds attachment, transaction for it will be started with default TPB&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">addAttachment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">attachment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iDtcStart.add_with_tpb"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iDtcStart.add_with_tpb">[docs]</a>    <span class="k">def</span> <span class="nf">add_with_tpb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attachment</span><span class="p">:</span> <span class="n">iAttachment</span><span class="p">,</span> <span class="n">tpb</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Adds attachment and TPB which will be used to start transaction for this attachment&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">addWithTpb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">attachment</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tpb</span><span class="p">),</span> <span class="n">tpb</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iDtcStart.start"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iDtcStart.start">[docs]</a>    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iTransaction</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start distributed transaction for accumulated attachments.</span>
<span class="sd">On successful return DtcStart interface is disposed automatically.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_disposed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">iTransaction</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div></div>

<span class="c1"># IDtc(2) : Versioned</span>
<div class="viewcode-block" id="iDtc"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iDtc">[docs]</a><span class="k">class</span> <span class="nc">iDtc</span><span class="p">(</span><span class="n">iVersioned</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IDtc interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">2</span>
<div class="viewcode-block" id="iDtc.join"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iDtc.join">[docs]</a>    <span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">one</span><span class="p">:</span> <span class="n">iTransaction</span><span class="p">,</span> <span class="n">two</span><span class="p">:</span> <span class="n">iTransaction</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iTransaction</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Joins 2 independent transactions into distributed transaction.</span>
<span class="sd">On success both transactions passed to join() are released and pointers to them</span>
<span class="sd">should not be used any more.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">one</span><span class="p">,</span> <span class="n">two</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="n">one</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">two</span><span class="o">.</span><span class="n">_refcnt</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">iTransaction</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iDtc.start_builder"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iDtc.start_builder">[docs]</a>    <span class="k">def</span> <span class="nf">start_builder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iDtcStart</span><span class="p">:</span>
        <span class="s2">&quot;Returns DtcStart interface&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">startBuilder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iDtcStart</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div></div>

<span class="c1"># ITimerControl(2) : Versioned</span>
<div class="viewcode-block" id="iTimerControl"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iTimerControl">[docs]</a><span class="k">class</span> <span class="nc">iTimerControl</span><span class="p">(</span><span class="n">iVersioned</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps ITimerControl interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">2</span>
<div class="viewcode-block" id="iTimerControl.start"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iTimerControl.start">[docs]</a>    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timer</span><span class="p">:</span> <span class="n">iTimerImpl</span><span class="p">,</span> <span class="n">microseconds</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start ITimer to alarm after given delay (in microseconds, 10-6 seconds).</span>
<span class="sd">        Timer will be waked up only once after this call.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">timer</span><span class="p">,</span> <span class="n">microseconds</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iTimerControl.stop"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iTimerControl.stop">[docs]</a>    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timer</span><span class="p">:</span> <span class="n">iTimerImpl</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop ITimer. It&#39;s not an error to stop not started timer thus avoiding problems</span>
<span class="sd">        with races between stop() and timer alarm.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">timer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div></div>

<span class="c1"># IXpbBuilder(3) : Disposable</span>
<div class="viewcode-block" id="iXpbBuilder"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iXpbBuilder">[docs]</a><span class="k">class</span> <span class="nc">iXpbBuilder</span><span class="p">(</span><span class="n">iDisposable</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IXpbBuilder interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
<div class="viewcode-block" id="iXpbBuilder.clear"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iXpbBuilder.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Reset builder to empty state.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iXpbBuilder.remove_current"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iXpbBuilder.remove_current">[docs]</a>    <span class="k">def</span> <span class="nf">remove_current</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Removes current clumplet.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">removeCurrent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iXpbBuilder.insert_int"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iXpbBuilder.insert_int">[docs]</a>    <span class="k">def</span> <span class="nf">insert_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Inserts a clumplet with value representing integer in network format.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">insertInt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iXpbBuilder.insert_bigint"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iXpbBuilder.insert_bigint">[docs]</a>    <span class="k">def</span> <span class="nf">insert_bigint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Inserts a clumplet with value representing integer in network format.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">insertBigInt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iXpbBuilder.insert_bytes"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iXpbBuilder.insert_bytes">[docs]</a>    <span class="k">def</span> <span class="nf">insert_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Inserts a clumplet with value containing passed bytes.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">insertBytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iXpbBuilder.insert_string"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iXpbBuilder.insert_string">[docs]</a>    <span class="k">def</span> <span class="nf">insert_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">encoding</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;strict&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Inserts a clumplet with value containing passed string.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">insertString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">,</span> <span class="n">errors</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iXpbBuilder.insert_tag"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iXpbBuilder.insert_tag">[docs]</a>    <span class="k">def</span> <span class="nf">insert_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Inserts a clumplet without a value.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">insertTag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iXpbBuilder.is_eof"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iXpbBuilder.is_eof">[docs]</a>    <span class="k">def</span> <span class="nf">is_eof</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s2">&quot;Checks that there is no current clumplet.&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">isEof</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iXpbBuilder.move_next"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iXpbBuilder.move_next">[docs]</a>    <span class="k">def</span> <span class="nf">move_next</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Moves to next clumplet.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">moveNext</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iXpbBuilder.rewind"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iXpbBuilder.rewind">[docs]</a>    <span class="k">def</span> <span class="nf">rewind</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Moves to first clumplet.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">rewind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iXpbBuilder.find_first"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iXpbBuilder.find_first">[docs]</a>    <span class="k">def</span> <span class="nf">find_first</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s2">&quot;Finds first clumplet with given tag.&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">findFirst</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iXpbBuilder.find_next"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iXpbBuilder.find_next">[docs]</a>    <span class="k">def</span> <span class="nf">find_next</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s2">&quot;Finds next clumplet with given tag.&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">findNext</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iXpbBuilder.get_tag"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iXpbBuilder.get_tag">[docs]</a>    <span class="k">def</span> <span class="nf">get_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Returns tag for current clumplet.&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getTag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iXpbBuilder.get_length"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iXpbBuilder.get_length">[docs]</a>    <span class="k">def</span> <span class="nf">get_length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Returns length of current clumplet value.&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getLength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iXpbBuilder.get_int"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iXpbBuilder.get_int">[docs]</a>    <span class="k">def</span> <span class="nf">get_int</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Returns value of current clumplet as integer.&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getInt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iXpbBuilder.get_bigint"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iXpbBuilder.get_bigint">[docs]</a>    <span class="k">def</span> <span class="nf">get_bigint</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Returns value of current clumplet as 64-bit integer.&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getBigInt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iXpbBuilder.get_string"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iXpbBuilder.get_string">[docs]</a>    <span class="k">def</span> <span class="nf">get_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">encoding</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;strict&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s2">&quot;Returns value of current clumplet as string.&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">string_at</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encoding</span><span class="p">,</span> <span class="n">errors</span><span class="p">)</span></div>
<div class="viewcode-block" id="iXpbBuilder.get_bytes"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iXpbBuilder.get_bytes">[docs]</a>    <span class="k">def</span> <span class="nf">get_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="s2">&quot;Returns value of current clumplet as bytes.&quot;</span>
        <span class="n">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getBytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getLength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">string_at</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span></div>
<div class="viewcode-block" id="iXpbBuilder.get_buffer_length"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iXpbBuilder.get_buffer_length">[docs]</a>    <span class="k">def</span> <span class="nf">get_buffer_length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Returns length of parameters block.&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getBufferLength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iXpbBuilder.get_buffer"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iXpbBuilder.get_buffer">[docs]</a>    <span class="k">def</span> <span class="nf">get_buffer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="s2">&quot;Returns the parameters block.&quot;</span>
        <span class="n">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getBuffer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_buffer_length</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">string_at</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span></div></div>

<span class="c1"># IUtil(2) : Versioned</span>
<div class="viewcode-block" id="iUtil_v2"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil_v2">[docs]</a><span class="k">class</span> <span class="nc">iUtil_v2</span><span class="p">(</span><span class="n">iVersioned</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IUtil v2 interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">2</span>
<div class="viewcode-block" id="iUtil_v2.get_fb_version"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil_v2.get_fb_version">[docs]</a>    <span class="k">def</span> <span class="nf">get_fb_version</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attachment</span><span class="p">:</span> <span class="n">iAttachment</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">iVersionCallbackImpl</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Produce long and beautiful report about firebird version used.</span>
<span class="sd">It may be seen in ISQL when invoked with -Z switch.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getFbVersion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">attachment</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iUtil_v2.load_blob"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil_v2.load_blob">[docs]</a>    <span class="k">def</span> <span class="nf">load_blob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">blob_id</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_QUAD</span><span class="p">,</span> <span class="n">attachment</span><span class="p">:</span> <span class="n">iAttachment</span><span class="p">,</span>
                  <span class="n">transaction</span><span class="p">:</span> <span class="n">iTransaction</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">is_text</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Load blob from file&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">loadBlob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">blob_id</span><span class="p">),</span> <span class="n">attachment</span><span class="p">,</span>
                             <span class="n">transaction</span><span class="p">,</span> <span class="n">filename</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">is_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iUtil_v2.dump_blob"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil_v2.dump_blob">[docs]</a>    <span class="k">def</span> <span class="nf">dump_blob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">blob_id</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_QUAD</span><span class="p">,</span> <span class="n">attachment</span><span class="p">:</span> <span class="n">iAttachment</span><span class="p">,</span>
                  <span class="n">transaction</span><span class="p">:</span> <span class="n">iTransaction</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">is_text</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Save blob to file&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">dumpBlob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">blob_id</span><span class="p">),</span> <span class="n">attachment</span><span class="p">,</span>
                             <span class="n">transaction</span><span class="p">,</span> <span class="n">filename</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">is_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iUtil_v2.get_perf_counters"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil_v2.get_perf_counters">[docs]</a>    <span class="k">def</span> <span class="nf">get_perf_counters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attachment</span><span class="p">:</span> <span class="n">iAttachment</span><span class="p">,</span> <span class="n">counters_set</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Get statistics for given attachment&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">Int64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getPerfCounters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">attachment</span><span class="p">,</span> <span class="n">counters_set</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span>
                                    <span class="n">byref</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iUtil_v2.execute_create_database"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil_v2.execute_create_database">[docs]</a>    <span class="k">def</span> <span class="nf">execute_create_database</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stmt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dialect</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iAttachment</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute “CREATE DATABASE ...” statement – ISC trick with NULL statement</span>
<span class="sd">handle does not work with interfaces.&quot;&quot;&quot;</span>
        <span class="n">b_stmt</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">executeCreateDatabase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_stmt</span><span class="p">),</span> <span class="n">b_stmt</span><span class="p">,</span>
                                                   <span class="n">dialect</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">c_byte</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iAttachment</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iUtil_v2.decode_date"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil_v2.decode_date">[docs]</a>    <span class="k">def</span> <span class="nf">decode_date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">ISC_DATE</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_decode_sql_date()`&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="n">date</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_DATE</span><span class="o">.</span><span class="n">from_buffer_copy</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
        <span class="n">year</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">month</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">day</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">decodeDate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">year</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="n">month</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="n">day</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="n">year</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">month</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">day</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="iUtil_v2.decode_time"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil_v2.decode_time">[docs]</a>    <span class="k">def</span> <span class="nf">decode_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atime</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">ISC_TIME</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">time</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_decode_sql_time()`&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atime</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="n">atime</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_TIME</span><span class="o">.</span><span class="n">from_buffer_copy</span><span class="p">(</span><span class="n">atime</span><span class="p">)</span>
        <span class="n">hours</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">minutes</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">seconds</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">fractions</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">decodeTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atime</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">hours</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="n">minutes</span><span class="p">),</span>
                               <span class="n">byref</span><span class="p">(</span><span class="n">seconds</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="n">fractions</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">time</span><span class="p">(</span><span class="n">hours</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">minutes</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">seconds</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">fractions</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span></div>
<div class="viewcode-block" id="iUtil_v2.encode_date"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil_v2.encode_date">[docs]</a>    <span class="k">def</span> <span class="nf">encode_date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_DATE</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `isc_encode_sql_date()`&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">encodeDate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">date</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">date</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">date</span><span class="o">.</span><span class="n">day</span><span class="p">)</span></div>
<div class="viewcode-block" id="iUtil_v2.encode_time"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil_v2.encode_time">[docs]</a>    <span class="k">def</span> <span class="nf">encode_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atime</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">time</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_TIME</span><span class="p">:</span>
        <span class="s2">&quot;Replaces isc_encode_sql_time()&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">encodeTime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atime</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">atime</span><span class="o">.</span><span class="n">minute</span><span class="p">,</span> <span class="n">atime</span><span class="o">.</span><span class="n">second</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">atime</span><span class="o">.</span><span class="n">microsecond</span> <span class="o">/</span> <span class="mi">100</span><span class="p">))</span></div>
<div class="viewcode-block" id="iUtil_v2.format_status"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil_v2.format_status">[docs]</a>    <span class="k">def</span> <span class="nf">format_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">:</span> <span class="n">iStatus</span><span class="p">,</span> <span class="n">encoding</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">err_encoding</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s2">&quot;Replaces `fb_interpret()`.&quot;</span>
        <span class="n">buffer</span> <span class="o">=</span> <span class="n">create_string_buffer</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">formatStatus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">buffer</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encoding</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="iUtil_v2.get_client_version"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil_v2.get_client_version">[docs]</a>    <span class="k">def</span> <span class="nf">get_client_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Returns integer, containing major version in byte 0 and minor version in byte 1&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getClientVersion</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>
<div class="viewcode-block" id="iUtil_v2.get_xpb_builder"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil_v2.get_xpb_builder">[docs]</a>    <span class="k">def</span> <span class="nf">get_xpb_builder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="p">:</span> <span class="n">XpbKind</span><span class="p">,</span> <span class="n">buffer</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iXpbBuilder</span><span class="p">:</span>
        <span class="s2">&quot;Returns XpbBuilder interface.&quot;</span>
        <span class="k">if</span> <span class="n">buffer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getXpbBuilder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">kind</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getXpbBuilder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">kind</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">buffer</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iXpbBuilder</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iUtil_v2.set_offsets"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil_v2.set_offsets">[docs]</a>    <span class="k">def</span> <span class="nf">set_offsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata</span><span class="p">:</span> <span class="n">iMessageMetadata</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">iOffsetsCallbackImp</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Sets valid offsets in MessageMetadata. Performs calls to callback in OffsetsCallback for each field/parameter.&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">setOffsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div></div>

<span class="c1"># &gt;&gt;&gt; Firebird 4</span>
<span class="c1"># IUtil(4) : IUtil(2)</span>
<div class="viewcode-block" id="iUtil"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil">[docs]</a><span class="k">class</span> <span class="nc">iUtil</span><span class="p">(</span><span class="n">iUtil_v2</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IUtil v4 interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">STR_SIZE</span> <span class="o">=</span> <span class="mi">200</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">intf</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">intf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hours</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minutes</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seconds</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fractions</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span> <span class="o">=</span> <span class="n">create_string_buffer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STR_SIZE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_tz</span> <span class="o">=</span> <span class="n">create_string_buffer</span><span class="p">(</span><span class="n">sizeof</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ISC_TIME_TZ</span><span class="p">()))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp_tz</span> <span class="o">=</span> <span class="n">create_string_buffer</span><span class="p">(</span><span class="n">sizeof</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ISC_TIMESTAMP_TZ</span><span class="p">()))</span>
<div class="viewcode-block" id="iUtil.get_decfloat16"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil.get_decfloat16">[docs]</a>    <span class="k">def</span> <span class="nf">get_decfloat16</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iDecFloat16</span><span class="p">:</span>
        <span class="s2">&quot;Returns iDecFloat16 interface.&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getDecFloat16</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iDecFloat16</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iUtil.get_decfloat34"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil.get_decfloat34">[docs]</a>    <span class="k">def</span> <span class="nf">get_decfloat34</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iDecFloat34</span><span class="p">:</span>
        <span class="s2">&quot;Returns iDecFloat34 interface.&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getDecFloat34</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iDecFloat34</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iUtil.decode_time_tz"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil.decode_time_tz">[docs]</a>    <span class="k">def</span> <span class="nf">decode_time_tz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timetz</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">ISC_TIME_TZ</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">time</span><span class="p">:</span>
        <span class="s2">&quot;Decodes TIME WITH TIMEZONE from internal format to datetime.time with tzinfo.&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">timetz</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="n">timetz</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_TIME_TZ</span><span class="o">.</span><span class="n">from_buffer_copy</span><span class="p">(</span><span class="n">timetz</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hours</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minutes</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seconds</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fractions</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">memset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">STR_SIZE</span><span class="p">)</span>
        <span class="c1"># procedure decodeTimeTz(this: IUtil; status: IStatus; timeTz: ISC_TIME_TZPtr;</span>
        <span class="c1">#                        hours: CardinalPtr; minutes: CardinalPtr;</span>
        <span class="c1">#                        seconds: CardinalPtr; fractions: CardinalPtr;</span>
        <span class="c1">#                        timeZoneBufferLength: Cardinal; timeZoneBuffer: PAnsiChar)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">decodeTimeTz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">timetz</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hours</span><span class="p">),</span>
                                 <span class="n">byref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minutes</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seconds</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fractions</span><span class="p">),</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">STR_SIZE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="n">tz</span> <span class="o">=</span> <span class="n">get_timezone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hours</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minutes</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">seconds</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">fractions</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="n">tz</span><span class="p">)</span></div>
<div class="viewcode-block" id="iUtil.decode_timestamp_tz"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil.decode_timestamp_tz">[docs]</a>    <span class="k">def</span> <span class="nf">decode_timestamp_tz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestamptz</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">ISC_TIMESTAMP_TZ</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
        <span class="s2">&quot;Decodes TIMESTAMP WITH TIMEZONE from internal format to datetime.datetime with tzinfo.&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">timestamptz</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="n">timestamptz</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_TIMESTAMP_TZ</span><span class="o">.</span><span class="n">from_buffer_copy</span><span class="p">(</span><span class="n">timestamptz</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hours</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minutes</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seconds</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fractions</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">memset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">STR_SIZE</span><span class="p">)</span>
        <span class="c1"># procedure decodeTimeStampTz(this: IUtil; status: IStatus; timeStampTz: ISC_TIMESTAMP_TZPtr;</span>
        <span class="c1">#                             year: CardinalPtr; month: CardinalPtr; day: CardinalPtr;</span>
        <span class="c1">#                             hours: CardinalPtr; minutes: CardinalPtr;</span>
        <span class="c1">#                             seconds: CardinalPtr; fractions: CardinalPtr;</span>
        <span class="c1">#                             timeZoneBufferLength: Cardinal; timeZoneBuffer: PAnsiChar)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">decodeTimeStampTz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">timestamptz</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">),</span>
                                      <span class="n">byref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">month</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hours</span><span class="p">),</span>
                                      <span class="n">byref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minutes</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seconds</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fractions</span><span class="p">),</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">STR_SIZE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="n">tz</span> <span class="o">=</span> <span class="n">get_timezone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">hours</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minutes</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">seconds</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">fractions</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="n">tz</span><span class="p">)</span></div>
<div class="viewcode-block" id="iUtil.encode_time_tz"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil.encode_time_tz">[docs]</a>    <span class="k">def</span> <span class="nf">encode_time_tz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">time</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="s2">&quot;Encodes datetime.time with tzinfo into internal format for TIME WITH TIMEZONE.&quot;</span>
        <span class="n">tzname</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">,</span> <span class="s1">&#39;_timezone_&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tzname</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InterfaceError</span><span class="p">(</span><span class="s2">&quot;Time timezone not set or does not have a name&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">tzname</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">memset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tz</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
        <span class="c1"># procedure encodeTimeTz(this: IUtil; status: IStatus; timeTz: ISC_TIME_TZPtr;</span>
        <span class="c1">#                        hours: Cardinal; minutes: Cardinal; seconds: Cardinal;</span>
        <span class="c1">#                        fractions: Cardinal; timeZone: PAnsiChar)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">encodeTimeTz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">cast</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_tz</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_TIME_TZ_PTR</span><span class="p">),</span>
                                 <span class="n">time</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">minute</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">second</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">microsecond</span> <span class="o">//</span> <span class="mi">100</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_tz</span><span class="o">.</span><span class="n">raw</span></div>
<div class="viewcode-block" id="iUtil.encode_timestamp_tz"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil.encode_timestamp_tz">[docs]</a>    <span class="k">def</span> <span class="nf">encode_timestamp_tz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="s2">&quot;Encodes datetime.datetime with tzinfo into internal format for TIMESTAMP WITH TIMEZONE.&quot;</span>
        <span class="n">tzname</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">timestamp</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">,</span> <span class="s1">&#39;_timezone_&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tzname</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InterfaceError</span><span class="p">(</span><span class="s2">&quot;Datetime timezone not set or does not have a name&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">tzname</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">memset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp_tz</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
        <span class="c1"># procedure encodeTimeStampTz(this: IUtil; status: IStatus; timeStampTz: ISC_TIMESTAMP_TZPtr;</span>
        <span class="c1">#                             year: Cardinal; month: Cardinal; day: Cardinal;</span>
        <span class="c1">#                             hours: Cardinal; minutes: Cardinal; seconds: Cardinal;</span>
        <span class="c1">#                             fractions: Cardinal; timeZone: PAnsiChar)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">encodeTimeStampTz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">cast</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp_tz</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_TIMESTAMP_TZ_PTR</span><span class="p">),</span>
                                      <span class="n">timestamp</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">.</span><span class="n">day</span><span class="p">,</span>
                                      <span class="n">timestamp</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">.</span><span class="n">minute</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">.</span><span class="n">second</span><span class="p">,</span>
                                      <span class="n">timestamp</span><span class="o">.</span><span class="n">microsecond</span> <span class="o">//</span> <span class="mi">100</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp_tz</span><span class="o">.</span><span class="n">raw</span></div>
<div class="viewcode-block" id="iUtil.get_int128"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil.get_int128">[docs]</a>    <span class="k">def</span> <span class="nf">get_int128</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iInt128</span><span class="p">:</span>
        <span class="s2">&quot;Returns iInt128 interface.&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getInt128</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iInt128</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iUtil.decode_time_tz_ex"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil.decode_time_tz_ex">[docs]</a>    <span class="k">def</span> <span class="nf">decode_time_tz_ex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timetz</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_TIME_TZ_EX</span><span class="p">,</span> <span class="n">hours</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">,</span> <span class="n">minutes</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">,</span>
                          <span class="n">seconds</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">,</span> <span class="n">fractions</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">,</span> <span class="n">zone_bufer</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="s2">&quot;TODO&quot;</span>
        <span class="c1"># procedure decodeTimeTzEx(this: IUtil; status: IStatus; timeTz: ISC_TIME_TZ_EXPtr;</span>
        <span class="c1">#                          hours: CardinalPtr; minutes: CardinalPtr; seconds: CardinalPtr;</span>
        <span class="c1">#                          fractions: CardinalPtr; timeZoneBufferLength: Cardinal;</span>
        <span class="c1">#                          timeZoneBuffer: PAnsiChar)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">decodeTimeTzEx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">timetz</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="n">hours</span><span class="p">),</span>
                                 <span class="n">byref</span><span class="p">(</span><span class="n">minutes</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="n">seconds</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="n">fractions</span><span class="p">),</span>
                                 <span class="nb">len</span><span class="p">(</span><span class="n">zone_bufer</span><span class="p">),</span> <span class="n">zone_bufer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div>
<div class="viewcode-block" id="iUtil.decode_timestamp_tz_ex"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iUtil.decode_timestamp_tz_ex">[docs]</a>    <span class="k">def</span> <span class="nf">decode_timestamp_tz_ex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestamptz</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">ISC_TIMESTAMP_TZ_EX</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">,</span>
                               <span class="n">month</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">,</span> <span class="n">day</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">,</span> <span class="n">hours</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">,</span>
                               <span class="n">minutes</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">,</span> <span class="n">seconds</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">,</span> <span class="n">fractions</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">,</span>
                               <span class="n">zone_bufer</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="s2">&quot;TODO&quot;</span>
        <span class="c1"># procedure decodeTimeStampTzEx(this: IUtil; status: IStatus; timeStampTz: ISC_TIMESTAMP_TZ_EXPtr;</span>
        <span class="c1">#                               year: CardinalPtr; month: CardinalPtr; day: CardinalPtr;</span>
        <span class="c1">#                               hours: CardinalPtr; minutes: CardinalPtr;</span>
        <span class="c1">#                               seconds: CardinalPtr; fractions: CardinalPtr;</span>
        <span class="c1">#                               timeZoneBufferLength: Cardinal; timeZoneBuffer: PAnsiChar)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">decodeTimeStampTzEx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">timestamptz</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="n">year</span><span class="p">),</span>
                                        <span class="n">byref</span><span class="p">(</span><span class="n">month</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="n">day</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="n">hours</span><span class="p">),</span>
                                        <span class="n">byref</span><span class="p">(</span><span class="n">minutes</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="n">seconds</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="n">fractions</span><span class="p">),</span>
                                        <span class="nb">len</span><span class="p">(</span><span class="n">zone_bufer</span><span class="p">),</span> <span class="n">zone_bufer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span></div></div>

<span class="c1"># IDecFloat16(2) : Versioned</span>
<div class="viewcode-block" id="iDecFloat16"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iDecFloat16">[docs]</a><span class="k">class</span> <span class="nc">iDecFloat16</span><span class="p">(</span><span class="n">iVersioned</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IDecFloat16 interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">BCD_SIZE</span> <span class="o">=</span> <span class="mi">16</span>
    <span class="n">STR_SIZE</span> <span class="o">=</span> <span class="mi">24</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">intf</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">intf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sign</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">Int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">Int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bcd</span> <span class="o">=</span> <span class="n">create_string_buffer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STR_SIZE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span> <span class="o">=</span> <span class="n">create_string_buffer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STR_SIZE</span><span class="p">)</span>
<div class="viewcode-block" id="iDecFloat16.to_bcd"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iDecFloat16.to_bcd">[docs]</a>    <span class="k">def</span> <span class="nf">to_bcd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">FB_DEC16</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BCD</span><span class="p">:</span>
        <span class="s2">&quot;Convert decimal float value to BCD&quot;</span>
        <span class="c1"># procedure toBcd(this: IDecFloat16; from: FB_DEC16Ptr; sign: IntegerPtr; bcd: BytePtr; exp: IntegerPtr)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sign</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">memset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bcd</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">BCD_SIZE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">toBcd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sign</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">bcd</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exp</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">BCD</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sign</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bcd</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="iDecFloat16.to_str"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iDecFloat16.to_str">[docs]</a>    <span class="k">def</span> <span class="nf">to_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">FB_DEC16</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s2">&quot;Convert decimal float value to string&quot;</span>
        <span class="c1"># procedure toString(this: IDecFloat16; status: IStatus; from: FB_DEC16Ptr; bufferLength: Cardinal; buffer: PAnsiChar)</span>
        <span class="n">memset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">STR_SIZE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">toString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">STR_SIZE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span></div>
<div class="viewcode-block" id="iDecFloat16.from_bcd"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iDecFloat16.from_bcd">[docs]</a>    <span class="k">def</span> <span class="nf">from_bcd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">BCD</span><span class="p">,</span> <span class="n">into</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">FB_DEC16</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">FB_DEC16</span><span class="p">:</span>
        <span class="s2">&quot;Make decimal float value from BCD&quot;</span>
        <span class="c1"># procedure fromBcd(this: IDecFloat16; sign: Integer; bcd: BytePtr; exp: Integer; to_: FB_DEC16Ptr)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">FB_DEC16</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">into</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">into</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">fromBcd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">sign</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">exp</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iDecFloat16.from_str"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iDecFloat16.from_str">[docs]</a>    <span class="k">def</span> <span class="nf">from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">into</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">FB_DEC16</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">FB_DEC16</span><span class="p">:</span>
        <span class="s2">&quot;Make decimal float value from string&quot;</span>
        <span class="c1"># procedure fromString(this: IDecFloat16; status: IStatus; from: PAnsiChar; to_: FB_DEC16Ptr)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">FB_DEC16</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">into</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">into</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">fromString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">byref</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div></div>

<span class="c1"># IDecFloat34(2) : Versioned</span>
<div class="viewcode-block" id="iDecFloat34"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iDecFloat34">[docs]</a><span class="k">class</span> <span class="nc">iDecFloat34</span><span class="p">(</span><span class="n">iVersioned</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IDecFloat34 interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">BCD_SIZE</span> <span class="o">=</span> <span class="mi">34</span>
    <span class="n">STR_SIZE</span> <span class="o">=</span> <span class="mi">43</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">intf</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">intf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sign</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">Int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">Int</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bcd</span> <span class="o">=</span> <span class="n">create_string_buffer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STR_SIZE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span> <span class="o">=</span> <span class="n">create_string_buffer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STR_SIZE</span><span class="p">)</span>
<div class="viewcode-block" id="iDecFloat34.to_bcd"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iDecFloat34.to_bcd">[docs]</a>    <span class="k">def</span> <span class="nf">to_bcd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">FB_DEC34</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BCD</span><span class="p">:</span>
        <span class="s2">&quot;Convert decimal float value to BCD&quot;</span>
        <span class="c1"># procedure toBcd(this: IDecFloat34; from: FB_DEC34Ptr; sign: IntegerPtr; bcd: BytePtr; exp: IntegerPtr)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sign</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">memset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bcd</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">BCD_SIZE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">toBcd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">byref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sign</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">bcd</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exp</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">BCD</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sign</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bcd</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>
<div class="viewcode-block" id="iDecFloat34.to_str"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iDecFloat34.to_str">[docs]</a>    <span class="k">def</span> <span class="nf">to_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">FB_DEC34</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s2">&quot;Convert decimal float value to string&quot;</span>
        <span class="c1"># procedure toString(this: IDecFloat34; status: IStatus; from: FB_DEC34Ptr; bufferLength: Cardinal; buffer: PAnsiChar)</span>
        <span class="n">memset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">STR_SIZE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">toString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">STR_SIZE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span></div>
<div class="viewcode-block" id="iDecFloat34.from_bcd"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iDecFloat34.from_bcd">[docs]</a>    <span class="k">def</span> <span class="nf">from_bcd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">BCD</span><span class="p">,</span> <span class="n">into</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">FB_DEC34</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">FB_DEC34</span><span class="p">:</span>
        <span class="s2">&quot;Make decimal float value from BCD&quot;</span>
        <span class="c1"># procedure fromBcd(this: IDecFloat34; sign: Integer; bcd: BytePtr; exp: Integer; to_: FB_DEC34Ptr)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">FB_DEC34</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">into</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">into</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">fromBcd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">sign</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">exp</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span></div>
<div class="viewcode-block" id="iDecFloat34.from_str"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iDecFloat34.from_str">[docs]</a>    <span class="k">def</span> <span class="nf">from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">into</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">FB_DEC34</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">FB_DEC34</span><span class="p">:</span>
        <span class="s2">&quot;Make decimal float value from string&quot;</span>
        <span class="c1"># procedure fromString(this: IDecFloat34; status: IStatus; from: PAnsiChar; to_: FB_DEC34Ptr)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">FB_DEC34</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">into</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">into</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">fromString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">byref</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div></div>

<span class="c1"># IInt128(2) : Versioned</span>
<div class="viewcode-block" id="iInt128"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iInt128">[docs]</a><span class="k">class</span> <span class="nc">iInt128</span><span class="p">(</span><span class="n">iVersioned</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IInt128 interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">STR_SIZE</span> <span class="o">=</span> <span class="mi">46</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">intf</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">intf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span> <span class="o">=</span> <span class="n">create_string_buffer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">STR_SIZE</span><span class="p">)</span>
<div class="viewcode-block" id="iInt128.to_str"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iInt128.to_str">[docs]</a>    <span class="k">def</span> <span class="nf">to_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">FB_I128</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="s2">&quot;Converts INT128 to string&quot;</span>
        <span class="c1"># procedure toString(this: IInt128; status: IStatus; from: FB_I128Ptr; scale: Integer; bufferLength: Cardinal; buffer: PAnsiChar)</span>
        <span class="n">memset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">STR_SIZE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">toString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">byref</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">scale</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">STR_SIZE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">str_buf</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span></div>
<div class="viewcode-block" id="iInt128.from_str"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iInt128.from_str">[docs]</a>    <span class="k">def</span> <span class="nf">from_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">into</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">FB_I128</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">FB_I128</span><span class="p">:</span>
        <span class="s2">&quot;Converts string to INT128&quot;</span>
        <span class="c1"># procedure fromString(this: IInt128; status: IStatus; scale: Integer; from: PAnsiChar; to_: FB_I128Ptr)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">FB_I128</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">into</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">into</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">fromString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">byref</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div></div>

<span class="c1"># IMaster(2) : Versioned</span>
<div class="viewcode-block" id="iMaster"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMaster">[docs]</a><span class="k">class</span> <span class="nc">iMaster</span><span class="p">(</span><span class="n">iVersioned</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IMaster interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">2</span>
<div class="viewcode-block" id="iMaster.get_status"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMaster.get_status">[docs]</a>    <span class="k">def</span> <span class="nf">get_status</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iStatus</span><span class="p">:</span>
        <span class="s2">&quot;Get instance if `iStatus` interface.&quot;</span>
        <span class="k">return</span> <span class="n">iStatus</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getStatus</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>
<div class="viewcode-block" id="iMaster.get_dispatcher"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMaster.get_dispatcher">[docs]</a>    <span class="k">def</span> <span class="nf">get_dispatcher</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iProvider</span><span class="p">:</span>
        <span class="s2">&quot;Get instance of `iProvider` interface, implemented by yValve (main provider instance).&quot;</span>
        <span class="k">return</span> <span class="n">iProvider</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getDispatcher</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>
<div class="viewcode-block" id="iMaster.get_plugin_manager"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMaster.get_plugin_manager">[docs]</a>    <span class="k">def</span> <span class="nf">get_plugin_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iPluginManager</span><span class="p">:</span>
        <span class="s2">&quot;Get instance of `iPluginManager` interface.&quot;</span>
        <span class="k">return</span> <span class="n">iPluginManager</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getPluginManager</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>
<div class="viewcode-block" id="iMaster.get_timer_control"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMaster.get_timer_control">[docs]</a>    <span class="k">def</span> <span class="nf">get_timer_control</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iTimerControl</span><span class="p">:</span>
        <span class="s2">&quot;Get instance of `iTimerControl` interface.&quot;</span>
        <span class="k">return</span> <span class="n">iTimerControl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getTimerControl</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>
<div class="viewcode-block" id="iMaster.get_dtc"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMaster.get_dtc">[docs]</a>    <span class="k">def</span> <span class="nf">get_dtc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iDtc</span><span class="p">:</span>
        <span class="s2">&quot;Get instance of `iDtc` interface.&quot;</span>
        <span class="k">return</span> <span class="n">iDtc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getDtc</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>
<div class="viewcode-block" id="iMaster.register_attachment"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMaster.register_attachment">[docs]</a>    <span class="k">def</span> <span class="nf">register_attachment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">provider</span><span class="p">:</span> <span class="n">iProvider</span><span class="p">,</span> <span class="n">attachment</span><span class="p">:</span> <span class="n">iAttachment</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iAttachment</span><span class="p">:</span>
        <span class="s2">&quot;Information not available&quot;</span>
        <span class="k">return</span> <span class="n">iAttachment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">registerAttachment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">provider</span><span class="p">,</span> <span class="n">attachment</span><span class="p">))</span></div>
<div class="viewcode-block" id="iMaster.register_transaction"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMaster.register_transaction">[docs]</a>    <span class="k">def</span> <span class="nf">register_transaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attachment</span><span class="p">:</span> <span class="n">iAttachment</span><span class="p">,</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">iTransaction</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iTransaction</span><span class="p">:</span>
        <span class="s2">&quot;Information not available&quot;</span>
        <span class="k">return</span> <span class="n">iTransaction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">registerTransaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attachment</span><span class="p">,</span> <span class="n">transaction</span><span class="p">))</span></div>
<div class="viewcode-block" id="iMaster.get_metadata_builder"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMaster.get_metadata_builder">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata_builder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fieldCount</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iMetadataBuilder</span><span class="p">:</span>
        <span class="s2">&quot;Get instance of `iMetadataBuilder` interface.&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_status</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getMetadataBuilder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">fieldCount</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iMetadataBuilder</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>
<div class="viewcode-block" id="iMaster.server_mode"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMaster.server_mode">[docs]</a>    <span class="k">def</span> <span class="nf">server_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Information not available&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">serverMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span><span class="o">.</span><span class="n">value</span></div>
<div class="viewcode-block" id="iMaster.get_util_interface"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMaster.get_util_interface">[docs]</a>    <span class="k">def</span> <span class="nf">get_util_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iUtil</span><span class="p">:</span>
        <span class="s2">&quot;Get instance of `iUtil` interface.&quot;</span>
        <span class="k">return</span> <span class="n">iUtil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getUtilInterface</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>
<div class="viewcode-block" id="iMaster.get_config_manager"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMaster.get_config_manager">[docs]</a>    <span class="k">def</span> <span class="nf">get_config_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iConfigManager</span><span class="p">:</span>
        <span class="s2">&quot;Get instance of `iConfigManager` interface.&quot;</span>
        <span class="k">return</span> <span class="n">iConfigManager</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getConfigManager</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>
<div class="viewcode-block" id="iMaster.get_process_exiting"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iMaster.get_process_exiting">[docs]</a>    <span class="k">def</span> <span class="nf">get_process_exiting</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="s2">&quot;Information not available&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">getProcessExiting</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">value</span></div></div>

<span class="c1"># ------------------------------------------------------------------------------</span>
<span class="c1"># Interface implementations</span>
<span class="c1"># ------------------------------------------------------------------------------</span>
<div class="viewcode-block" id="iVersionedImpl"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iVersionedImpl">[docs]</a><span class="k">class</span> <span class="nc">iVersionedImpl</span><span class="p">:</span>
    <span class="s2">&quot;Base class for objects that implement IVersioned interface&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">vt</span><span class="p">,</span> <span class="n">vt_p</span><span class="p">,</span> <span class="n">intf_s</span><span class="p">,</span> <span class="n">intf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_intf</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__vtable</span> <span class="o">=</span> <span class="n">vt</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__intf</span> <span class="o">=</span> <span class="n">intf_s</span><span class="p">(</span><span class="n">vtable</span><span class="o">=</span><span class="n">vt_p</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__vtable</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_as_parameter_</span> <span class="o">=</span> <span class="n">intf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__intf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">c_ulong</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">VERSION</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_get_intf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">IVersioned_VTable</span><span class="p">,</span>
                <span class="n">a</span><span class="o">.</span><span class="n">IVersioned_VTablePtr</span><span class="p">,</span>
                <span class="n">a</span><span class="o">.</span><span class="n">IVersioned_struct</span><span class="p">,</span>
                <span class="n">a</span><span class="o">.</span><span class="n">IVersioned</span><span class="p">)</span>
    <span class="n">vtable</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_parameter_</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">contents</span><span class="p">)</span></div>

<div class="viewcode-block" id="iReferenceCountedImpl"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iReferenceCountedImpl">[docs]</a><span class="k">class</span> <span class="nc">iReferenceCountedImpl</span><span class="p">(</span><span class="n">iVersionedImpl</span><span class="p">):</span>
    <span class="s2">&quot;IReferenceCounted interface wrapper&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">addRef</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">IReferenceCounted_addRef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_ref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">release</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">IReferenceCounted_release</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">release</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_get_intf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">IReferenceCounted_VTable</span><span class="p">,</span>
                <span class="n">a</span><span class="o">.</span><span class="n">IReferenceCounted_VTablePtr</span><span class="p">,</span>
                <span class="n">a</span><span class="o">.</span><span class="n">IReferenceCounted_struct</span><span class="p">,</span>
                <span class="n">a</span><span class="o">.</span><span class="n">IReferenceCounted</span><span class="p">)</span>
<div class="viewcode-block" id="iReferenceCountedImpl.add_ref"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iReferenceCountedImpl.add_ref">[docs]</a>    <span class="k">def</span> <span class="nf">add_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Increase the reference by one&quot;</span></div>
<div class="viewcode-block" id="iReferenceCountedImpl.release"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iReferenceCountedImpl.release">[docs]</a>    <span class="k">def</span> <span class="nf">release</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;Decrease the reference by one&quot;</span></div></div>

<div class="viewcode-block" id="iDisposableImpl"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iDisposableImpl">[docs]</a><span class="k">class</span> <span class="nc">iDisposableImpl</span><span class="p">(</span><span class="n">iVersionedImpl</span><span class="p">):</span>
    <span class="s2">&quot;IDisposable interface wrapper&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">dispose</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">IDisposable_dispose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dispose</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_get_intf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">IDisposable_VTable</span><span class="p">,</span>
                <span class="n">a</span><span class="o">.</span><span class="n">IDisposable_VTablePtr</span><span class="p">,</span>
                <span class="n">a</span><span class="o">.</span><span class="n">IDisposable_struct</span><span class="p">,</span>
                <span class="n">a</span><span class="o">.</span><span class="n">IDisposable</span><span class="p">)</span>
<div class="viewcode-block" id="iDisposableImpl.dispose"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iDisposableImpl.dispose">[docs]</a>    <span class="k">def</span> <span class="nf">dispose</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Dispose the interfaced object&quot;</span></div></div>

<div class="viewcode-block" id="iVersionCallbackImpl"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iVersionCallbackImpl">[docs]</a><span class="k">class</span> <span class="nc">iVersionCallbackImpl</span><span class="p">(</span><span class="n">iVersionedImpl</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IVersionCallback interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">callback</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">IVersionCallback_callback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_get_intf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">IVersionCallback_VTable</span><span class="p">,</span>
                <span class="n">a</span><span class="o">.</span><span class="n">IVersionCallback_VTablePtr</span><span class="p">,</span>
                <span class="n">a</span><span class="o">.</span><span class="n">IVersionCallback_struct</span><span class="p">,</span>
                <span class="n">a</span><span class="o">.</span><span class="n">IVersionCallback</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">this</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">IVersionCallback</span><span class="p">,</span> <span class="n">status</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">IStatus</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="n">c_char_p</span><span class="p">):</span> <span class="c1"># pylint: disable=W0613</span>
        <span class="k">with</span> <span class="n">suppress</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
<div class="viewcode-block" id="iVersionCallbackImpl.callback"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iVersionCallbackImpl.callback">[docs]</a>    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Method called by engine&quot;</span></div></div>

<div class="viewcode-block" id="iCryptKeyCallbackImpl"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iCryptKeyCallbackImpl">[docs]</a><span class="k">class</span> <span class="nc">iCryptKeyCallbackImpl</span><span class="p">(</span><span class="n">iVersionedImpl</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps ICryptKeyCallback interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">callback</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">ICryptKeyCallback_callback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_get_intf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ICryptKeyCallback_VTable</span><span class="p">,</span>
                <span class="n">a</span><span class="o">.</span><span class="n">ICryptKeyCallback_VTablePtr</span><span class="p">,</span>
                <span class="n">a</span><span class="o">.</span><span class="n">ICryptKeyCallback_struct</span><span class="p">,</span>
                <span class="n">a</span><span class="o">.</span><span class="n">ICryptKeyCallback</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">this</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">ICryptKeyCallback</span><span class="p">,</span> <span class="n">data_length</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">c_void_p</span><span class="p">,</span> <span class="c1"># pylint: disable=W0613</span>
                   <span class="n">buffer_length</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">,</span> <span class="n">buffer</span><span class="p">:</span> <span class="n">c_void_p</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">suppress</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
            <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_crypt_key</span><span class="p">(</span><span class="n">data</span><span class="p">[:</span><span class="n">data_length</span><span class="p">],</span> <span class="n">buffer_length</span><span class="p">)</span>
            <span class="n">key_size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="n">buffer_length</span><span class="p">)</span>
            <span class="n">memmove</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">key_size</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">key_size</span>
<div class="viewcode-block" id="iCryptKeyCallbackImpl.get_crypt_key"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iCryptKeyCallbackImpl.get_crypt_key">[docs]</a>    <span class="k">def</span> <span class="nf">get_crypt_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">max_key_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span> <span class="c1"># pylint: disable=W0613</span>
        <span class="s2">&quot;Should return crypt key&quot;</span>
        <span class="k">return</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span></div></div>

<div class="viewcode-block" id="iOffsetsCallbackImp"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iOffsetsCallbackImp">[docs]</a><span class="k">class</span> <span class="nc">iOffsetsCallbackImp</span><span class="p">(</span><span class="n">iVersionedImpl</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps IOffsetsCallback interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">callback</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">IVersionCallback_callback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_get_intf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">IOffsetsCallback_VTable</span><span class="p">,</span>
                <span class="n">a</span><span class="o">.</span><span class="n">IOffsetsCallback_VTablePtr</span><span class="p">,</span>
                <span class="n">a</span><span class="o">.</span><span class="n">IOffsetsCallback_struct</span><span class="p">,</span>
                <span class="n">a</span><span class="o">.</span><span class="n">IOffsetsCallback</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">this</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">IOffsetsCallback</span><span class="p">,</span> <span class="n">status</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">IStatus</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">,</span> <span class="c1"># pylint: disable=W0613</span>
                   <span class="n">offset</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">,</span> <span class="n">nullOffset</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">suppress</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_offset</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">nullOffset</span><span class="p">)</span>
<div class="viewcode-block" id="iOffsetsCallbackImp.set_offset"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iOffsetsCallbackImp.set_offset">[docs]</a>    <span class="k">def</span> <span class="nf">set_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nullOffset</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Method called by engine&quot;</span></div></div>

<div class="viewcode-block" id="iEventCallbackImpl"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iEventCallbackImpl">[docs]</a><span class="k">class</span> <span class="nc">iEventCallbackImpl</span><span class="p">(</span><span class="n">iReferenceCountedImpl</span><span class="p">):</span>
    <span class="s2">&quot;IEventCallback interface wrapper&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">eventCallbackFunction</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">IEventCallback_eventCallbackFunction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_get_intf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">IEventCallback_VTable</span><span class="p">,</span>
                <span class="n">a</span><span class="o">.</span><span class="n">IEventCallback_VTablePtr</span><span class="p">,</span>
                <span class="n">a</span><span class="o">.</span><span class="n">IEventCallback_struct</span><span class="p">,</span>
                <span class="n">a</span><span class="o">.</span><span class="n">IEventCallback</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">this</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">IVersionCallback</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">Cardinal</span><span class="p">,</span> <span class="n">events</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">BytePtr</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># pylint: disable=W0613</span>
        <span class="k">with</span> <span class="n">suppress</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">events_arrived</span><span class="p">(</span><span class="n">string_at</span><span class="p">(</span><span class="n">events</span><span class="p">,</span> <span class="n">length</span><span class="p">))</span>
<div class="viewcode-block" id="iEventCallbackImpl.events_arrived"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iEventCallbackImpl.events_arrived">[docs]</a>    <span class="k">def</span> <span class="nf">events_arrived</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">events</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Method called by engine&quot;</span></div></div>

<div class="viewcode-block" id="iTimerImpl"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iTimerImpl">[docs]</a><span class="k">class</span> <span class="nc">iTimerImpl</span><span class="p">(</span><span class="n">iReferenceCountedImpl</span><span class="p">):</span>
    <span class="s2">&quot;Class that wraps ITimer interface for use from Python&quot;</span>
    <span class="n">VERSION</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vtable</span><span class="o">.</span><span class="n">handler</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">ITimer_handler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__callback</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_get_intf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ITimer_VTable</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">ITimer_VTablePtr</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">ITimer_struct</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">ITimer</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">this</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">ITimer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># pylint: disable=W0613</span>
        <span class="k">with</span> <span class="n">suppress</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handler</span><span class="p">()</span>
<div class="viewcode-block" id="iTimerImpl.handler"><a class="viewcode-back" href="../../../ref-intf.html#firebird.driver.interfaces.iTimerImpl.handler">[docs]</a>    <span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="s2">&quot;Timer callback handler&quot;</span></div></div>

<span class="c1"># API_LOADED hook</span>
<span class="k">def</span> <span class="nf">__augment_api</span><span class="p">(</span><span class="n">api</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">FirebirdAPI</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">wrap</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">iMaster</span><span class="p">:</span> <span class="c1"># pylint: disable=W0613</span>
        <span class="k">return</span> <span class="n">iMaster</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="n">api</span><span class="o">.</span><span class="n">fb_get_master_interface</span><span class="o">.</span><span class="n">errcheck</span> <span class="o">=</span> <span class="n">wrap</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">],</span> <span class="s1">&#39;_master&#39;</span><span class="p">,</span> <span class="n">api</span><span class="o">.</span><span class="n">fb_get_master_interface</span><span class="p">())</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">],</span> <span class="s1">&#39;_util&#39;</span><span class="p">,</span> <span class="n">_master</span><span class="o">.</span><span class="n">get_util_interface</span><span class="p">())</span>
    <span class="n">api</span><span class="o">.</span><span class="n">master</span><span class="p">:</span> <span class="n">iMaster</span> <span class="o">=</span> <span class="n">_master</span>
    <span class="n">api</span><span class="o">.</span><span class="n">util</span><span class="p">:</span> <span class="n">iUtil</span> <span class="o">=</span> <span class="n">_util</span>

<span class="n">add_hook</span><span class="p">(</span><span class="n">APIHook</span><span class="o">.</span><span class="n">LOADED</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">FirebirdAPI</span><span class="p">,</span> <span class="n">__augment_api</span><span class="p">)</span>
</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020-2023, The Firebird Project.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.0.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>