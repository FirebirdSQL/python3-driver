<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="Docutils 0.19: https://docutils.sourceforge.io/" name="generator"/>
<title>Usage Guide — firebird-driver 1.9.0 documentation</title>
<link href="_static/pygments.css" rel="stylesheet" type="text/css"/>
<link href="_static/bootstrap-sphinx.css" rel="stylesheet" type="text/css"/>
<script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
<script src="_static/doctools.js"></script>
<script src="_static/sphinx_highlight.js"></script>
<link href="genindex.html" rel="index" title="Index"/>
<link href="search.html" rel="search" title="Search"/>
<link href="python-db-api-compliance.html" rel="next" title="Compliance to PyDB API 2.0"/>
<link href="getting-started.html" rel="prev" title="Getting Started"/>
<meta charset="utf-8"/>
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1" name="viewport"/>
<meta content="yes" name="apple-mobile-web-app-capable"/>
<script src="_static/js/jquery-1.12.4.min.js" type="text/javascript"></script>
<script src="_static/js/jquery-fix.js" type="text/javascript"></script>
<script src="_static/bootstrap-2.3.2/js/bootstrap.min.js" type="text/javascript"></script>
<script src="_static/bootstrap-sphinx.js" type="text/javascript"></script>
</head><body>
<div class="navbar navbar-inverse navbar-fixed-top" id="navbar">
<div class="navbar-inner">
<div class="container">
<!-- .btn-navbar is used as the toggle for collapsed navbar content -->
<button class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="brand" href="index.html">
          firebird-driver</a>
<span class="navbar-text pull-left"><b>1.9.0</b></span>
<div class="nav-collapse">
<ul class="nav">
<li class="divider-vertical"></li>
<li><a href="#">Usage Guide</a></li>
<li><a href="reference.html">Reference</a></li>
<li><a href="genindex.html">Index</a></li>
<li class="dropdown globaltoc-container">
<a data-target="#" data-toggle="dropdown" href="index.html" id="dLabelGlobalToc" role="button">Content <b class="caret"></b></a>
<ul aria-labelledby="dLabelGlobalToc" class="dropdown-menu globaltoc" role="menu"><p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="getting-started.html#installation">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="getting-started.html#installation-from-pypi">Installation from PYPI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="getting-started.html#quick-start-guide">Quick-start Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="getting-started.html#driver-configuration">Driver configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="getting-started.html#connecting-to-a-database">Connecting to a Database</a></li>
<li class="toctree-l3"><a class="reference internal" href="getting-started.html#creating-a-database">Creating a Database</a></li>
<li class="toctree-l3"><a class="reference internal" href="getting-started.html#executing-sql-statements">Executing SQL Statements</a></li>
<li class="toctree-l3"><a class="reference internal" href="getting-started.html#calling-stored-procedures">Calling Stored Procedures</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Usage Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#driver-structure">Driver structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-driver-config-object">The ‘driver_config’ object</a></li>
<li class="toctree-l3"><a class="reference internal" href="#server-and-database-configuration">Server and database configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#databases">Databases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-connect">Using connect()</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-create-database">Using create_database()</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deleting-databases">Deleting databases</a></li>
<li class="toctree-l3"><a class="reference internal" href="#connection-object">Connection object</a></li>
<li class="toctree-l3"><a class="reference internal" href="#closing-the-connection">Closing the connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#getting-information-about-connection">Getting information about connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#getting-information-about-database">Getting information about database</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#executing-sql-statements">Executing SQL Statements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cursor-object">Cursor object</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sql-execution-basics">SQL Execution Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fetching-data-from-server">Fetching data from server</a></li>
<li class="toctree-l3"><a class="reference internal" href="#index-13">Scrollable cursors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Parameterized statements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">Prepared Statements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#named-cursors">Named Cursors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#working-with-stored-procedures">Working with stored procedures</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#data-handling-and-conversions">Data handling and conversions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#implicit-conversion-of-input-parameters-from-strings">Implicit Conversion of Input Parameters from Strings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#automatic-conversion-from-to-unicode">Automatic conversion from/to Unicode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#working-with-blobs">Working with BLOBs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#firebird-array-type">Firebird ARRAY type</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#transanction-management">Transanction management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basics">Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#auto-commit">Auto-commit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#transaction-parameters">Transaction parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#getting-information-about-transaction">Getting information about transaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#retaining-transactions">Retaining transactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#savepoints">Savepoints</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-multiple-transactions-with-the-same-connection">Using multiple transactions with the same connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#distributed-transactions">Distributed Transactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#transaction-context-manager">Transaction Context Manager</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#database-events">Database Events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-they-are">What they are</a></li>
<li class="toctree-l3"><a class="reference internal" href="#why-use-them">Why use them</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-events-are-exposed">How events are exposed</a></li>
<li class="toctree-l3"><a class="reference internal" href="#api-for-python-developers">API for Python developers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#working-with-services">Working with Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#services-api-connections">Services API Connections</a></li>
<li class="toctree-l3"><a class="reference internal" href="#text-output-from-services">Text output from Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="#server-configuration-and-state-information">Server Configuration and State information</a></li>
<li class="toctree-l3"><a class="reference internal" href="#database-options">Database options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#database-maintenance">Database maintenance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#user-maintenance">User maintenance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#trace-sessions">Trace sessions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#logging-driver-activities">Logging driver activities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#index-43">Driver hooks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#apihook">APIHook</a></li>
<li class="toctree-l3"><a class="reference internal" href="#connectionhook">ConnectionHook</a></li>
<li class="toctree-l3"><a class="reference internal" href="#serverhook">ServerHook</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="python-db-api-compliance.html">Compliance to PyDB API 2.0</a><ul>
<li class="toctree-l2"><a class="reference internal" href="python-db-api-compliance.html#unsupported-optional-features">Unsupported Optional Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="python-db-api-compliance.html#supported-optional-features">Supported Optional Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="python-db-api-compliance.html#nominally-supported-optional-features">Nominally Supported Optional Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="python-db-api-compliance.html#extensions-and-caveats">Extensions and Caveats</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Firebird-driver Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="reference.html#driver-modules">Driver modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ref-main.html">Main driver namespace</a></li>
<li class="toctree-l3"><a class="reference internal" href="ref-types.html">firebird.driver.types</a></li>
<li class="toctree-l3"><a class="reference internal" href="ref-config.html">firebird.driver.config</a></li>
<li class="toctree-l3"><a class="reference internal" href="ref-core.html">firebird.driver.core</a></li>
<li class="toctree-l3"><a class="reference internal" href="ref-hooks.html">firebird.driver.hooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="ref-intf.html">firebird.driver.interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="ref-fbapi.html">firebird.driver.fbapi</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-9-0">Version 1.9.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-8-0">Version 1.8.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-7-0">Version 1.7.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-6-0">Version 1.6.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-5-2">Version 1.5.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-5-1">Version 1.5.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-5-0">Version 1.5.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#potentially-breaking-changes">Potentially breaking changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-4-3">Version 1.4.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-4-2">Version 1.4.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-4-1">Version 1.4.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-4-0">Version 1.4.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#improvements">Improvements:</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#backward-incompatible-changes">Backward incompatible changes:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-3-4">Version 1.3.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-3-3">Version 1.3.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-3-2">Version 1.3.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-3-1">Version 1.3.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-3-0">Version 1.3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-2-1">Version 1.2.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-2-0">Version 1.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-1-0">Version 1.1.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-1-0-0">Version 1.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-8-0">Version 0.8.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-7-0">Version 0.7.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-6-0">Version 0.6.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#version-0-5-0">Version 0.5.0</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>
</ul>
</li>
<li class="dropdown">
<a data-target="#" data-toggle="dropdown" href="#" id="dLabelLocalToc" role="button">Page <b class="caret"></b></a>
<ul aria-labelledby="dLabelLocalToc" class="dropdown-menu localtoc" role="menu"><ul>
<li><a class="reference internal" href="#">Usage Guide</a><ul>
<li><a class="reference internal" href="#driver-structure">Driver structure</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a><ul>
<li><a class="reference internal" href="#the-driver-config-object">The ‘driver_config’ object</a></li>
<li><a class="reference internal" href="#server-and-database-configuration">Server and database configuration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#databases">Databases</a><ul>
<li><a class="reference internal" href="#using-connect">Using connect()</a></li>
<li><a class="reference internal" href="#using-create-database">Using create_database()</a></li>
<li><a class="reference internal" href="#deleting-databases">Deleting databases</a></li>
<li><a class="reference internal" href="#connection-object">Connection object</a></li>
<li><a class="reference internal" href="#closing-the-connection">Closing the connection</a></li>
<li><a class="reference internal" href="#getting-information-about-connection">Getting information about connection</a></li>
<li><a class="reference internal" href="#getting-information-about-database">Getting information about database</a><ul>
<li><a class="reference internal" href="#getting-information-about-firebird-version">Getting information about Firebird version</a></li>
<li><a class="reference internal" href="#database-on-disk-structure">Database On-Disk Structure</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#executing-sql-statements">Executing SQL Statements</a><ul>
<li><a class="reference internal" href="#cursor-object">Cursor object</a></li>
<li><a class="reference internal" href="#sql-execution-basics">SQL Execution Basics</a></li>
<li><a class="reference internal" href="#fetching-data-from-server">Fetching data from server</a></li>
<li><a class="reference internal" href="#index-13">Scrollable cursors</a></li>
<li><a class="reference internal" href="#id3">Parameterized statements</a></li>
<li><a class="reference internal" href="#id5">Prepared Statements</a></li>
<li><a class="reference internal" href="#named-cursors">Named Cursors</a></li>
<li><a class="reference internal" href="#working-with-stored-procedures">Working with stored procedures</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-handling-and-conversions">Data handling and conversions</a><ul>
<li><a class="reference internal" href="#implicit-conversion-of-input-parameters-from-strings">Implicit Conversion of Input Parameters from Strings</a></li>
<li><a class="reference internal" href="#automatic-conversion-from-to-unicode">Automatic conversion from/to Unicode</a></li>
<li><a class="reference internal" href="#working-with-blobs">Working with BLOBs</a></li>
<li><a class="reference internal" href="#firebird-array-type">Firebird ARRAY type</a></li>
</ul>
</li>
<li><a class="reference internal" href="#transanction-management">Transanction management</a><ul>
<li><a class="reference internal" href="#basics">Basics</a></li>
<li><a class="reference internal" href="#auto-commit">Auto-commit</a></li>
<li><a class="reference internal" href="#transaction-parameters">Transaction parameters</a></li>
<li><a class="reference internal" href="#getting-information-about-transaction">Getting information about transaction</a></li>
<li><a class="reference internal" href="#retaining-transactions">Retaining transactions</a></li>
<li><a class="reference internal" href="#savepoints">Savepoints</a></li>
<li><a class="reference internal" href="#using-multiple-transactions-with-the-same-connection">Using multiple transactions with the same connection</a></li>
<li><a class="reference internal" href="#distributed-transactions">Distributed Transactions</a></li>
<li><a class="reference internal" href="#transaction-context-manager">Transaction Context Manager</a></li>
</ul>
</li>
<li><a class="reference internal" href="#database-events">Database Events</a><ul>
<li><a class="reference internal" href="#what-they-are">What they are</a></li>
<li><a class="reference internal" href="#why-use-them">Why use them</a></li>
<li><a class="reference internal" href="#how-events-are-exposed">How events are exposed</a></li>
<li><a class="reference internal" href="#api-for-python-developers">API for Python developers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-services">Working with Services</a><ul>
<li><a class="reference internal" href="#services-api-connections">Services API Connections</a></li>
<li><a class="reference internal" href="#text-output-from-services">Text output from Services</a></li>
<li><a class="reference internal" href="#server-configuration-and-state-information">Server Configuration and State information</a></li>
<li><a class="reference internal" href="#database-options">Database options</a></li>
<li><a class="reference internal" href="#database-maintenance">Database maintenance</a></li>
<li><a class="reference internal" href="#user-maintenance">User maintenance</a></li>
<li><a class="reference internal" href="#trace-sessions">Trace sessions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#logging-driver-activities">Logging driver activities</a></li>
<li><a class="reference internal" href="#index-43">Driver hooks</a><ul>
<li><a class="reference internal" href="#apihook">APIHook</a></li>
<li><a class="reference internal" href="#connectionhook">ConnectionHook</a></li>
<li><a class="reference internal" href="#serverhook">ServerHook</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
</ul>
<form action="search.html" class="navbar-form navbar-right" method="get">
<div class="form-group">
<input class="form-control" name="q" placeholder="Search" type="text"/>
</div>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
</div>
</div>
</div>
</div>
<div class="container">
<div class="row">
<div class="body span12 content" role="main">
<a class="dashAnchor" name="//apple_ref/cpp/Section/Usage Guide"></a><section id="usage-guide">
<h1>Usage Guide<a class="headerlink" href="#usage-guide" title="Permalink to this heading">¶</a></h1>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Driver structure"></a><section id="driver-structure">
<h2>Driver structure<a class="headerlink" href="#driver-structure" title="Permalink to this heading">¶</a></h2>
<p>Source code is currently divided into next submodules:</p>
<ul class="simple">
<li><p><a class="reference internal" href="ref-types.html#module-firebird.driver.types" title="firebird.driver.types: Firebird driver types"><code class="xref py py-mod docutils literal notranslate"><span class="pre">types</span></code></a> - Data types used by driver.</p></li>
<li><p><a class="reference internal" href="ref-intf.html#module-firebird.driver.interfaces" title="firebird.driver.interfaces: Interface wrappers for Firebird new API"><code class="xref py py-mod docutils literal notranslate"><span class="pre">interfaces</span></code></a> - Interface wrappers for Firebird new API</p></li>
<li><p><a class="reference internal" href="ref-core.html#module-firebird.driver.core" title="firebird.driver.core: Main Firebird driver code"><code class="xref py py-mod docutils literal notranslate"><span class="pre">core</span></code></a> - Main driver source code.</p></li>
<li><p><a class="reference internal" href="ref-fbapi.html#module-firebird.driver.fbapi" title="firebird.driver.fbapi: Python ctypes interface to Firebird client library"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fbapi</span></code></a> - Python <a class="reference external" href="https://docs.python.org/3/library/ctypes.html#module-ctypes" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ctypes</span></code></a> interface to Firebird client library.</p></li>
<li><p><a class="reference internal" href="ref-config.html#module-firebird.driver.config" title="firebird.driver.config: Driver configuration"><code class="xref py py-mod docutils literal notranslate"><span class="pre">config</span></code></a> - Driver configuration.</p></li>
<li><p><a class="reference internal" href="ref-hooks.html#module-firebird.driver.hooks" title="firebird.driver.hooks: Drivers hooks"><code class="xref py py-mod docutils literal notranslate"><span class="pre">hooks</span></code></a> - Drivers hooks.</p></li>
</ul>
<p>All important data, functions, classes and constants are available directly in <a class="reference internal" href="ref-main.html#module-firebird.driver" title="firebird.driver: Python 3+ Database API 2.0 Compliant driver for Firebird 3+"><code class="xref py py-obj docutils literal notranslate"><span class="pre">firebird.driver</span></code></a>
name space. In normal circumstances is not necessary to import sub-modules directly. However,
you may need them to access some not so frequently needed driver functionality like driver
hooks, or to implement your own callback interfaces.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">firebird-driver</span></code> is designed to support all Firebird versions starting from version 3.0.
Because each Firebird major version adds new functionality, and Firebird OO API could
be extended even in maintenance releases, the driver isolates volatile functionality
into special class hierarchies.</p>
<p>For example information about database (provided via <a class="reference internal" href="ref-intf.html#firebird.driver.interfaces.iAttachment_v3.get_info" title="firebird.driver.interfaces.iAttachment_v3.get_info"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_info()</span></code></a> API
call) is isolated into separate <a class="reference internal" href="ref-core.html#firebird.driver.core.DatabaseInfoProvider" title="firebird.driver.core.DatabaseInfoProvider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DatabaseInfoProvider</span></code></a> class hierarchy.
The <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.info" title="firebird.driver.core.Connection.info"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection.info</span></code></a> attribute then provides access to instance of appropriate class
- <a class="reference internal" href="ref-core.html#firebird.driver.core.DatabaseInfoProvider" title="firebird.driver.core.DatabaseInfoProvider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DatabaseInfoProvider</span></code></a> or its ancestor - for connected database.
The <a class="reference internal" href="ref-core.html#firebird.driver.core.DatabaseInfoProvider" title="firebird.driver.core.DatabaseInfoProvider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DatabaseInfoProvider</span></code></a> class <strong>always</strong> provides functionality of most recent
Firebird version supported by driver.</p>
<p>This layout has several important consequences:</p>
<ol class="arabic">
<li><p>The <a class="reference internal" href="ref-core.html#firebird.driver.core.DatabaseInfoProvider" title="firebird.driver.core.DatabaseInfoProvider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DatabaseInfoProvider</span></code></a> class may change in major driver release if new Firebird
functionality is introduced. This normally represent no problems for client application
as backward compatibility is guaranteed.</p></li>
<li><p>You should check the class hierarchy for “evolving” classes when you start using the
driver, and whenever you upgrade to new <strong>major</strong> driver version. If there are versioned
ancestor classes (they always have Firebird version number in their name) for canonical
(top level) ones, you should adjust your application to deal with situations when
instance of ancestor class is provided by driver instead top-level one, to prevent
run-time exceptions caused by access to functionality not provided by currently attached
Firebird server.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The same apply for low-level API (<a class="reference internal" href="ref-intf.html#module-firebird.driver.interfaces" title="firebird.driver.interfaces: Interface wrappers for Firebird new API"><code class="xref py py-obj docutils literal notranslate"><span class="pre">interfaces</span></code></a>) with difference
that they may change in minor driver releases (because API could be extended in
Firebird maintenance releases).</p>
</div>
</li>
</ol>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="ref-core.html#firebird.driver.core.DatabaseInfoProvider" title="firebird.driver.core.DatabaseInfoProvider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DatabaseInfoProvider</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionInfoProvider" title="firebird.driver.core.TransactionInfoProvider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionInfoProvider</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.ServerInfoProvider" title="firebird.driver.core.ServerInfoProvider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerInfoProvider</span></code></a>,
<a class="reference internal" href="ref-core.html#firebird.driver.core.ServerDbServices" title="firebird.driver.core.ServerDbServices"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerDbServices</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.ServerUserServices" title="firebird.driver.core.ServerUserServices"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerUserServices</span></code></a> and <a class="reference internal" href="ref-core.html#firebird.driver.core.ServerTraceServices" title="firebird.driver.core.ServerTraceServices"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerTraceServices</span></code></a>.</p>
</div>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Configuration"></a><section id="configuration">
<span id="index-0"></span><h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading">¶</a></h2>
<p>The driver uses configuration built on top of <a class="reference external" href="https://firebird-base.readthedocs.io/en/latest/config.html#module-firebird.base.config" title="(in Firebird-base v1.6.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">configuration</span> <span class="pre">system</span></code></a>
provided by <a class="reference external" href="https://firebird-base.rtfd.io">firebird-base</a> package. In addition to global settings, the configuration
also includes the definition of connection parameters to Firebird servers and databases.</p>
<p>The default configuration connects to embedded server using direct/local connection method.
To access remote servers and databases (or local ones through remote protocols), it’s
necessary to adjust default configuration, or <code class="xref py py-obj docutils literal notranslate"><span class="pre">register</span></code> them in configuration manager.</p>
<p>You can manipulate the configuration objects directly, or load configuration from files or
strings (in <code class="xref py py-obj docutils literal notranslate"><span class="pre">ini-style</span></code> <a class="reference external" href="https://docs.python.org/3/library/configparser.html#module-configparser" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">configparser</span></code></a> format).</p>
<a class="dashAnchor" name="//apple_ref/cpp/Section/The ‘driver_config’ object"></a><section id="the-driver-config-object">
<h3>The ‘driver_config’ object<a class="headerlink" href="#the-driver-config-object" title="Permalink to this heading">¶</a></h3>
<p>The global <a class="reference internal" href="ref-config.html#firebird.driver.config.driver_config" title="firebird.driver.config.driver_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">driver_config</span></code></a> object holds all configurable driver parameters, and access
configuration parameters for registered Firebird servers and databases.</p>
<p>In initial state, all parameters have default values and there are no registered servers
and databases. You can set individual parameter values directly, or you can set multiple
parameters (including registered servers and databases) at once by loading them from
configuration string, dict or file(s).</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If you want to use specific Firebird client library, you must set the value of
<a class="reference internal" href="ref-config.html#firebird.driver.config.DriverConfig.fb_client_library" title="firebird.driver.config.DriverConfig.fb_client_library"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DriverConfig.fb_client_library</span></code></a> configuration option <strong>before</strong> your application
calls any from following functions: <a class="reference internal" href="ref-core.html#firebird.driver.core.connect" title="firebird.driver.core.connect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">connect()</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.create_database" title="firebird.driver.core.create_database"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_database()</span></code></a>,
<a class="reference internal" href="ref-core.html#firebird.driver.core.connect_server" title="firebird.driver.core.connect_server"><code class="xref py py-obj docutils literal notranslate"><span class="pre">connect_server()</span></code></a>, <a class="reference internal" href="ref-fbapi.html#firebird.driver.fbapi.load_api" title="firebird.driver.fbapi.load_api"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_api()</span></code></a> or <a class="reference internal" href="ref-fbapi.html#firebird.driver.fbapi.get_api" title="firebird.driver.fbapi.get_api"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_api()</span></code></a>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="ref-config.html#firebird.driver.config.DriverConfig" title="firebird.driver.config.DriverConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DriverConfig</span></code></a> for list of available methods and parameters.</p>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Server and database configuration"></a><section id="server-and-database-configuration">
<h3>Server and database configuration<a class="headerlink" href="#server-and-database-configuration" title="Permalink to this heading">¶</a></h3>
<p>Firebird provides ever-increasing list of parameter options for database and server connections.
To keep the Python API clean and manageable, the <code class="xref py py-obj docutils literal notranslate"><span class="pre">firebird-driver</span></code> uses server and database
configuration objects instead function parameters to specify values for almost all such options.
Connection functions then provide a name parameter that can refer to particular server / database
or configuration, and few keyword parameters to specify / override selected options.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The configuration objects does not allow specification of next options:</p>
<ul class="simple">
<li><p>set database encryption callback (for technical reasons)</p></li>
<li><p>set db_key scope (for security reasons)</p></li>
<li><p>disable garbage collection (for security reasons)</p></li>
<li><p>disable database triggers (for security reasons)</p></li>
<li><p>allow overwrite of existing database with newly created database (for security reasons)</p></li>
</ul>
<p>These options could be specified only as keyword arguments in appropriate functions.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="ref-config.html#firebird.driver.config.ServerConfig" title="firebird.driver.config.ServerConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerConfig</span></code></a> and <a class="reference internal" href="ref-config.html#firebird.driver.config.DatabaseConfig" title="firebird.driver.config.DatabaseConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DatabaseConfig</span></code></a> for list of available methods and parameters.</p>
</div>
</section>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Databases"></a><section id="databases">
<span id="index-1"></span><h2>Databases<a class="headerlink" href="#databases" title="Permalink to this heading">¶</a></h2>
<p>Access to the database is made available through <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a> objects. Firebird-driver
provides two constructors for these:</p>
<ul class="simple">
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.connect" title="firebird.driver.core.connect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">connect</span></code></a> - Returns <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a> to database that already exists.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.create_database" title="firebird.driver.core.create_database"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_database</span></code></a> - Returns <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a> to newly created database.</p></li>
</ul>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Using connect()"></a><section id="using-connect">
<span id="index-2"></span><h3>Using connect()<a class="headerlink" href="#using-connect" title="Permalink to this heading">¶</a></h3>
<p>This constructor has one positional and several keyword parameters.</p>
<p>The value of <code class="xref py py-obj docutils literal notranslate"><span class="pre">database</span></code> positional parameter must be one of:</p>
<ul class="simple">
<li><p>name of registered database configuration</p></li>
<li><p>database name / alias</p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This value <strong>cannot</strong> be DSN / fully qualified Firebird connection string!</p>
</div>
<p>Keyword parameters are intended to override selected configuration options, or to specify
options that are not configurable.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="xref py py-obj docutils literal notranslate"><span class="pre">database</span></code> value is not recognized as name of registered database configuration,
the driver uses <a class="reference internal" href="ref-config.html#firebird.driver.config.DriverConfig.db_defaults" title="firebird.driver.config.DriverConfig.db_defaults"><code class="xref py py-obj docutils literal notranslate"><span class="pre">db_defaults</span></code></a> and <a class="reference internal" href="ref-config.html#firebird.driver.config.DriverConfig.server_defaults" title="firebird.driver.config.DriverConfig.server_defaults"><code class="xref py py-obj docutils literal notranslate"><span class="pre">server_defaults</span></code></a>
configuration objects.</p>
</div>
<p>A simple database connection is typically established with code such as this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span>

<span class="c1"># Attach to 'employee' database/alias using embedded server connection</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'sysdba'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span>

<span class="c1"># Attach to 'employee' database/alias using local server connection</span>
<span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">driver_config</span>
<span class="n">driver_config</span><span class="o">.</span><span class="n">server_defaults</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">'localhost'</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'sysdba'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span>

<span class="c1"># Set 'user' and 'password' via configuration</span>
<span class="n">driver_config</span><span class="o">.</span><span class="n">server_defaults</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">'SYSDBA'</span>
<span class="n">driver_config</span><span class="o">.</span><span class="n">server_defaults</span><span class="o">.</span><span class="n">password</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">'masterkey'</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">)</span>
</pre></div>
</div>
<p>However, it’s recommended to use specific configuration for servers and databases.
It’s possible to register servers and databases directly in code like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span><span class="p">,</span> <span class="n">driver_config</span>

<span class="c1"># Register Firebird server</span>
<span class="n">srv_cfg</span> <span class="o">=</span> <span class="s2">"""[local]</span>
<span class="s2">host = localhost</span>
<span class="s2">user = SYSDBA</span>
<span class="s2">password = masterkey</span>
<span class="s2">"""</span>
<span class="n">driver_config</span><span class="o">.</span><span class="n">register_server</span><span class="p">(</span><span class="s1">'local'</span><span class="p">,</span> <span class="n">srv_cfg</span><span class="p">)</span>

<span class="c1"># Register database</span>
<span class="n">db_cfg</span> <span class="o">=</span> <span class="s2">"""[employee]</span>
<span class="s2">server = local</span>
<span class="s2">database = employee.fdb</span>
<span class="s2">protocol = inet</span>
<span class="s2">charset = utf8</span>
<span class="s2">"""</span>
<span class="n">driver_config</span><span class="o">.</span><span class="n">register_database</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">db_cfg</span><span class="p">)</span>

<span class="c1"># Attach to 'employee' database</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">)</span>
</pre></div>
</div>
<p>But more convenient approach is using single configuration file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># file: myapp.cfg</span>

<span class="p">[</span><span class="n">firebird</span><span class="o">.</span><span class="n">driver</span><span class="p">]</span>
<span class="n">servers</span> <span class="o">=</span> <span class="n">local</span>
<span class="n">databases</span> <span class="o">=</span> <span class="n">employee</span>

<span class="p">[</span><span class="n">local</span><span class="p">]</span>
<span class="n">host</span> <span class="o">=</span> <span class="n">localhost</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">SYSDBA</span>
<span class="n">password</span> <span class="o">=</span> <span class="n">masterkey</span>

<span class="p">[</span><span class="n">employee</span><span class="p">]</span>
<span class="n">server</span> <span class="o">=</span> <span class="n">local</span>
<span class="n">database</span> <span class="o">=</span> <span class="n">employee</span><span class="o">.</span><span class="n">fdb</span>
<span class="n">protocol</span> <span class="o">=</span> <span class="n">inet</span>
<span class="n">charset</span> <span class="o">=</span> <span class="n">utf8</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span><span class="p">,</span> <span class="n">driver_config</span>

<span class="n">driver_config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">'myapp.cfg'</span><span class="p">)</span>

<span class="c1"># Attach to 'employee' database</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="ref-core.html#firebird.driver.core.connect" title="firebird.driver.core.connect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">connect()</span></code></a> for details.</p>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Using create_database()"></a><section id="using-create-database">
<span id="index-3"></span><h3>Using create_database()<a class="headerlink" href="#using-create-database" title="Permalink to this heading">¶</a></h3>
<p>This constructor returns connection to newly created database. It works in the same way
as <a class="reference internal" href="ref-core.html#firebird.driver.core.connect" title="firebird.driver.core.connect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">connect()</span></code></a>, but utilizes additional database configuration options.</p>
<p>It’s possible to specify these options in code like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span><span class="p">,</span> <span class="n">driver_config</span>

<span class="c1"># Register Firebird server</span>
<span class="n">srv_cfg</span> <span class="o">=</span> <span class="s2">"""[local]</span>
<span class="s2">host = localhost</span>
<span class="s2">user = SYSDBA</span>
<span class="s2">password = masterkey</span>
<span class="s2">"""</span>
<span class="n">driver_config</span><span class="o">.</span><span class="n">register_server</span><span class="p">(</span><span class="s1">'local'</span><span class="p">,</span> <span class="n">srv_cfg</span><span class="p">)</span>

<span class="c1"># Register database</span>
<span class="n">db_cfg</span> <span class="o">=</span> <span class="s2">"""[mydb]</span>
<span class="s2">server = local</span>
<span class="s2">database = mydb.fdb</span>
<span class="s2">protocol = inet</span>
<span class="s2">charset = utf8</span>
<span class="s2"># create options</span>
<span class="s2">page_size = 16384</span>
<span class="s2">db_charset = utf8</span>
<span class="s2">sweep_interval = 80000</span>
<span class="s2">reserve_space = no</span>
<span class="s2">"""</span>
<span class="n">driver_config</span><span class="o">.</span><span class="n">register_database</span><span class="p">(</span><span class="s1">'mydb'</span><span class="p">,</span> <span class="n">db_cfg</span><span class="p">)</span>

<span class="c1"># create 'mydb' database</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">create_database</span><span class="p">(</span><span class="s1">'mydb'</span><span class="p">)</span>
</pre></div>
</div>
<p>But more convenient approach is using single configuration file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># file: myapp.cfg</span>

<span class="p">[</span><span class="n">firebird</span><span class="o">.</span><span class="n">driver</span><span class="p">]</span>
<span class="n">servers</span> <span class="o">=</span> <span class="n">local</span>
<span class="n">databases</span> <span class="o">=</span> <span class="n">mydb</span>

<span class="p">[</span><span class="n">local</span><span class="p">]</span>
<span class="n">host</span> <span class="o">=</span> <span class="n">localhost</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">SYSDBA</span>
<span class="n">password</span> <span class="o">=</span> <span class="n">masterkey</span>

<span class="p">[</span><span class="n">mydb</span><span class="p">]</span>
<span class="n">server</span> <span class="o">=</span> <span class="n">local</span>
<span class="n">database</span> <span class="o">=</span> <span class="n">mydb</span><span class="o">.</span><span class="n">fdb</span>
<span class="n">protocol</span> <span class="o">=</span> <span class="n">inet</span>
<span class="n">charset</span> <span class="o">=</span> <span class="n">utf8</span>
<span class="c1"># create options</span>
<span class="n">page_size</span> <span class="o">=</span> <span class="mi">16384</span>
<span class="n">db_charset</span> <span class="o">=</span> <span class="n">utf8</span>
<span class="n">sweep_interval</span> <span class="o">=</span> <span class="mi">80000</span>
<span class="n">reserve_space</span> <span class="o">=</span> <span class="n">no</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">create_database</span><span class="p">,</span> <span class="n">driver_config</span>

<span class="n">driver_config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">'myapp.cfg'</span><span class="p">)</span>

<span class="c1"># create 'mydb' database</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">create_database</span><span class="p">(</span><span class="s1">'mydb'</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="ref-core.html#firebird.driver.core.create_database" title="firebird.driver.core.create_database"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_database()</span></code></a> for details.</p>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Deleting databases"></a><section id="deleting-databases">
<span id="index-4"></span><h3>Deleting databases<a class="headerlink" href="#deleting-databases" title="Permalink to this heading">¶</a></h3>
<p>The Firebird engine also supports dropping (deleting) databases dynamically,
but dropping is a more complicated operation than creating, for several reasons:
an existing database may be in use by users other than the one who requests
the deletion, it may have supporting objects such as temporary sort files, and
it may even have dependent shadow databases. Although the database engine
recognizes a <code class="xref py py-obj docutils literal notranslate"><span class="pre">DROP</span> <span class="pre">DATABASE</span></code> SQL statement, support for that statement is limited
to the <code class="xref py py-obj docutils literal notranslate"><span class="pre">isql</span></code> command-line administration utility. However, the engine supports
the deletion of databases via an API call, which <code class="xref py py-obj docutils literal notranslate"><span class="pre">firebird-driver</span></code> exposes as
<a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.drop_database" title="firebird.driver.core.Connection.drop_database"><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_database</span></code></a> method in <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a> class. So, to drop a database
you need to connect to it first.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span><span class="p">,</span> <span class="n">driver_config</span>

<span class="n">driver_config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">'myapp.cfg'</span><span class="p">)</span>

<span class="c1"># Attach to 'myapp' database</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'myapp'</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">drop_database</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.drop_database" title="firebird.driver.core.Connection.drop_database"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection.drop_database()</span></code></a> for details.</p>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Connection object"></a><section id="connection-object">
<span id="index-5"></span><h3>Connection object<a class="headerlink" href="#connection-object" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a> object represents a direct link to database, and works as
gateway for next operations with it:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#executing-sql-statements">Executing SQL Statements</a>: methods <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.execute_immediate" title="firebird.driver.core.Connection.execute_immediate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">execute_immediate()</span></code></a> and <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.cursor" title="firebird.driver.core.Connection.cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cursor()</span></code></a>.</p></li>
<li><p><a class="reference external" href="Deletingdatabases">Dropping database</a>: method <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.drop_database" title="firebird.driver.core.Connection.drop_database"><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_database()</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#transanction-management">Transanction management</a>: methods <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.begin" title="firebird.driver.core.Connection.begin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">begin()</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.commit" title="firebird.driver.core.Connection.commit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">commit()</span></code></a>,
<a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.rollback" title="firebird.driver.core.Connection.rollback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rollback()</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.savepoint" title="firebird.driver.core.Connection.savepoint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">savepoint()</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.transaction_manager" title="firebird.driver.core.Connection.transaction_manager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transaction_manager()</span></code></a>,
<a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.is_active" title="firebird.driver.core.Connection.is_active"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_active()</span></code></a>, and attributes <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.main_transaction" title="firebird.driver.core.Connection.main_transaction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">main_transaction</span></code></a>,
<a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.query_transaction" title="firebird.driver.core.Connection.query_transaction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">query_transaction</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.transactions" title="firebird.driver.core.Connection.transactions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transactions</span></code></a> and <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.default_tpb" title="firebird.driver.core.Connection.default_tpb"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_tpb</span></code></a>.</p></li>
<li><p>Work with <a class="reference internal" href="#database-events">Database Events</a>: method <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.event_collector" title="firebird.driver.core.Connection.event_collector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">event_collector</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#getting-information-about-connection">Getting information about connection</a>: methods <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.is_closed" title="firebird.driver.core.Connection.is_closed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_closed()</span></code></a> and
<a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.ping" title="firebird.driver.core.Connection.ping"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ping()</span></code></a> and attributes <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.dsn" title="firebird.driver.core.Connection.dsn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dsn</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.charset" title="firebird.driver.core.Connection.charset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">charset</span></code></a>
and <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.sql_dialect" title="firebird.driver.core.Connection.sql_dialect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sql_dialect</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#getting-information-about-database">Getting information about database</a>: attribute <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.info" title="firebird.driver.core.Connection.info"><code class="xref py py-obj docutils literal notranslate"><span class="pre">info</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#closing-the-connection">Closing the connection</a>: method <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.close" title="firebird.driver.core.Connection.close"><code class="xref py py-obj docutils literal notranslate"><span class="pre">close()</span></code></a></p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Closing the connection"></a><section id="closing-the-connection">
<span id="index-6"></span><h3>Closing the connection<a class="headerlink" href="#closing-the-connection" title="Permalink to this heading">¶</a></h3>
<p>There are many local and server resources used by firebird-driver that must be properly
managed, and disposed when they are no longer necessary. All objects that require proper
finalization provide <code class="xref py py-obj docutils literal notranslate"><span class="pre">close()</span></code> method that must be called when object is no longer needed.
The <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a> (and <a class="reference internal" href="ref-core.html#firebird.driver.core.Server" title="firebird.driver.core.Server"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server</span></code></a>) objects are the most important ones, as other most frequently
used objects like cursors, prepared statements and transactions are typically associated with
connections.</p>
<p>You may call the <code class="xref py py-obj docutils literal notranslate"><span class="pre">close()</span></code> method directly, or use the <a class="reference external" href="https://docs.python.org/3/reference/compound_stmts.html#with" title="(in Python v3.11)"><span class="xref std std-ref">with</span></a> statement
and context manager support provided by all these objects.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span><span class="p">,</span> <span class="n">driver_config</span>

<span class="n">driver_config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">'myapp.cfg'</span><span class="p">)</span>

<span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">)</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">'select 1 from rdb$database'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Objects that require proper finalization are: <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager" title="firebird.driver.core.TransactionManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionManager</span></code></a>
and <a class="reference internal" href="ref-core.html#firebird.driver.core.DistributedTransactionManager" title="firebird.driver.core.DistributedTransactionManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DistributedTransactionManager</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.Statement" title="firebird.driver.core.Statement"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Statement</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.BlobReader" title="firebird.driver.core.BlobReader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BlobReader</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor" title="firebird.driver.core.Cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code></a> and <a class="reference internal" href="ref-core.html#firebird.driver.core.Server" title="firebird.driver.core.Server"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server</span></code></a>.</p>
<p>Although only <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a> and <a class="reference internal" href="ref-core.html#firebird.driver.core.Server" title="firebird.driver.core.Server"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server</span></code></a> objects must be closed directly because
all other objects are associated with them and thus closed when connection is
closed, it’s <strong>recommended</strong> to directly close any resource object obtained by
your code when it’s no longer needed (either directly by calling <code class="xref py py-obj docutils literal notranslate"><span class="pre">close()</span></code> or using
<code class="xref py py-obj docutils literal notranslate"><span class="pre">with</span></code> statement).</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>All managed objects have <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#object.__del__" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__del__</span></code></a> method, which ensures that the object in
the active state is properly closed before it is destroyed by the Python memory manager.
However, <strong>the close operation may fail</strong> as the state of your application could be arbitrary
and the sequence in which objects are disposed by memory manager is not deterministic.</p>
<p>The <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#object.__del__" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__del__</span></code></a> methods should be thus considered as safe guard of last resort
that your code should not rely upon. To indicate that your code is not managing
resources properly, the <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ResourceWarning" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ResourceWarning</span></code></a> is raises when active object is disposed
by memory manager.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Such warnings may not reach your attention if warnings are disabled or filtered
on your system. You should always develop and test your applications with enabled
delivery of resource warnings.</p>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.close" title="firebird.driver.core.Connection.close"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection.close()</span></code></a> for details.</p>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Getting information about connection"></a><section id="getting-information-about-connection">
<span id="index-7"></span><h3>Getting information about connection<a class="headerlink" href="#getting-information-about-connection" title="Permalink to this heading">¶</a></h3>
<p>Only (most useful) part of information associated with <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a> object is directly
available:</p>
<ul class="simple">
<li><p>It’s possible to check whether Connection object is closed or not with
<a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.is_closed" title="firebird.driver.core.Connection.is_closed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_closed()</span></code></a> method.</p></li>
<li><p>It’s possible to check whether connection to the Firebird server is not broken with
<a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.ping" title="firebird.driver.core.Connection.ping"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ping()</span></code></a> method.</p></li>
<li><p>The DSN (fully qualified Firebird database connection string) is surfaced as <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.dsn" title="firebird.driver.core.Connection.dsn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dsn</span></code></a>
read-only property.</p></li>
<li><p>The character set used by Connection is surfaced as <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.charset" title="firebird.driver.core.Connection.charset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">charset</span></code></a> read-only property.</p></li>
<li><p>The SQL dialect used by Connection is surfaced as <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.sql_dialect" title="firebird.driver.core.Connection.sql_dialect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sql_dialect</span></code></a> read-only property.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Additional connection-specific information is currently held as <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bytes</span></code></a> in protected
<code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection._dpb</span></code> attribute that could be processed using <a class="reference internal" href="ref-core.html#firebird.driver.core.DPB" title="firebird.driver.core.DPB"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DPB</span></code></a> object.</p>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Getting information about database"></a><section id="getting-information-about-database">
<span id="index-8"></span><h3>Getting information about database<a class="headerlink" href="#getting-information-about-database" title="Permalink to this heading">¶</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Because the scope and type of database information depends on the version of the Firebird
server and database ODS, this information is made available through a separate class
<a class="reference internal" href="ref-core.html#firebird.driver.core.DatabaseInfoProvider" title="firebird.driver.core.DatabaseInfoProvider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DatabaseInfoProvider</span></code></a>. The <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.info" title="firebird.driver.core.Connection.info"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection.info</span></code></a> property provides access to
instance of <a class="reference internal" href="ref-core.html#firebird.driver.core.DatabaseInfoProvider" title="firebird.driver.core.DatabaseInfoProvider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DatabaseInfoProvider</span></code></a> or it’s <strong>ancestor</strong> class according to ODS of attached
database and Firebird version.</p>
</div>
<p>Although you may query the information directly from server using
<a class="reference internal" href="ref-core.html#firebird.driver.core.DatabaseInfoProvider3.get_info" title="firebird.driver.core.DatabaseInfoProvider3.get_info"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_info()</span></code></a> method (that wraps the Firebird
<code class="xref py py-obj docutils literal notranslate"><span class="pre">iAttachment.getInfo()</span></code> API call), the <a class="reference internal" href="ref-core.html#firebird.driver.core.DatabaseInfoProvider" title="firebird.driver.core.DatabaseInfoProvider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DatabaseInfoProvider</span></code></a> object
provides more convenient methods and properties for obtaining specific information directly.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some information provided by <a class="reference internal" href="ref-core.html#firebird.driver.core.DatabaseInfoProvider" title="firebird.driver.core.DatabaseInfoProvider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DatabaseInfoProvider</span></code></a> properties
(like <a class="reference internal" href="ref-core.html#firebird.driver.core.DatabaseInfoProvider3.cache_hit_ratio" title="firebird.driver.core.DatabaseInfoProvider3.cache_hit_ratio"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cache_hit_ratio</span></code></a>) could not be obtained via
<code class="xref py py-obj docutils literal notranslate"><span class="pre">get_info()</span></code> method.</p>
</div>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span>

<span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Database character set: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">charset</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Page size (in bytes): </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">page_size</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Attachment ID: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"SQL dialect used by connected database: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">sql_dialect</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Database name (filename or alias): </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Database site name: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">site</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Implementation (old format): </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">implementation</span><span class="si">!s}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Database Provider: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">provider</span><span class="si">!s}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Database Class: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">db_class</span><span class="si">!s}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Date when database was created: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">creation_date</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Size of page cache used by connection: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">page_cache_size</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of pages allocated for database: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">pages_allocated</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of database pages in active use: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">pages_used</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of free allocated pages in database: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">pages_free</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Sweep interval: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">sweep_interval</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Data page space usage (USE_FULL or RESERVE): </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">space_reservation</span><span class="si">!s}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Database write mode (SYNC or ASYNC): </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">write_mode</span><span class="si">!s}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Database access mode (READ_ONLY or READ_WRITE): </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">access_mode</span><span class="si">!s}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Current I/O statistics - Reads from disk to page cache: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">reads</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Current I/O statistics - Fetches from page cache: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">fetches</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Cache hit ratio = 1 - (reads / fetches): </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">cache_hit_ratio</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Current I/O statistics - Writes from page cache to disk: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">writes</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Current I/O statistics - Writes to page in cache: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">marks</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Total amount of memory curretly used by database engine: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">current_memory</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Max. total amount of memory so far used by database engine: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">max_memory</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"ID of Oldest Interesting Transaction: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">oit</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"ID of Oldest Active Transaction: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">oat</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"ID of Oldest Snapshot Transaction: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">ost</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"ID for next transaction: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">next_transaction</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Sample output</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Database</span> <span class="n">character</span> <span class="nb">set</span><span class="p">:</span> <span class="n">NONE</span>
<span class="n">Page</span> <span class="n">size</span> <span class="p">(</span><span class="ow">in</span> <span class="nb">bytes</span><span class="p">):</span> <span class="mi">8192</span>
<span class="n">Attachment</span> <span class="n">ID</span><span class="p">:</span> <span class="mi">378</span>
<span class="n">SQL</span> <span class="n">dialect</span> <span class="n">used</span> <span class="n">by</span> <span class="n">connected</span> <span class="n">database</span><span class="p">:</span> <span class="mi">3</span>
<span class="n">Database</span> <span class="n">name</span> <span class="p">(</span><span class="n">filename</span> <span class="ow">or</span> <span class="n">alias</span><span class="p">):</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">firebird</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">empbuild</span><span class="o">/</span><span class="n">employee</span><span class="o">.</span><span class="n">fdb</span>
<span class="n">Database</span> <span class="n">site</span> <span class="n">name</span><span class="p">:</span> <span class="n">NewAmarisk</span>
<span class="n">Implementation</span> <span class="p">(</span><span class="n">old</span> <span class="nb">format</span><span class="p">):</span> <span class="n">Implementation</span><span class="o">.</span><span class="n">RDB_VMS</span>
<span class="n">Database</span> <span class="n">Provider</span><span class="p">:</span> <span class="n">DbProvider</span><span class="o">.</span><span class="n">FIREBIRD</span>
<span class="n">Database</span> <span class="n">Class</span><span class="p">:</span> <span class="n">DbClass</span><span class="o">.</span><span class="n">SERVER_ACCESS</span>
<span class="n">Date</span> <span class="n">when</span> <span class="n">database</span> <span class="n">was</span> <span class="n">created</span><span class="p">:</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">13</span> <span class="mi">10</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mf">57.005010</span>
<span class="n">Size</span> <span class="n">of</span> <span class="n">page</span> <span class="n">cache</span> <span class="n">used</span> <span class="n">by</span> <span class="n">connection</span><span class="p">:</span> <span class="mi">2048</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">pages</span> <span class="n">allocated</span> <span class="k">for</span> <span class="n">database</span><span class="p">:</span> <span class="mi">346</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">database</span> <span class="n">pages</span> <span class="ow">in</span> <span class="n">active</span> <span class="n">use</span><span class="p">:</span> <span class="mi">311</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">free</span> <span class="n">allocated</span> <span class="n">pages</span> <span class="ow">in</span> <span class="n">database</span><span class="p">:</span> <span class="mi">35</span>
<span class="n">Sweep</span> <span class="n">interval</span><span class="p">:</span> <span class="mi">20000</span>
<span class="n">Data</span> <span class="n">page</span> <span class="n">space</span> <span class="n">usage</span> <span class="p">(</span><span class="n">USE_FULL</span> <span class="ow">or</span> <span class="n">RESERVE</span><span class="p">):</span> <span class="n">DbSpaceReservation</span><span class="o">.</span><span class="n">RESERVE</span>
<span class="n">Database</span> <span class="n">write</span> <span class="n">mode</span> <span class="p">(</span><span class="n">SYNC</span> <span class="ow">or</span> <span class="n">ASYNC</span><span class="p">):</span> <span class="n">DbWriteMode</span><span class="o">.</span><span class="n">SYNC</span>
<span class="n">Database</span> <span class="n">access</span> <span class="n">mode</span> <span class="p">(</span><span class="n">READ_ONLY</span> <span class="ow">or</span> <span class="n">READ_WRITE</span><span class="p">):</span> <span class="n">DbAccessMode</span><span class="o">.</span><span class="n">READ_WRITE</span>
<span class="n">Current</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="n">statistics</span> <span class="o">-</span> <span class="n">Reads</span> <span class="kn">from</span> <span class="nn">disk</span> <span class="n">to</span> <span class="n">page</span> <span class="n">cache</span><span class="p">:</span> <span class="mi">87</span>
<span class="n">Current</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="n">statistics</span> <span class="o">-</span> <span class="n">Fetches</span> <span class="kn">from</span> <span class="nn">page</span> <span class="n">cache</span><span class="p">:</span> <span class="mi">1525</span>
<span class="n">Cache</span> <span class="n">hit</span> <span class="n">ratio</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">reads</span> <span class="o">/</span> <span class="n">fetches</span><span class="p">):</span> <span class="mf">0.9429508196721311</span>
<span class="n">Current</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="n">statistics</span> <span class="o">-</span> <span class="n">Writes</span> <span class="kn">from</span> <span class="nn">page</span> <span class="n">cache</span> <span class="n">to</span> <span class="n">disk</span><span class="p">:</span> <span class="mi">2</span>
<span class="n">Current</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="n">statistics</span> <span class="o">-</span> <span class="n">Writes</span> <span class="n">to</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">cache</span><span class="p">:</span> <span class="mi">5</span>
<span class="n">Total</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">memory</span> <span class="n">curretly</span> <span class="n">used</span> <span class="n">by</span> <span class="n">database</span> <span class="n">engine</span><span class="p">:</span> <span class="mi">21925248</span>
<span class="n">Max</span><span class="o">.</span> <span class="n">total</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">memory</span> <span class="n">so</span> <span class="n">far</span> <span class="n">used</span> <span class="n">by</span> <span class="n">database</span> <span class="n">engine</span><span class="p">:</span> <span class="mi">22033760</span>
<span class="n">ID</span> <span class="n">of</span> <span class="n">Oldest</span> <span class="n">Interesting</span> <span class="n">Transaction</span><span class="p">:</span> <span class="mi">307</span>
<span class="n">ID</span> <span class="n">of</span> <span class="n">Oldest</span> <span class="n">Active</span> <span class="n">Transaction</span><span class="p">:</span> <span class="mi">308</span>
<span class="n">ID</span> <span class="n">of</span> <span class="n">Oldest</span> <span class="n">Snapshot</span> <span class="n">Transaction</span><span class="p">:</span> <span class="mi">308</span>
<span class="n">ID</span> <span class="k">for</span> <span class="nb">next</span> <span class="n">transaction</span><span class="p">:</span> <span class="mi">308</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="ref-core.html#firebird.driver.core.DatabaseInfoProvider" title="firebird.driver.core.DatabaseInfoProvider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DatabaseInfoProvider</span></code></a> for details.</p>
</div>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Getting information about Firebird version"></a><section id="getting-information-about-firebird-version">
<h4>Getting information about Firebird version<a class="headerlink" href="#getting-information-about-firebird-version" title="Permalink to this heading">¶</a></h4>
<p>Because functionality and some features depends on actual Firebird version, it could be
important for driver users to check it. This (otherwise) simple task could be confusing
for new Firebird users, because Firebird uses two different version lineages. This abomination
was introduced to Firebird thanks to its InterBase legacy (Firebird 1.0 is a fork of InterBase
6.0), as applications designed to work with InterBase can often work with Firebird without
problems (and vice versa).</p>
<p><a class="reference internal" href="ref-core.html#firebird.driver.core.DatabaseInfoProvider" title="firebird.driver.core.DatabaseInfoProvider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DatabaseInfoProvider</span></code></a> provides these version strings as two properties:</p>
<ul class="simple">
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">server_version</span></code> - Legacy InterBase-friendly version string.</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">firebird_version</span></code> - Firebird’s own version string.</p></li>
</ul>
<p>However, this version string contains more information than version number. For example for
Linux Firebird 4.0.0 it’s ‘LI-T4.0.0.1963 Firebird 4.0 Beta 2’. So <a class="reference internal" href="ref-core.html#firebird.driver.core.DatabaseInfoProvider" title="firebird.driver.core.DatabaseInfoProvider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DatabaseInfoProvider</span></code></a>
provides two more properties for your convenience:</p>
<ul class="simple">
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">version</span></code> - Only Firebird version number. It’s a string with
format: major.minor.subrelease.build</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">engine_version</span></code> - Engine (major.minor) version as (float) number.</p></li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span>

<span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"server_version: '</span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">server_version</span><span class="si">}</span><span class="s2">'"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"firebird_version: '</span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">firebird_version</span><span class="si">}</span><span class="s2">'"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"version: '</span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">version</span><span class="si">}</span><span class="s2">'"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"engine_version: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">engine_version</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Sample output</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">server_version</span><span class="p">:</span> <span class="s1">'LI-T6.3.0.1963 Firebird 4.0 Beta 2'</span>
<span class="n">firebird_version</span><span class="p">:</span> <span class="s1">'LI-T4.0.0.1963 Firebird 4.0 Beta 2'</span>
<span class="n">version</span><span class="p">:</span> <span class="s1">'4.0.0.1963'</span>
<span class="n">engine_version</span><span class="p">:</span> <span class="mf">4.0</span>
</pre></div>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Database On-Disk Structure"></a><section id="database-on-disk-structure">
<h4>Database On-Disk Structure<a class="headerlink" href="#database-on-disk-structure" title="Permalink to this heading">¶</a></h4>
<p>Particular Firebird features may also depend on specific support in database
(for example number and structure of monitoring tables). These required structures are
present automatically when database is created by particular engine verison that needs
them, but Firebird engine may work with databases created by older versions and thus with
older structure, so it could be necessary to consult also On-Disk Structure (ODS for short)
version. <a class="reference internal" href="ref-core.html#firebird.driver.core.DatabaseInfoProvider" title="firebird.driver.core.DatabaseInfoProvider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DatabaseInfoProvider</span></code></a> provides this number as <code class="xref py py-obj docutils literal notranslate"><span class="pre">ods</span></code> (float)
property.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span>

<span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"ods: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">ods</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"ods_version: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">ods_version</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"ods_minor_version: </span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">ods_minor_version</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Sample output</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ods</span><span class="p">:</span> <span class="mf">13.0</span>
<span class="n">ods_version</span><span class="p">:</span> <span class="mi">13</span>
<span class="n">ods_minor_version</span><span class="p">:</span> <span class="mi">0</span>
</pre></div>
</div>
</section>
</section>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Executing SQL Statements"></a><section id="executing-sql-statements">
<span id="index-9"></span><h2>Executing SQL Statements<a class="headerlink" href="#executing-sql-statements" title="Permalink to this heading">¶</a></h2>
<p>Firebird-driver implements two ways for execution of SQL commands against connected database:</p>
<ul class="simple">
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.execute_immediate" title="firebird.driver.core.Connection.execute_immediate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">execute_immediate</span></code></a> - for execution of SQL commands that don’t return any result.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor" title="firebird.driver.core.Cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code></a> objects that offer rich interface for execution of SQL commands and fetching their results.</p></li>
</ul>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Cursor object"></a><section id="cursor-object">
<span id="index-10"></span><h3>Cursor object<a class="headerlink" href="#cursor-object" title="Permalink to this heading">¶</a></h3>
<p>Because <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor" title="firebird.driver.core.Cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code></a> objects always operate in context of single <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a> (and <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager" title="firebird.driver.core.TransactionManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionManager</span></code></a>),
<a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor" title="firebird.driver.core.Cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code></a> instances are not created directly, but by constructor method. Python DB API 2.0 assumes
that if database engine supports transactions, it supports only one transaction per connection,
hence it defines constructor method <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.cursor" title="firebird.driver.core.Connection.cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cursor</span></code></a> (and other transaction-related methods)
as part of <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a> interface. However, Firebird supports multiple independent transactions
per connection. To conform to Python DB API, firebird-driver uses concept of internal
<a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.main_transaction" title="firebird.driver.core.Connection.main_transaction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">main_transaction</span></code></a> and secondary <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.transactions" title="firebird.driver.core.Connection.transactions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transactions</span></code></a>. Cursor constructor is
primarily defined by <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager" title="firebird.driver.core.TransactionManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionManager</span></code></a>, and Cursor constructor on <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a> is therefore
a shortcut for <code class="xref py py-obj docutils literal notranslate"><span class="pre">main_transaction.cursor()</span></code>.</p>
<p><a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor" title="firebird.driver.core.Cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code></a> objects are used for next operations:</p>
<ul class="simple">
<li><p>Execution of SQL Statemets: methods <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.execute" title="firebird.driver.core.Cursor.execute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">execute()</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.executemany" title="firebird.driver.core.Cursor.executemany"><code class="xref py py-obj docutils literal notranslate"><span class="pre">executemany()</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.open" title="firebird.driver.core.Cursor.open"><code class="xref py py-obj docutils literal notranslate"><span class="pre">open()</span></code></a>
and <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.callproc" title="firebird.driver.core.Cursor.callproc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">callproc()</span></code></a>.</p></li>
<li><p>Creating <a class="reference internal" href="ref-core.html#firebird.driver.core.Statement" title="firebird.driver.core.Statement"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Statement</span></code></a> objects for efficient repeated execution of SQL statements, and to obtain
additional information about SQL statements (like execution <a class="reference internal" href="ref-core.html#firebird.driver.core.Statement.plan" title="firebird.driver.core.Statement.plan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plan</span></code></a>): method <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.prepare" title="firebird.driver.core.Cursor.prepare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare()</span></code></a>.</p></li>
<li><p><a class="reference external" href="Fetchingdatafromserver">Fetching results</a>: methods <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetchone" title="firebird.driver.core.Cursor.fetchone"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetchone()</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetchmany" title="firebird.driver.core.Cursor.fetchmany"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetchmany()</span></code></a>,
<a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetchall" title="firebird.driver.core.Cursor.fetchall"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetchall()</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetch_next" title="firebird.driver.core.Cursor.fetch_next"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_next()</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetch_prior" title="firebird.driver.core.Cursor.fetch_prior"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_prior()</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetch_first" title="firebird.driver.core.Cursor.fetch_first"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_first()</span></code></a>,
<a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetch_last" title="firebird.driver.core.Cursor.fetch_last"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_last()</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetch_absolute" title="firebird.driver.core.Cursor.fetch_absolute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_absolute()</span></code></a> and <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetch_relative" title="firebird.driver.core.Cursor.fetch_relative"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_relative()</span></code></a>.</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/SQL Execution Basics"></a><section id="sql-execution-basics">
<span id="index-11"></span><h3>SQL Execution Basics<a class="headerlink" href="#sql-execution-basics" title="Permalink to this heading">¶</a></h3>
<p>There are five methods how to execute SQL commands:</p>
<ol class="arabic">
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.execute_immediate" title="firebird.driver.core.Connection.execute_immediate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection.execute_immediate()</span></code></a> or <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager.execute_immediate" title="firebird.driver.core.TransactionManager.execute_immediate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionManager.execute_immediate()</span></code></a> for SQL commands
that don’t return any result, and are not executed frequently. This method also <strong>doesn’t</strong>
support either <a class="reference external" href="parameterized-statements">parameterized statements</a> or
<a class="reference external" href="prepared-statements">prepared statements</a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method is efficient for <code class="xref py py-obj docutils literal notranslate"><span class="pre">administrative</span></code> and <a class="reference external" href="http://en.wikipedia.org/wiki/Data_Definition_Language">DDL</a> SQL commands, like <code class="xref py py-obj docutils literal notranslate"><span class="pre">DROP</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">CREATE</span></code>
or <code class="xref py py-obj docutils literal notranslate"><span class="pre">ALTER</span></code> commands, <code class="xref py py-obj docutils literal notranslate"><span class="pre">SET</span> <span class="pre">STATISTICS</span></code> etc.</p>
</div>
</li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.execute" title="firebird.driver.core.Cursor.execute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor.execute()</span></code></a> for SQL commands that return result sets, i.e. sequence of <code class="xref py py-obj docutils literal notranslate"><span class="pre">rows</span></code> of the same
structure, and sequence has unknown number of <code class="xref py py-obj docutils literal notranslate"><span class="pre">rows</span></code> (including zero). Each row of the sequence
can be read only once, and is returned in the order it is read from the server.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method is preferred for all <code class="xref py py-obj docutils literal notranslate"><span class="pre">SELECT</span></code> and other <a class="reference external" href="http://en.wikipedia.org/wiki/Data_Manipulation_Language">DML</a> statements, or any statement that
is executed frequently, either <code class="xref py py-obj docutils literal notranslate"><span class="pre">as</span> <span class="pre">is</span></code> or in <code class="xref py py-obj docutils literal notranslate"><span class="pre">parameterized</span></code> form.</p>
</div>
</li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.executemany" title="firebird.driver.core.Cursor.executemany"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor.executemany()</span></code></a> for execution of single parameterized SQL command with various set
of parameters.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Because <code class="xref py py-obj docutils literal notranslate"><span class="pre">executemany()</span></code> is basically a simple loop that calls <code class="xref py py-obj docutils literal notranslate"><span class="pre">execute()</span></code> with different
parameters, it’s possible to execute any statement acceptable by <code class="xref py py-obj docutils literal notranslate"><span class="pre">execute()</span></code>. However,
it’s possible to access the result set <strong>only</strong> from last executed command, so this method
should not be used for SQL commands that return results.</p>
</div>
</li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.open" title="firebird.driver.core.Cursor.open"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor.open()</span></code></a> for SQL command that return result sets, i.e. sequence of <code class="xref py py-obj docutils literal notranslate"><span class="pre">rows</span></code> of the same
structure, and sequence has unknown number of <code class="xref py py-obj docutils literal notranslate"><span class="pre">rows</span></code> (including zero). Instead of just fetching
rows sequentially in a forward direction like <code class="xref py py-obj docutils literal notranslate"><span class="pre">execute()</span></code>, this method allows flexible navigation
through an open cursor set both backwards and forwards. Rows next to, prior to and relative to
the current cursor row can be targeted.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="scrollable-cursors">Scrollable cursors</a> for details.</p>
</div>
</li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.callproc" title="firebird.driver.core.Cursor.callproc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor.callproc()</span></code></a> for execution of <code class="xref py py-obj docutils literal notranslate"><span class="pre">Stored</span> <span class="pre">procedures</span></code> that always return exactly one set
of values.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method of SP invocation is equivalent to <code class="xref py py-obj docutils literal notranslate"><span class="pre">"EXECUTE</span> <span class="pre">PROCEDURE</span> <span class="pre">..."</span></code> SQL statement.</p>
</div>
</li>
</ol>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Fetching data from server"></a><section id="fetching-data-from-server">
<span id="index-12"></span><h3>Fetching data from server<a class="headerlink" href="#fetching-data-from-server" title="Permalink to this heading">¶</a></h3>
<p>Result of SQL statement execution consists from sequence of zero to unknown number of <code class="xref py py-obj docutils literal notranslate"><span class="pre">rows</span></code>,
where each <code class="xref py py-obj docutils literal notranslate"><span class="pre">row</span></code> is a set of exactly the same number of values. <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor" title="firebird.driver.core.Cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code></a> object offer number
of different methods for fetching these <code class="xref py py-obj docutils literal notranslate"><span class="pre">rows</span></code>, that should satisfy all your specific needs:</p>
<ul>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetchone" title="firebird.driver.core.Cursor.fetchone"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetchone()</span></code></a> - Returns the next row of a query result set, or <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> when no more data
is available.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Cursor supports the <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#typeiter" title="(in Python v3.11)"><span class="xref std std-ref">iterator protocol</span></a>, yielding tuples of values
like <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetchone" title="firebird.driver.core.Cursor.fetchone"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetchone()</span></code></a>.</p>
</div>
</li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetchmany" title="firebird.driver.core.Cursor.fetchmany"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetchmany()</span></code></a> - Returns the next set of rows of a query result, returning a sequence
of sequences (e.g. a list of tuples). An empty sequence is returned when no more rows are available.</p>
<p>The number of rows to fetch per call is specified by the parameter. If it is not given, the
cursor’s <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.arraysize" title="firebird.driver.core.Cursor.arraysize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arraysize</span></code></a> determines the number of rows to be fetched. The method does try
to fetch as many rows as indicated by the size parameter. If this is not possible due to
the specified number of rows not being available, fewer rows may be returned.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default value of <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.arraysize" title="firebird.driver.core.Cursor.arraysize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arraysize</span></code></a> is <code class="xref py py-obj docutils literal notranslate"><span class="pre">1</span></code>, so without paremeter it’s equivalent to
<a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetchone" title="firebird.driver.core.Cursor.fetchone"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetchone()</span></code></a>, but returns list of <code class="xref py py-obj docutils literal notranslate"><span class="pre">rows</span></code>, instead actual <code class="xref py py-obj docutils literal notranslate"><span class="pre">row</span></code> directly.</p>
</div>
</li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetchall" title="firebird.driver.core.Cursor.fetchall"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetchall()</span></code></a> -  Returns all (remaining) rows of a query result as list of tuples,
where each tuple is one row of returned values.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This method can potentially return huge amount of data, that may exhaust available memory.
If you need just <code class="xref py py-obj docutils literal notranslate"><span class="pre">iteration</span></code> over potentially big result set, use loops with <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetchone" title="firebird.driver.core.Cursor.fetchone"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetchone()</span></code></a>
or Cursor’s built-in support for <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#typeiter" title="(in Python v3.11)"><span class="xref std std-ref">iterator protocol</span></a> instead this method.</p>
</div>
</li>
<li><p>Call to <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.execute" title="firebird.driver.core.Cursor.execute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">execute()</span></code></a> returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">self</span></code> (Cursor instance) that itself supports the
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#typeiter" title="(in Python v3.11)"><span class="xref std std-ref">iterator protocol</span></a>, yielding tuples of values like <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetchone" title="firebird.driver.core.Cursor.fetchone"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetchone()</span></code></a>.</p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Firebird-driver makes absolutely no guarantees about the <code class="xref py py-obj docutils literal notranslate"><span class="pre">row</span></code> return value of the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch*()</span></code> methods except that it is a sequence indexed by field position. Therefore, client
programmers should not rely on the return value being an instance of a particular class or type.</p>
</div>
<p><strong>Examples:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span>

<span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">SELECT</span> <span class="o">=</span> <span class="s2">"select country, currency from country"</span>

    <span class="c1"># 1. Using built-in support for iteration protocol to iterate over the rows available</span>
    <span class="c1"># from the cursor, unpacking the resulting sequences to yield their elements (country, currency):</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">SELECT</span><span class="p">)</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">country</span><span class="p">,</span> <span class="n">currency</span><span class="p">)</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">country</span><span class="si">}</span><span class="s2"> uses </span><span class="si">{</span><span class="n">currency</span><span class="si">}</span><span class="s2"> as currency."</span><span class="p">)</span>
    <span class="c1"># or alternatively you can take an advantage of cur.execute() returning self.</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">country</span><span class="p">,</span> <span class="n">currency</span><span class="p">)</span> <span class="ow">in</span> <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">SELECT</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">country</span><span class="si">}</span><span class="s2"> uses </span><span class="si">{</span><span class="n">currency</span><span class="si">}</span><span class="s2"> as currency."</span><span class="p">)</span>

    <span class="c1"># 2. Equivalently using fetchall():</span>
    <span class="c1"># This is potentially dangerous if result set is huge, as the whole result set is</span>
    <span class="c1"># first materialized as list and then used for iteration.</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">SELECT</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> uses </span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> as currency."</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Method <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.executemany" title="firebird.driver.core.Cursor.executemany"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor.executemany()</span></code></a> is not intended for operations that return results,
so it does <strong>NOT</strong> returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">self</span></code> like <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.execute" title="firebird.driver.core.Cursor.execute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor.execute()</span></code></a>, and you can’t use calls
to this method as iterator.</p>
</div>
<a class="dashAnchor" name="//apple_ref/cpp/Section/scrollable-cursors"></a><span class="target" id="id1"></span></section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Scrollable cursors"></a><section id="index-13">
<span id="id2"></span><h3>Scrollable cursors<a class="headerlink" href="#index-13" title="Permalink to this heading">¶</a></h3>
<p>SQL statements executed by <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.open" title="firebird.driver.core.Cursor.open"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor.open()</span></code></a> have scrollable result set that could be
navigated using next methods:</p>
<ul class="simple">
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetch_next" title="firebird.driver.core.Cursor.fetch_next"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_next()</span></code></a> - Moves the cursor’s current position to the next row and
returns it. Returns <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> if the cursor is empty or already positioned at the last row.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetch_prior" title="firebird.driver.core.Cursor.fetch_prior"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_prior()</span></code></a> - Moves the cursor’s current position to the prior row and
returns it. Returns <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> if the cursor is empty or already positioned at the first row.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetch_first" title="firebird.driver.core.Cursor.fetch_first"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_first()</span></code></a> - Moves the cursor’s current position to the first row and
returns it. Returns <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> if the cursor is empty.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetch_last" title="firebird.driver.core.Cursor.fetch_last"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_last()</span></code></a> - Moves the cursor’s current position to the last row and
returns it. Returns <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> if the cursor is empty.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetch_absolute" title="firebird.driver.core.Cursor.fetch_absolute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_absolute()</span></code></a> - Moves the cursor’s current position to the specified
&lt;position&gt; and returns the located row. Returns <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> if &lt;position&gt; is beyond the
cursor’s boundaries.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetch_relative" title="firebird.driver.core.Cursor.fetch_relative"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_relative()</span></code></a> - Moves the cursor’s current position backward or forward
by the specified &lt;offset&gt; and returns the located row. Returns <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> if the calculated
position is beyond the cursor’s boundaries.</p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Please note that scrollable cursors:</p>
<ol class="loweralpha simple">
<li><p>are not supported by all versions of Firebird server.</p></li>
<li><p>are internally materialized as a temporary record set, thus consuming
memory/disk resources, so this feature should be used only when really necessary.</p></li>
</ol>
</div>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span>

<span class="k">def</span> <span class="nf">print_row</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'NO DATA'</span><span class="p">)</span>

<span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">'select row_number() over (order by country), country, currency from country order by country'</span><span class="p">)</span>

    <span class="c1"># You can iterate over scrollable cursors</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">:</span>
        <span class="n">print_row</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">'-'</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
    <span class="c1"># or fetch particular rows directly</span>
    <span class="n">print_row</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">fetch_first</span><span class="p">())</span>
    <span class="n">print_row</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">fetch_last</span><span class="p">())</span>
    <span class="n">print_row</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">fetch_absolute</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
    <span class="n">print_row</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">fetch_next</span><span class="p">())</span>
    <span class="n">print_row</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">fetch_prior</span><span class="p">())</span>
    <span class="n">print_row</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">fetch_relative</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">print_row</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">fetch_relative</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">'-'</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>

    <span class="n">cur</span><span class="o">.</span><span class="n">fetch_last</span><span class="p">()</span>
    <span class="n">print_row</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">fetch_next</span><span class="p">())</span>
</pre></div>
</div>
<p><strong>Sample output</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="p">,</span> <span class="n">Australia</span><span class="p">,</span> <span class="n">ADollar</span>
<span class="mi">2</span><span class="p">,</span> <span class="n">Austria</span><span class="p">,</span> <span class="n">Euro</span>
<span class="mi">3</span><span class="p">,</span> <span class="n">Belgium</span><span class="p">,</span> <span class="n">Euro</span>
<span class="mi">4</span><span class="p">,</span> <span class="n">Canada</span><span class="p">,</span> <span class="n">CdnDlr</span>
<span class="mi">5</span><span class="p">,</span> <span class="n">England</span><span class="p">,</span> <span class="n">Pound</span>
<span class="mi">6</span><span class="p">,</span> <span class="n">Fiji</span><span class="p">,</span> <span class="n">FDollar</span>
<span class="mi">7</span><span class="p">,</span> <span class="n">France</span><span class="p">,</span> <span class="n">Euro</span>
<span class="mi">8</span><span class="p">,</span> <span class="n">Germany</span><span class="p">,</span> <span class="n">Euro</span>
<span class="mi">9</span><span class="p">,</span> <span class="n">Hong</span> <span class="n">Kong</span><span class="p">,</span> <span class="n">HKDollar</span>
<span class="mi">10</span><span class="p">,</span> <span class="n">Italy</span><span class="p">,</span> <span class="n">Euro</span>
<span class="mi">11</span><span class="p">,</span> <span class="n">Japan</span><span class="p">,</span> <span class="n">Yen</span>
<span class="mi">12</span><span class="p">,</span> <span class="n">Netherlands</span><span class="p">,</span> <span class="n">Euro</span>
<span class="mi">13</span><span class="p">,</span> <span class="n">Romania</span><span class="p">,</span> <span class="n">RLeu</span>
<span class="mi">14</span><span class="p">,</span> <span class="n">Russia</span><span class="p">,</span> <span class="n">Ruble</span>
<span class="mi">15</span><span class="p">,</span> <span class="n">Switzerland</span><span class="p">,</span> <span class="n">SFranc</span>
<span class="mi">16</span><span class="p">,</span> <span class="n">USA</span><span class="p">,</span> <span class="n">Dollar</span>
<span class="o">----------</span>
<span class="mi">1</span><span class="p">,</span> <span class="n">Australia</span><span class="p">,</span> <span class="n">ADollar</span>
<span class="mi">16</span><span class="p">,</span> <span class="n">USA</span><span class="p">,</span> <span class="n">Dollar</span>
<span class="mi">10</span><span class="p">,</span> <span class="n">Italy</span><span class="p">,</span> <span class="n">Euro</span>
<span class="mi">11</span><span class="p">,</span> <span class="n">Japan</span><span class="p">,</span> <span class="n">Yen</span>
<span class="mi">10</span><span class="p">,</span> <span class="n">Italy</span><span class="p">,</span> <span class="n">Euro</span>
<span class="mi">5</span><span class="p">,</span> <span class="n">England</span><span class="p">,</span> <span class="n">Pound</span>
<span class="mi">15</span><span class="p">,</span> <span class="n">Switzerland</span><span class="p">,</span> <span class="n">SFranc</span>
<span class="o">----------</span>
<span class="n">NO</span> <span class="n">DATA</span>
</pre></div>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Parameterized statements"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Parameterized statements"></a><section id="id3">
<span id="index-14"></span><span id="id4"></span><h3>Parameterized statements<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h3>
<p>When SQL command you want to execute contains data <code class="xref py py-obj docutils literal notranslate"><span class="pre">values</span></code>, you can either:</p>
<ul>
<li><p>Embed them <code class="xref py py-obj docutils literal notranslate"><span class="pre">directly</span></code> or via <code class="xref py py-obj docutils literal notranslate"><span class="pre">string</span> <span class="pre">formatting</span></code> into command string, e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"insert into the_table (a,b,c) values ('aardvark', 1, 0.1)"</span><span class="p">)</span>
<span class="c1"># or</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"select * from the_table where col == 'aardvark'"</span><span class="p">)</span>
<span class="c1"># or</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"insert into the_table (a,b,c) values ('</span><span class="si">%s</span><span class="s2">', </span><span class="si">%i</span><span class="s2">, </span><span class="si">%f</span><span class="s2">)"</span> <span class="o">%</span> <span class="p">(</span><span class="s1">'aardvark'</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">))</span>
<span class="c1"># or</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">"select * from the_table where col == '</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">'"</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Use parameter marker (<code class="xref py py-obj docutils literal notranslate"><span class="pre">?</span></code>) in command string in the slots where values are expected,
then supply those values as Python list or tuple:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"insert into the_table (a,b,c) values (?,?,?)"</span><span class="p">,</span> <span class="p">(</span><span class="s1">'aardvark'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>
<span class="c1"># or</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"select * from the_table where col == ?"</span><span class="p">,(</span><span class="s1">'aardvark'</span><span class="p">,))</span>
</pre></div>
</div>
</li>
</ul>
<p>While both methods have the same results, the second one (called <code class="xref py py-obj docutils literal notranslate"><span class="pre">parametrized</span></code>) has several
important advantages:</p>
<ul class="simple">
<li><p>You don’t need to handle conversions from Python data types to strings.</p></li>
<li><p>Firebird-driver will handle all data type conversions (if necessary) from Python data types
to Firebird ones, including <code class="xref py py-obj docutils literal notranslate"><span class="pre">None/NULL</span></code> conversion and conversion from <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a> to <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bytes</span></code></a>
in encoding expected by server.</p></li>
<li><p>You may pass BLOB values as open <code class="xref py py-obj docutils literal notranslate"><span class="pre">file-like</span></code> objects, and firebird-driver will handle the
transfer of BLOB value.</p></li>
</ul>
<p>Parametrized statemets also have some limitations. Currently:</p>
<ul class="simple">
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">DATE</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">TIME</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">DATETIME</span></code> values must be relevant <a class="reference external" href="https://docs.python.org/3/library/datetime.html#module-datetime" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">datetime</span></code></a> objects.</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">NUMERIC</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">DECIMAL</span></code> values must be <a class="reference external" href="https://docs.python.org/3/library/decimal.html#module-decimal" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">decimal</span></code></a> objects.</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Prepared Statements"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Prepared Statements"></a><section id="id5">
<span id="index-15"></span><span id="id6"></span><h3>Prepared Statements<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h3>
<p>Execution of any SQL statement has three phases:</p>
<ul class="simple">
<li><p><em>Preparation</em>: command is analyzed, validated, execution plan is determined
by optimizer and all necessary data structures (for example for input and output
parameters) are initialized.</p></li>
<li><p><em>Execution</em>: input parameters (if any) are passed to server and previously
prepared statement is actually executed by database engine.</p></li>
<li><p><em>Fetching</em>: result of execution and data (if any) are transferred from server
to client, and allocated resources are then released (by closing the statement).</p></li>
</ul>
<p>The preparation phase consumes some amount of server resources (memory and CPU).
Although preparation and release of resources typically takes only small amount
of CPU time, it builds up as number of executed statements grows. Firebird (like
most database engines) allows to spare this time for subsequent execution if
particular statement should be executed repeatedly - by reusing once prepared
statement for repeated execution. This may save significant amount of server
processing time, and result in better overall performance.</p>
<p>Firebird-driver builds on this by encapsulating the Firebird SQL statement data
and related code into separate <a class="reference internal" href="ref-core.html#firebird.driver.core.Statement" title="firebird.driver.core.Statement"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Statement</span></code></a> class, and implementing the <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor" title="firebird.driver.core.Cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code></a>
class around it. The Cursor uses either an internally managed <a class="reference internal" href="ref-core.html#firebird.driver.core.Statement" title="firebird.driver.core.Statement"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Statement</span></code></a> instance
to execute SQL commands provided as <a class="reference external" href="https://docs.python.org/3/library/string.html#module-string" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">string</span></code></a>, or uses <a class="reference internal" href="ref-core.html#firebird.driver.core.Statement" title="firebird.driver.core.Statement"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Statement</span></code></a> instance
provided by your code as SQL command.</p>
<p>To get the (prepared) <a class="reference internal" href="ref-core.html#firebird.driver.core.Statement" title="firebird.driver.core.Statement"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Statement</span></code></a> instance for later (repeated) execution, use
<a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.prepare" title="firebird.driver.core.Cursor.prepare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare()</span></code></a> method. You can then pass this instance to <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.execute" title="firebird.driver.core.Cursor.execute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">execute()</span></code></a>,
<a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.executemany" title="firebird.driver.core.Cursor.executemany"><code class="xref py py-obj docutils literal notranslate"><span class="pre">executemany()</span></code></a> or <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.open" title="firebird.driver.core.Cursor.open"><code class="xref py py-obj docutils literal notranslate"><span class="pre">open()</span></code></a> instead <code class="xref py py-obj docutils literal notranslate"><span class="pre">command</span> <span class="pre">string</span></code>.</p>
<p><a class="reference internal" href="ref-core.html#firebird.driver.core.Statement" title="firebird.driver.core.Statement"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Statement</span></code></a> instances are bound to <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a> instance, and can’t be used
with any other <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a>. Beside repeated execution they are also useful
to get information about statement (like its execution <a class="reference internal" href="ref-core.html#firebird.driver.core.Statement.plan" title="firebird.driver.core.Statement.plan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plan</span></code></a> or
<a class="reference internal" href="ref-core.html#firebird.driver.core.Statement.type" title="firebird.driver.core.Statement.type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code></a>) before its execution.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The internally managed <a class="reference internal" href="ref-core.html#firebird.driver.core.Statement" title="firebird.driver.core.Statement"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Statement</span></code></a> instance is released when <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor" title="firebird.driver.core.Cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code></a> is closed,
or before any new statement is executed. It means that if your code executes
the same SQL command (passed as string) repeatedly without closing the cursor
between calls, the same <a class="reference internal" href="ref-core.html#firebird.driver.core.Statement" title="firebird.driver.core.Statement"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Statement</span></code></a> instance is (re)used.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Implementation of Cursor in firebird-driver somewhat violates the Python DB API 2.0,
which requires that cursor will be unusable after call to <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.close" title="firebird.driver.core.Cursor.close"><code class="xref py py-obj docutils literal notranslate"><span class="pre">close()</span></code></a>; and
an Error (or subclass) exception should be raised if any operation is attempted with
the cursor. In firebird-driver, the <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.close" title="firebird.driver.core.Cursor.close"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor.close()</span></code></a> call only releases resources
associated with executed statement like the result set, and you can’t fetch data or
query information about the SQL statement. However, you can use the cursor instance
to execute new SQL commands.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you’ll take advantage of this anomaly, your code would be less portable to other
Python DB API 2.0 compliant drivers.</p>
</div>
</div>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">insertStatement</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">"insert into the_table (a,b,c) values (?,?,?)"</span><span class="p">)</span>

<span class="n">inputRows</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">'aardvark'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">'zymurgy'</span><span class="p">,</span> <span class="mi">2147483647</span><span class="p">,</span> <span class="mf">99999.999</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">'foobar'</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mf">9.9</span><span class="p">)</span>
  <span class="p">]</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">inputRows</span><span class="p">:</span>
   <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insertStatement</span><span class="p">,</span><span class="n">row</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># or you can use executemany</span>
<span class="c1">#</span>
<span class="n">cur</span><span class="o">.</span><span class="n">executemany</span><span class="p">(</span><span class="n">insertStatement</span><span class="p">,</span> <span class="n">inputRows</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="ref-core.html#firebird.driver.core.Statement" title="firebird.driver.core.Statement"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Statement</span></code></a> for details.</p>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Named Cursors"></a><section id="named-cursors">
<span id="index-16"></span><h3>Named Cursors<a class="headerlink" href="#named-cursors" title="Permalink to this heading">¶</a></h3>
<p>To allow the Python programmer to perform scrolling <strong>UPDATE</strong> or <strong>DELETE</strong> via the
<strong>“SELECT … FOR UPDATE”</strong> syntax, the firebird-driver provides the read-only property
<a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.name" title="firebird.driver.core.Cursor.name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor.name</span></code></a> and method <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.set_cursor_name" title="firebird.driver.core.Cursor.set_cursor_name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor.set_cursor_name()</span></code></a>.</p>
<p><strong>Example Program:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span>

<span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'sysdba'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
    <span class="n">curScroll</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">curUpdate</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

    <span class="n">curScroll</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"select city from customer for update"</span><span class="p">)</span>
    <span class="n">curScroll</span><span class="o">.</span><span class="n">set_cursor_name</span><span class="p">(</span><span class="s1">'city_scroller'</span><span class="p">)</span>
    <span class="n">update</span> <span class="o">=</span> <span class="s2">"update customer set city=? where current of "</span> <span class="o">+</span> <span class="n">curScroll</span><span class="o">.</span><span class="n">name</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">city</span><span class="p">,)</span> <span class="ow">in</span> <span class="n">curScroll</span><span class="p">:</span>
        <span class="n">city</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># make some changes to city</span>
        <span class="n">curUpdate</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span> <span class="n">update</span><span class="p">,</span> <span class="p">(</span><span class="n">city</span><span class="p">,)</span> <span class="p">)</span>

    <span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Working with stored procedures"></a><section id="working-with-stored-procedures">
<span id="index-17"></span><h3>Working with stored procedures<a class="headerlink" href="#working-with-stored-procedures" title="Permalink to this heading">¶</a></h3>
<p>Firebird stored procedures can have input parameters and/or output parameters.
Some databases support input/output parameters, where the same parameter is used
for both input and output; Firebird does not support this.</p>
<p>It is important to distinguish between procedures that <strong>return a result set</strong> and
procedures that <strong>populate and return their output parameters</strong> exactly once. Conceptually,
the latter “return their output parameters” like a Python function, whereas the former
“yield result rows” like a Python generator.</p>
<p>Firebird’s <strong>server-side</strong> procedural SQL syntax makes no such distinction, but client-side
SQL code (and C API code) must. A result set is retrieved from a stored procedure by
<strong>SELECT’ing from the procedure, whereas output parameters are retrieved with an
‘EXECUTE PROCEDURE’ statement</strong>.</p>
<p>To <strong>retrieve a result set</strong> from a stored procedure with firebird-driver, use code
such as this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"select output1, output2 from the_proc(?, ?)"</span><span class="p">,</span> <span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">))</span>

<span class="c1"># Ordinary fetch code here, such as:</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">:</span>
   <span class="o">...</span> <span class="c1"># process row</span>

<span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span> <span class="c1"># If the procedure had any side effects, commit them.</span>
</pre></div>
</div>
<p>To <strong>execute</strong> a stored procedure and <strong>access its output parameters</strong>, you can
choose from two options:</p>
<ol class="arabic simple">
<li><p>Method <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.callproc" title="firebird.driver.core.Cursor.callproc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor.callproc()</span></code></a> that <strong>conforms to Python DB API 2.0</strong>. This method
does not returns the output parameters directly, and you must call <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.fetchone" title="firebird.driver.core.Cursor.fetchone"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor.fetchone()</span></code></a>
<strong>exactly once</strong> to retrieve them.</p></li>
<li><p>Method <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.call_procedure" title="firebird.driver.core.Cursor.call_procedure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor.call_procedure()</span></code></a> that returns output parameters directly
(or <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> if procedure does not have output parameters).</p></li>
</ol>
<p><strong>Examples:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Python DB API 2.0 compliant method:</span>
<span class="n">cur</span><span class="o">.</span><span class="n">callproc</span><span class="p">(</span><span class="s2">"the_proc"</span><span class="p">,</span> <span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">))</span>
<span class="c1"># If there are output parameters, retrieve them as though they were the</span>
<span class="c1"># first row of a result set...</span>
<span class="n">outputParams</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>

<span class="c1"># alternative method:</span>
<span class="n">outputParams</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">call_procedure</span><span class="p">(</span><span class="s2">"the_proc"</span><span class="p">,</span> <span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">))</span>

<span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span> <span class="c1"># If the procedure had any side effects, commit them.</span>
</pre></div>
</div>
</section>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Data handling and conversions"></a><section id="data-handling-and-conversions">
<span id="index-18"></span><h2>Data handling and conversions<a class="headerlink" href="#data-handling-and-conversions" title="Permalink to this heading">¶</a></h2>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Implicit Conversion of Input Parameters from Strings"></a><section id="implicit-conversion-of-input-parameters-from-strings">
<span id="index-19"></span><h3>Implicit Conversion of Input Parameters from Strings<a class="headerlink" href="#implicit-conversion-of-input-parameters-from-strings" title="Permalink to this heading">¶</a></h3>
<p>The Firebird database engine treats most SQL data types in a weakly typed fashion:
the engine may attempt to convert the raw value to a different type, as appropriate
for the current context. For instance, the SQL expressions <code class="xref py py-obj docutils literal notranslate"><span class="pre">123</span></code> (integer) and <code class="xref py py-obj docutils literal notranslate"><span class="pre">‘123’</span></code>
(string) are treated equivalently when the value is to be inserted into an <code class="xref py py-obj docutils literal notranslate"><span class="pre">integer</span></code>
field; the same applies when <code class="xref py py-obj docutils literal notranslate"><span class="pre">‘123’</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">123</span></code> are to be inserted into a <code class="xref py py-obj docutils literal notranslate"><span class="pre">varchar</span></code> field.</p>
<p>This weak typing model is quite unlike Python’s dynamic yet strong typing. Although
weak typing is regarded with suspicion by most experienced Python programmers, the
database engine is in certain situations so aggressive about its typing model that
firebird-driver must compromise in order to remain an elegant means of programming
the database engine.</p>
<p>An example is the handling of “magic values” for date and time fields. The database
engine interprets certain string values such as <code class="xref py py-obj docutils literal notranslate"><span class="pre">‘yesterday’</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">‘now’</span></code> as having
special meaning in a date/time context. If firebird-driver did not accept strings as
the values of parameters destined for storage in date/time fields, the resulting code
would be awkward. Consider the difference between the two Python snippets below, which
insert a row containing an integer and a timestamp into a table defined with the following
DDL statement:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">test_table</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="nb">integer</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">timestamp</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">t</span> <span class="o">=</span> <span class="s1">'now'</span>
<span class="n">sqlWithMagicValues</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"insert into test_table (i, t) values (?, '</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s2">')"</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sqlWithMagicValues</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,))</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">t</span> <span class="o">=</span> <span class="s1">'now'</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"insert into test_table (i, t) values (?, ?)"</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
<p>If firebird-driver did not support weak parameter typing, string parameters that
the database engine is to interpret as “magic values” would have to be rolled into
the SQL statement in a separate operation from the binding of the rest of the parameters,
as in the first Python snippet above. Implicit conversion of parameter values from
strings allows the consistency evident in the second snippet, which is both more
readable and more general.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It should be noted that firebird-driver does not perform the conversion from string
itself. Instead, it passes that responsibility to the database engine by changing
the parameter metadata structure dynamically at the last moment, then restoring
the original state of the metadata structure after the database engine has performed
the conversion.</p>
</div>
<p>A secondary benefit is that when one uses firebird-driver to import large amounts
of data from flat files into the database, the incoming values need not necessarily
be converted to their proper Python types before being passed to the database engine.
Eliminating this intermediate step may accelerate the import process considerably,
although other factors such as the chosen connection protocol and the deactivation
of indexes during the import are more consequential. For bulk import tasks, the
database engine’s external tables also deserve consideration. External tables can
be used to suck semi-structured data from flat files directly into the relational
database without the intervention of an ad hoc conversion program.</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Automatic conversion from/to Unicode"></a><section id="automatic-conversion-from-to-unicode">
<span id="index-20"></span><h3>Automatic conversion from/to Unicode<a class="headerlink" href="#automatic-conversion-from-to-unicode" title="Permalink to this heading">¶</a></h3>
<p>In Firebird, every <code class="xref py py-obj docutils literal notranslate"><span class="pre">CHAR</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">VARCHAR</span></code> or textual <code class="xref py py-obj docutils literal notranslate"><span class="pre">BLOB</span></code> field can (or, better: must)
have a <code class="xref py py-obj docutils literal notranslate"><span class="pre">character</span> <span class="pre">set</span></code> assigned. While it’s possible to define single character set
for whole database, it’s also possible to define different character set for each
textual field. This information is used to correctly store the bytes that make up
the character string, and together with collation information (that defines the sort
ordering and uppercase conversions for a string) is vital for correct data manipulation,
including automatic transliteration between character sets when necessary.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Because data also flow between server and client application, it’s vital that client
will send data encoded only in character set(s) that server expects. While it’s
possible to leave this responsibility completely on client application, it’s better
when client and server settle on single character set they would use for communication,
especially when database operates with multiple character sets, or uses character set
that is not <code class="xref py py-obj docutils literal notranslate"><span class="pre">native</span></code> for client application.</p>
<p>Character set for communication is specified using <a class="reference internal" href="ref-config.html#firebird.driver.config.DatabaseConfig.charset" title="firebird.driver.config.DatabaseConfig.charset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">charset</span></code></a>
configuration option, or parameter in <a class="reference internal" href="ref-core.html#firebird.driver.core.connect" title="firebird.driver.core.connect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">connect()</span></code></a> or <a class="reference internal" href="ref-core.html#firebird.driver.core.create_database" title="firebird.driver.core.create_database"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_database()</span></code></a> call.</p>
<p>When <code class="xref py py-obj docutils literal notranslate"><span class="pre">connection</span> <span class="pre">charset</span></code> is defined, all textual data returned from server are encoded
in this charset, and client application must ensure that all textual data sent to server
are encoded only in this charset as well.</p>
</div>
<p>Firebird-driver helps with client side of this character set bargain by automatically
converting Python <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a> values into <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bytes</span></code></a> encoded in connection character set,
and vice versa. However, developers are still responsible that <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bytes</span></code></a> strings
passed to server are in correct encoding (because firebird-driver makes no assumption
about encoding of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bytes</span></code></a> strings, so it can’t recode them to connection charset).</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In case that <code class="xref py py-obj docutils literal notranslate"><span class="pre">connection</span> <span class="pre">charset</span></code> is NOT defined at all, or <code class="xref py py-obj docutils literal notranslate"><span class="pre">NONE</span></code> charset is specified,
firebird-driver uses <a class="reference external" href="https://docs.python.org/3/library/locale.html#locale.getpreferredencoding" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">locale.getpreferredencoding</span></code></a> to determine encoding for conversions
from/to <code class="xref py py-obj docutils literal notranslate"><span class="pre">unicode</span></code>.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>There is one exception to automatic conversion: when character set OCTETS is defined
for data column. Values assigned to OCTETS columns are always passed <code class="xref py py-obj docutils literal notranslate"><span class="pre">as</span> <span class="pre">is</span></code>, because
they’re basically binary streams. This has specific implications. Python 3 native
strings are <code class="xref py py-obj docutils literal notranslate"><span class="pre">unicode</span></code>, and you would probably want to use <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bytes</span></code></a> type instead. However,
firebird-driver in this case doesn’t check the value type at all, so you’ll not be
warned if you’ll make a mistake and pass <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a> to OCTETS column (unless you’ll pass
more bytes than column may hold, or you intend to store unicode that way).</p>
</div>
<p>Conversion is fully automatic in both directions for all textual data, i.e. including
for string values returned by Firebird Service  and <code class="xref py py-obj docutils literal notranslate"><span class="pre">info</span></code> calls etc. When <code class="xref py py-obj docutils literal notranslate"><span class="pre">connection</span>
<span class="pre">charset</span></code> is not specified, firebird-driver uses <a class="reference external" href="https://docs.python.org/3/library/locale.html#locale.getpreferredencoding" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">locale.getpreferredencoding</span></code></a> to
determine encoding for conversions from/to <code class="xref py py-obj docutils literal notranslate"><span class="pre">unicode</span></code>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Except for legacy databases that doesn’t have <code class="xref py py-obj docutils literal notranslate"><span class="pre">character</span> <span class="pre">set</span></code> defined, <strong>always</strong>
define character set for your databases and specify <code class="xref py py-obj docutils literal notranslate"><span class="pre">connection</span> <span class="pre">charset</span></code>. It will
make your life much easier.</p>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Working with BLOBs"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Working with BLOBs"></a><section id="working-with-blobs">
<span id="index-21"></span><span id="id7"></span><h3>Working with BLOBs<a class="headerlink" href="#working-with-blobs" title="Permalink to this heading">¶</a></h3>
<p>Firebird-driver uses two types of BLOB values:</p>
<ul class="simple">
<li><p><strong>Materialized</strong> BLOB values are Python <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bytes</span></code></a> values. This is the <strong>default</strong> type.</p></li>
<li><p><strong>Streamed</strong> BLOB values are <code class="xref py py-obj docutils literal notranslate"><span class="pre">file-like</span></code> objects.</p></li>
</ul>
<p>Materialized BLOBs are easy to work with, but are not suitable for:</p>
<ul class="simple">
<li><p><strong>deferred loading</strong> of BLOBs. They’re called <code class="xref py py-obj docutils literal notranslate"><span class="pre">materialized</span></code> because they’re always
fetched from server as part of row fetch. Fetching BLOB value means separate API calls
(and network roundtrips), which may slow down you application considerably.</p></li>
<li><p><strong>large values</strong>, as they are always stored in memory in full size.</p></li>
</ul>
<p>These drawbacks are addressed by <code class="xref py py-obj docutils literal notranslate"><span class="pre">stream</span></code> BLOBs. Using BLOBs in <code class="xref py py-obj docutils literal notranslate"><span class="pre">stream</span></code> mode is easy:</p>
<ul class="simple">
<li><p>For <strong>input</strong> values, simply use <a class="reference internal" href="#id3"><span class="std std-ref">parameterized statement</span></a>
and pass any <code class="xref py py-obj docutils literal notranslate"><span class="pre">file-like</span></code> object in place of BLOB parameter. The <code class="xref py py-obj docutils literal notranslate"><span class="pre">file-like</span></code> object must
implement only the <code class="xref py py-obj docutils literal notranslate"><span class="pre">read</span></code> method, as no other method is used.</p></li>
<li><p>For <strong>output</strong> values, add column name(s) that should be returned as <code class="xref py py-obj docutils literal notranslate"><span class="pre">file-like</span></code>
objects to <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.stream_blobs" title="firebird.driver.core.Cursor.stream_blobs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor.stream_blobs</span></code></a> list attribute. Firebird-driver then returns
<a class="reference internal" href="ref-core.html#firebird.driver.core.BlobReader" title="firebird.driver.core.BlobReader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BlobReader</span></code></a> instance instead string in place of returned BLOB value for these column(s).</p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The firebird-driver provides <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.stream_blob_threshold" title="firebird.driver.core.Cursor.stream_blob_threshold"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor.stream_blob_threshold</span></code></a> attribute that controls
the maximum size of materialized blobs (as memory exhaustion safeguard). When particular
blob value exceeds this threshold, an instance of <a class="reference internal" href="ref-core.html#firebird.driver.core.BlobReader" title="firebird.driver.core.BlobReader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BlobReader</span></code></a> is returned instead
string/bytes value.</p>
<p>Zero threshold value effectively forces all blobs to be returned as stream blobs.
Negative value means no size limit for materialized blobs (use at your own risk).
Please note that positive threshold value means that your application has to be
prepared to handle BLOBs in both incarnations.</p>
<p>The default threshold is 64K and could be changed using <a class="reference internal" href="ref-config.html#firebird.driver.config.DriverConfig.stream_blob_threshold" title="firebird.driver.config.DriverConfig.stream_blob_threshold"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DriverConfig.stream_blob_threshold</span></code></a>
configuration option.</p>
<p>Blob size threshold has effect only on materialized blob columns, i.e. columns not
explicitly requested to be returned as streamed ones using <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.stream_blobs" title="firebird.driver.core.Cursor.stream_blobs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor.stream_blobs</span></code></a>
attribute, that are <strong>always</strong> returned as stream blobs.</p>
</div>
<p>The <a class="reference internal" href="ref-core.html#firebird.driver.core.BlobReader" title="firebird.driver.core.BlobReader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BlobReader</span></code></a> instance is bound to <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor" title="firebird.driver.core.Cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code></a> instance, and it’s automatically closed
with cursor. However, it’s good practice to use <code class="xref py py-obj docutils literal notranslate"><span class="pre">with</span></code> statement or call <a class="reference internal" href="ref-core.html#firebird.driver.core.BlobReader.close" title="firebird.driver.core.BlobReader.close"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BlobReader.close()</span></code></a>
once you’re finished reading to release system resources associated with BLOB value.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>When working with BLOB values, always have memory efficiency in mind, especially when
you’re processing huge quantity of rows with BLOB values at once. Materialized BLOB
values may exhaust your memory quickly, but using stream BLOBs may have inpact on
performance too, as new <a class="reference internal" href="ref-core.html#firebird.driver.core.BlobReader" title="firebird.driver.core.BlobReader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BlobReader</span></code></a> instance is created for each value fetched.</p>
</div>
<p><strong>Example program:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span>

<span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Materialized retrieval (as str):"</span><span class="p">)</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">'select proj_id, proj_desc from project'</span><span class="p">)</span>
    <span class="n">proj_id</span><span class="p">,</span> <span class="n">proj_desc</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">proj_id</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="n">proj_desc</span><span class="si">=}</span><span class="s2">"</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Streaming retrieval (via BlobReader):"</span><span class="p">)</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">stream_blobs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'PROJ_DESC'</span><span class="p">)</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">'select proj_id, proj_desc from project'</span><span class="p">)</span>
    <span class="n">proj_id</span><span class="p">,</span> <span class="n">proj_desc</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">proj_desc</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">proj_id</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="n">proj_desc</span><span class="si">=}</span><span class="s2">"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">proj_desc</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Materialized</span> <span class="n">retrieval</span> <span class="p">(</span><span class="k">as</span> <span class="nb">str</span><span class="p">):</span>
<span class="n">proj_id</span><span class="o">=</span><span class="s1">'VBASE'</span><span class="p">,</span> <span class="n">proj_desc</span><span class="o">=</span><span class="s1">'Design a video data base management system for</span><span class="se">\n</span><span class="s1">controlling on-demand video distribution.</span><span class="se">\n</span><span class="s1">'</span>

<span class="n">Streaming</span> <span class="n">retrieval</span> <span class="p">(</span><span class="n">via</span> <span class="n">BlobReader</span><span class="p">):</span>
<span class="n">proj_id</span><span class="o">=</span><span class="s1">'VBASE'</span><span class="p">,</span> <span class="n">proj_desc</span><span class="o">=</span><span class="n">BlobReader</span><span class="p">[</span><span class="n">size</span><span class="o">=</span><span class="mi">89</span><span class="p">]</span>
<span class="n">Design</span> <span class="n">a</span> <span class="n">video</span> <span class="n">data</span> <span class="n">base</span> <span class="n">management</span> <span class="n">system</span> <span class="k">for</span>
<span class="n">controlling</span> <span class="n">on</span><span class="o">-</span><span class="n">demand</span> <span class="n">video</span> <span class="n">distribution</span><span class="o">.</span>
</pre></div>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Firebird ARRAY type"></a><section id="firebird-array-type">
<span id="index-22"></span><h3>Firebird ARRAY type<a class="headerlink" href="#firebird-array-type" title="Permalink to this heading">¶</a></h3>
<p>Firebird-driver supports Firebird ARRAY data type. ARRAY values are represented as
Python lists. On input, the Python sequence (list or tuple) must be nested appropriately
if the array field is multi-dimensional, and the incoming sequence must not fall short
of its maximum possible length (it will not be “padded” implicitly–see below). On output,
the lists will be nested if the database array has multiple dimensions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Database arrays have no place in a purely relational data model, which requires that
data values be atomized (that is, every value stored in the database must be reduced
to elementary, non-decomposable parts). The Firebird implementation of database arrays,
like that of most relational database engines that support this data type, is fraught
with limitations.</p>
<p>Database arrays are of fixed size, with a predeclared number of dimensions (max. 16)
and number of elements per dimension. Individual array elements cannot be set to
NULL / None, so the mapping between Python lists (which have dynamic length and are
therefore not normally “padded” with dummy values) and non-trivial database arrays is
clumsy.</p>
<p>Stored procedures cannot have array parameters.</p>
<p>Finally, many interface libraries, GUIs, and even the isql command line utility do not
support database arrays.</p>
<p>In general, it is preferable to avoid using database arrays unless you have a compelling
reason.</p>
</div>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">,</span><span class="n">user</span><span class="o">=</span><span class="s1">'sysdba'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"select LANGUAGE_REQ from job where job_code='Eng' and job_grade=3 and job_country='Japan'"</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
<span class="go">(['Japanese\n', 'Mandarin\n', 'English\n', '\n', '\n'],)</span>
</pre></div>
</div>
<p><strong>Example program:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span>

<span class="n">arrayIn</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">]</span>
  <span class="p">]</span>

<span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'/temp/test.db'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'sysdba'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'pass'</span><span class="p">)</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
    <span class="n">con</span><span class="o">.</span><span class="n">execute_immediate</span><span class="p">(</span><span class="s2">"recreate table array_table (a int[3,4])"</span><span class="p">)</span>
    <span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">arrayIn</span><span class="si">=}</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"insert into array_table values (?)"</span><span class="p">,</span> <span class="p">(</span><span class="n">arrayIn</span><span class="p">,))</span>
    <span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"select a from array_table"</span><span class="p">)</span>
    <span class="n">arrayOut</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">arrayOut</span><span class="si">=}</span><span class="s2">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">arrayIn</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]]</span>
<span class="n">arrayOut</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]]</span>
</pre></div>
</div>
</section>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Transanction management"></a><section id="transanction-management">
<span id="index-23"></span><h2>Transanction management<a class="headerlink" href="#transanction-management" title="Permalink to this heading">¶</a></h2>
<p>For the sake of simplicity, firebird-driver lets the Python programmer ignore
transaction management to the greatest extent allowed by the Python Database
API Specification 2.0. The specification says, “if the database supports an
auto-commit feature, this must be initially off”. At a minimum, therefore,
it is necessary to call the commit method of the connection in order to persist
any changes made to the database.</p>
<p>Remember that because of ACID, every data manipulation operation in the Firebird
database engine takes place in the context of a transaction, including operations
that are conceptually “read-only”, such as a typical SELECT. The client programmer
of firebird-driver establishes a transaction implicitly by using any SQL execution
method, such as <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.execute_immediate" title="firebird.driver.core.Connection.execute_immediate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection.execute_immediate()</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.execute" title="firebird.driver.core.Cursor.execute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor.execute()</span></code></a>, or
<a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.callproc" title="firebird.driver.core.Cursor.callproc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor.callproc()</span></code></a>.</p>
<p>Although firebird-driver allows the programmer to pay little attention to transactions,
it also exposes the full complement of the database engine’s advanced transaction
control features: <a class="reference internal" href="#transaction-parameters">transaction parameters</a>, <a class="reference internal" href="#retaining-transactions">retaining transactions</a>, <a class="reference internal" href="#savepoints">savepoints</a>,
and <a class="reference internal" href="#id8">distributed transactions</a>.</p>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Basics"></a><section id="basics">
<h3>Basics<a class="headerlink" href="#basics" title="Permalink to this heading">¶</a></h3>
<p>When it comes to transactions, Python Database API 2.0 specify that <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a> object
has to respond to the following methods:</p>
<p><a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.commit" title="firebird.driver.core.Connection.commit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection.commit()</span></code></a></p>
<blockquote>
<div><p>Commits any pending transaction to the database. Note that if the database supports
an auto-commit feature, this must be initially off. An interface method may be provided
to turn it back on. Database modules that do not support transactions should implement
this method with void functionality.</p>
</div></blockquote>
<p><a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.rollback" title="firebird.driver.core.Connection.rollback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection.rollback()</span></code></a></p>
<blockquote>
<div><p>(optional) In case a database does provide transactions this method causes the the
database to roll back to the start of any pending transaction. <strong>Closing a connection
without committing the changes first will cause an implicit rollback to be performed.</strong></p>
</div></blockquote>
<p>In addition to the implicit transaction initiation required by Python Database API,
firebird-driver allows the programmer to start transactions explicitly via the
<a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.begin" title="firebird.driver.core.Connection.begin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection.begin()</span></code></a> method. Also <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.savepoint" title="firebird.driver.core.Connection.savepoint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection.savepoint()</span></code></a> method was added to provide
support for <a class="reference external" href="http://www.firebirdsql.org/refdocs/langrefupd15-savepoint.html">Firebird SAVEPOINTs</a>.</p>
<p>But Python Database API 2.0 was created with assumption that connection can support only
one transactions per single connection. However, Firebird can support multiple independent
transactions that can run simultaneously within single connection / attachment to the
database. This feature is very important, as applications may require multiple transaction
opened simultaneously to perform various tasks, which would require to open multiple
connections and thus consume more resources than necessary.</p>
<p>Firebird-driver surfaces this Firebird feature by separating transaction management out
from <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a> into separate <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager" title="firebird.driver.core.TransactionManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionManager</span></code></a> objects. To comply with Python DB
API 2.0 requirements, <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a> object uses one <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager" title="firebird.driver.core.TransactionManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionManager</span></code></a> instance as
<a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.main_transaction" title="firebird.driver.core.Connection.main_transaction"><code class="xref py py-attr docutils literal notranslate"><span class="pre">main</span> <span class="pre">transaction</span></code></a>, and delegates <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.begin" title="firebird.driver.core.Connection.begin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">begin()</span></code></a>,
<a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.savepoint" title="firebird.driver.core.Connection.savepoint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">savepoint()</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.commit" title="firebird.driver.core.Connection.commit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">commit()</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.rollback" title="firebird.driver.core.Connection.rollback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rollback()</span></code></a> and
<a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.execute_immediate" title="firebird.driver.core.Connection.execute_immediate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">execute_immediate()</span></code></a> calls to it.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>More about using multiple transactions with the same connection in separate
<a class="reference internal" href="#multiple-transactions"><span class="std std-ref">section</span></a>.</p>
</div>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span>

<span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

    <span class="c1"># Most minimalistic transaction management -&gt; implicit start, only commit() and rollback()</span>
    <span class="c1"># ========================================================================================</span>
    <span class="c1">#</span>
    <span class="c1"># Transaction is started implicitly</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">'insert into country values ('</span><span class="n">Oz</span><span class="s1">','</span><span class="n">Crowns</span><span class="s1">')</span>
    <span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span> <span class="c1"># commits active transaction</span>
    <span class="c1"># Again, transaction is started implicitly</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">'insert into country values ('</span><span class="n">Barsoom</span><span class="s1">','</span><span class="n">XXX</span><span class="s1">')</span>
    <span class="n">con</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span> <span class="c1"># rolls back active transaction</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">'insert into country values ('</span><span class="n">Pellucidar</span><span class="s1">','</span><span class="n">Shells</span><span class="s1">')</span>

<span class="c1"># Commit was not performed before connection context was closed</span>
<span class="c1"># This will roll back the transaction because Python DB API 2.0</span>
<span class="c1"># requires that closing connection with pending transaction must</span>
<span class="c1"># cause an implicit rollback</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager" title="firebird.driver.core.TransactionManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionManager</span></code></a> for details.</p>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Auto-commit"></a><section id="auto-commit">
<span id="index-24"></span><h3>Auto-commit<a class="headerlink" href="#auto-commit" title="Permalink to this heading">¶</a></h3>
<p>Firebird-driver doesn’t support <code class="xref py py-obj docutils literal notranslate"><span class="pre">auto-commit</span></code> feature directly, but developers
may achieve the similar result using <code class="xref py py-obj docutils literal notranslate"><span class="pre">explicit</span></code> transaction start, taking advantage
of <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager.default_action" title="firebird.driver.core.TransactionManager.default_action"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionManager.default_action</span></code></a> and its default value (<a class="reference internal" href="ref-types.html#firebird.driver.types.DefaultAction.COMMIT" title="firebird.driver.types.DefaultAction.COMMIT"><code class="xref py py-obj docutils literal notranslate"><span class="pre">COMMIT</span></code></a>).</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span>

<span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

    <span class="n">con</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">'insert into country values ('</span><span class="n">Oz</span><span class="s1">','</span><span class="n">Crowns</span><span class="s1">')</span>
    <span class="n">con</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span> <span class="c1"># commits active transaction and starts new one</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">'insert into country values ('</span><span class="n">Barsoom</span><span class="s1">','</span><span class="n">XXX</span><span class="s1">')</span>
    <span class="n">con</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span> <span class="c1"># commits active transaction and starts new one</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">'insert into country values ('</span><span class="n">Pellucidar</span><span class="s1">','</span><span class="n">Shells</span><span class="s1">')</span>

    <span class="c1"># However, commit is required before connection is closed,</span>
    <span class="c1"># because Python DB API 2.0 requires that closing connection</span>
    <span class="c1"># with pending transaction must cause an implicit rollback</span>
    <span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Transaction parameters"></a><section id="transaction-parameters">
<span id="index-25"></span><h3>Transaction parameters<a class="headerlink" href="#transaction-parameters" title="Permalink to this heading">¶</a></h3>
<p>The database engine offers the client programmer an optional facility called
<code class="xref py py-obj docutils literal notranslate"><span class="pre">transaction</span> <span class="pre">parameter</span> <span class="pre">buffers</span></code> (TPBs) for tweaking the operating characteristics
of the transactions he initiates. These include characteristics such as whether
the transaction has read and write access to tables, or read-only access, and
whether or not other simultaneously active transactions can share table access
with the transaction.</p>
<p>Transaction manager has <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager.default_tpb" title="firebird.driver.core.TransactionManager.default_tpb"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_tpb</span></code></a> attribute that can be
changed to set the default TPB to be used for all subsequent transactions started
by this manager. Also Connection have a <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.default_tpb" title="firebird.driver.core.Connection.default_tpb"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_tpb</span></code></a> attribute,
but it’s used to set the default TPB for all transactions managers subsequently
created for the connection (see <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.transaction_manager" title="firebird.driver.core.Connection.transaction_manager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection.transaction_manager()</span></code></a>).</p>
<p>Alternatively, if the programmer only wants to set the TPB for a single transaction,
he can start a transaction explicitly via the <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.begin" title="firebird.driver.core.Connection.begin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection.begin()</span></code></a> or
<a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager.begin" title="firebird.driver.core.TransactionManager.begin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionManager.begin()</span></code></a> method and pass a TPB for that single transaction.</p>
<p>The TPB is a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bytes</span></code></a> value constructed from various tags and binary values, as
defined by API. While you can construct the TPB manually, the firebird-driver
provides several convenient ways for TPB construction:</p>
<ol class="arabic simple">
<li><p>The <a class="reference internal" href="ref-core.html#firebird.driver.core.tpb" title="firebird.driver.core.tpb"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tpb()</span></code></a> function for simple TPBs.</p></li>
<li><p>The <a class="reference internal" href="ref-core.html#firebird.driver.core.TPB" title="firebird.driver.core.TPB"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TPB</span></code></a> class for complex TPBs (including table reservation etc.).</p></li>
</ol>
<p><strong>Examples:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">tpb</span><span class="p">,</span> <span class="n">TPB</span><span class="p">,</span> <span class="n">Isolation</span><span class="p">,</span> <span class="n">TraAccessMode</span><span class="p">,</span> <span class="n">TableShareMode</span><span class="p">,</span> <span class="n">TableAccessMode</span>

<span class="c1"># Use tpb() if isolation, timeout and access_mode parameters are enough for you</span>
<span class="n">simple_tpb</span> <span class="o">=</span> <span class="n">tpb</span><span class="p">(</span><span class="n">Isolation</span><span class="o">.</span><span class="n">READ_COMMITTED_READ_CONSISTENCY</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="n">TraAccessMode</span><span class="o">.</span><span class="n">WRITE</span><span class="p">)</span>

<span class="c1"># Use TPB if you want additional parameters than isolation, timeout and access_mode</span>
<span class="n">my_tpb</span> <span class="o">=</span> <span class="n">TPB</span><span class="p">(</span><span class="n">isolation</span><span class="o">=</span><span class="n">Isolation</span><span class="o">.</span><span class="n">SNAPSHOT</span><span class="p">,</span>
             <span class="n">access_mode</span><span class="o">=</span><span class="n">TraAccessMode</span><span class="o">.</span><span class="n">WRITE</span><span class="p">,</span>
             <span class="n">lock_timeout</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
             <span class="n">no_auto_undo</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">auto_commit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">ignore_limbo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">my_tpb</span><span class="o">.</span><span class="n">reserve_table</span><span class="p">(</span><span class="s1">'MY_TABLE'</span><span class="p">,</span> <span class="n">TableShareMode</span><span class="o">.</span><span class="n">PROTECTED</span><span class="p">,</span> <span class="n">TableAccessMode</span><span class="o">.</span><span class="n">LOCK_WRITE</span><span class="p">)</span>
<span class="n">complex_tpb</span> <span class="o">=</span> <span class="n">my_tpb</span><span class="o">.</span><span class="n">get_buffer</span><span class="p">()</span>
</pre></div>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Getting information about transaction"></a><section id="getting-information-about-transaction">
<span id="index-26"></span><h3>Getting information about transaction<a class="headerlink" href="#getting-information-about-transaction" title="Permalink to this heading">¶</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Because the scope and type of transaction information depends on the version of the Firebird
server, this information is made available through a separate class
<a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionInfoProvider" title="firebird.driver.core.TransactionInfoProvider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionInfoProvider</span></code></a>. The <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager.info" title="firebird.driver.core.TransactionManager.info"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionManager.info</span></code></a> property provides access to
instance of <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionInfoProvider" title="firebird.driver.core.TransactionInfoProvider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionInfoProvider</span></code></a> or it’s <strong>ancestor</strong> class according to used
Firebird version.</p>
</div>
<p>Although you may query the information directly from server using
<a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionInfoProvider3.get_info" title="firebird.driver.core.TransactionInfoProvider3.get_info"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_info()</span></code></a> method (that wraps the Firebird <code class="xref py py-obj docutils literal notranslate"><span class="pre">ITransaction.getInfo()</span></code>
API call), the <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionInfoProvider" title="firebird.driver.core.TransactionInfoProvider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionInfoProvider</span></code></a> object provides more convenient methods and properties
for obtaining specific information directly.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span><span class="p">,</span> <span class="n">driver_config</span>

<span class="n">driver_config</span><span class="o">.</span><span class="n">server_defaults</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">'localhost'</span>
<span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
    <span class="n">con</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">main_transaction</span><span class="o">.</span><span class="n">info</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Transaction ID: </span><span class="si">{</span><span class="n">info</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Database: </span><span class="si">{</span><span class="n">info</span><span class="o">.</span><span class="n">database</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Isolation level: </span><span class="si">{</span><span class="n">info</span><span class="o">.</span><span class="n">isolation</span><span class="si">!s}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Lock timeout: </span><span class="si">{</span><span class="n">info</span><span class="o">.</span><span class="n">lock_timeout</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Is Read-Only: </span><span class="si">{</span><span class="n">info</span><span class="o">.</span><span class="n">is_read_only</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"ID of Oldest Interesting Transaction: </span><span class="si">{</span><span class="n">info</span><span class="o">.</span><span class="n">oit</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"ID of Oldest Active Transaction: </span><span class="si">{</span><span class="n">info</span><span class="o">.</span><span class="n">oat</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"ID of Oldest Snapshot Transaction: </span><span class="si">{</span><span class="n">info</span><span class="o">.</span><span class="n">ost</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Transaction</span> <span class="n">ID</span><span class="p">:</span> <span class="mi">352</span>
<span class="n">Database</span><span class="p">:</span> <span class="n">localhost</span><span class="p">:</span><span class="n">employee</span>
<span class="n">Isolation</span> <span class="n">level</span><span class="p">:</span> <span class="n">Isolation</span><span class="o">.</span><span class="n">SNAPSHOT</span>
<span class="n">Lock</span> <span class="n">timeout</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">Is</span> <span class="n">Read</span><span class="o">-</span><span class="n">Only</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">ID</span> <span class="n">of</span> <span class="n">Oldest</span> <span class="n">Interesting</span> <span class="n">Transaction</span><span class="p">:</span> <span class="mi">350</span>
<span class="n">ID</span> <span class="n">of</span> <span class="n">Oldest</span> <span class="n">Active</span> <span class="n">Transaction</span><span class="p">:</span> <span class="mi">352</span>
<span class="n">ID</span> <span class="n">of</span> <span class="n">Oldest</span> <span class="n">Snapshot</span> <span class="n">Transaction</span><span class="p">:</span> <span class="mi">352</span>
</pre></div>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Retaining transactions"></a><section id="retaining-transactions">
<span id="index-27"></span><h3>Retaining transactions<a class="headerlink" href="#retaining-transactions" title="Permalink to this heading">¶</a></h3>
<p>The <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager.commit" title="firebird.driver.core.TransactionManager.commit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">commit()</span></code></a> and <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager.rollback" title="firebird.driver.core.TransactionManager.rollback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rollback()</span></code></a> methods
accept an optional boolean keyword parameter <code class="xref py py-obj docutils literal notranslate"><span class="pre">retaining</span></code> (<strong>default False</strong>) to
indicate whether to recycle the transactional context of the transaction being resolved
by the method call.</p>
<p>If retaining is <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the infrastructural support for the transaction active at
the time of the method call will be “retained” (efficiently and transparently recycled)
after the database server has committed or rolled back the conceptual transaction.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In code that commits or rolls back frequently in short amount of time (like in loop),
“retaining” the transaction may yield better performance. However, retaining transactions
must be used cautiously because they can interfere with the server’s ability to garbage
collect old record versions. For details about this issue, read the “Garbage” section of
<a class="reference external" href="http://www.ibphoenix.com/resources/documents/search/doc_21">this document</a> by Ann Harrison.</p>
<p>It’s definitely no recommended to use retaining for all transactions, or retain the transaction
context indefinitely (you should eventually commit/rollback the transaction in normal
way).</p>
</div>
<p>For more information about retaining transactions, see <code class="xref py py-obj docutils literal notranslate"><span class="pre">Firebird</span> <span class="pre">documentation</span></code>.</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Savepoints"></a><section id="savepoints">
<span id="index-28"></span><h3>Savepoints<a class="headerlink" href="#savepoints" title="Permalink to this heading">¶</a></h3>
<p>Savepoints are named, intermediate control points within an open transaction that
can later be rolled back to, without affecting the preceding work. Multiple savepoints
can exist within a single unresolved transaction, providing “multi-level undo” functionality.</p>
<p>Although Firebird savepoints are fully supported from SQL alone via the <code class="xref py py-obj docutils literal notranslate"><span class="pre">SAVEPOINT</span> <span class="pre">‘name’</span></code>
and <code class="xref py py-obj docutils literal notranslate"><span class="pre">ROLLBACK</span> <span class="pre">TO</span> <span class="pre">‘name’</span></code> statements, firebird-driver also exposes savepoints at the Python
API level for the sake of convenience.</p>
<p>Call to method <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager.savepoint" title="firebird.driver.core.TransactionManager.savepoint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionManager.savepoint()</span></code></a> establishes a savepoint with the specified
<code class="xref py py-obj docutils literal notranslate"><span class="pre">name</span></code>. To roll back to a specific savepoint, call the <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager.rollback" title="firebird.driver.core.TransactionManager.rollback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rollback()</span></code></a>
method and provide the name of the savepoint for the <code class="xref py py-obj docutils literal notranslate"><span class="pre">savepoint</span></code> keyword parameter. If the
savepoint parameter of <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager.rollback" title="firebird.driver.core.TransactionManager.rollback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rollback()</span></code></a> is not specified, the active
transaction is cancelled in its entirety, as required by the Python Database API Specification.</p>
<p>The following program demonstrates savepoint manipulation via the firebird-driver API,
rather than raw SQL.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span>

<span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"recreate table test_savepoints (a integer)"</span><span class="p">)</span>
    <span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">'Before the first savepoint, the contents of the table are:'</span><span class="p">)</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"select * from test_savepoints"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>

    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"insert into test_savepoints values (?)"</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">con</span><span class="o">.</span><span class="n">savepoint</span><span class="p">(</span><span class="s1">'A'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'After savepoint A, the contents of the table are:'</span><span class="p">)</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"select * from test_savepoints"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>

    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"insert into test_savepoints values (?)"</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">con</span><span class="o">.</span><span class="n">savepoint</span><span class="p">(</span><span class="s1">'B'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'After savepoint B, the contents of the table are:'</span><span class="p">)</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"select * from test_savepoints"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>

    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"insert into test_savepoints values (?)"</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">con</span><span class="o">.</span><span class="n">savepoint</span><span class="p">(</span><span class="s1">'C'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'After savepoint C, the contents of the table are:'</span><span class="p">)</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"select * from test_savepoints"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>

    <span class="n">con</span><span class="o">.</span><span class="n">rollback</span><span class="p">(</span><span class="n">savepoint</span><span class="o">=</span><span class="s1">'B'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'After rolling back to savepoint B, the contents of the table are:'</span><span class="p">)</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"select * from test_savepoints"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>

    <span class="n">con</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'After rolling back entirely, the contents of the table are:'</span><span class="p">)</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"select * from test_savepoints"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</pre></div>
</div>
<p>The output of the example program is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Before</span> <span class="n">the</span> <span class="n">first</span> <span class="n">savepoint</span><span class="p">,</span> <span class="n">the</span> <span class="n">contents</span> <span class="n">of</span> <span class="n">the</span> <span class="n">table</span> <span class="n">are</span><span class="p">:</span>
  <span class="p">[]</span>
<span class="n">After</span> <span class="n">savepoint</span> <span class="n">A</span><span class="p">,</span> <span class="n">the</span> <span class="n">contents</span> <span class="n">of</span> <span class="n">the</span> <span class="n">table</span> <span class="n">are</span><span class="p">:</span>
  <span class="p">[(</span><span class="mi">1</span><span class="p">,)]</span>
<span class="n">After</span> <span class="n">savepoint</span> <span class="n">B</span><span class="p">,</span> <span class="n">the</span> <span class="n">contents</span> <span class="n">of</span> <span class="n">the</span> <span class="n">table</span> <span class="n">are</span><span class="p">:</span>
  <span class="p">[(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,)]</span>
<span class="n">After</span> <span class="n">savepoint</span> <span class="n">C</span><span class="p">,</span> <span class="n">the</span> <span class="n">contents</span> <span class="n">of</span> <span class="n">the</span> <span class="n">table</span> <span class="n">are</span><span class="p">:</span>
  <span class="p">[(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,)]</span>
<span class="n">After</span> <span class="n">rolling</span> <span class="n">back</span> <span class="n">to</span> <span class="n">savepoint</span> <span class="n">B</span><span class="p">,</span> <span class="n">the</span> <span class="n">contents</span> <span class="n">of</span> <span class="n">the</span> <span class="n">table</span> <span class="n">are</span><span class="p">:</span>
  <span class="p">[(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,)]</span>
<span class="n">After</span> <span class="n">rolling</span> <span class="n">back</span> <span class="n">entirely</span><span class="p">,</span> <span class="n">the</span> <span class="n">contents</span> <span class="n">of</span> <span class="n">the</span> <span class="n">table</span> <span class="n">are</span><span class="p">:</span>
  <span class="p">[]</span>
</pre></div>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Using multiple transactions with the same connection"></a><section id="using-multiple-transactions-with-the-same-connection">
<a class="dashAnchor" name="//apple_ref/cpp/Section/Using multiple transactions with the same connection"></a><span id="multiple-transactions"></span><span id="index-29"></span><h3>Using multiple transactions with the same connection<a class="headerlink" href="#using-multiple-transactions-with-the-same-connection" title="Permalink to this heading">¶</a></h3>
<p>To use additional transactions that could run simultaneously with
<a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.main_transaction" title="firebird.driver.core.Connection.main_transaction"><code class="xref py py-attr docutils literal notranslate"><span class="pre">main</span> <span class="pre">transaction</span></code></a> managed by <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a>,
create new <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager" title="firebird.driver.core.TransactionManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionManager</span></code></a> object calling <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.transaction_manager" title="firebird.driver.core.Connection.transaction_manager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection.transaction_manager()</span></code></a>
method. If you don’t specify the optional <code class="xref py py-obj docutils literal notranslate"><span class="pre">default_tpb</span></code> parameter, this new
<a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager" title="firebird.driver.core.TransactionManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionManager</span></code></a> inherits the <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.default_tpb" title="firebird.driver.core.Connection.default_tpb"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_tpb</span></code></a> from <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a>.
Physical transaction is not started when <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager" title="firebird.driver.core.TransactionManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionManager</span></code></a> instance is
created, but implicitly when first SQL statement for cursor created from
this manager is executed, or explicitly via <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager.begin" title="firebird.driver.core.TransactionManager.begin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionManager.begin()</span></code></a> call.</p>
<p>To execute statements in context of this additional transaction you have to
use <code class="xref py py-obj docutils literal notranslate"><span class="pre">cursors</span></code> obtained directly from this <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager" title="firebird.driver.core.TransactionManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionManager</span></code></a> instance calling
its <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager.cursor" title="firebird.driver.core.TransactionManager.cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cursor()</span></code></a> method, or call <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager.execute_immediate" title="firebird.driver.core.TransactionManager.execute_immediate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionManager.execute_immediate()</span></code></a>
method.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span><span class="p">,</span> <span class="n">tpb</span><span class="p">,</span> <span class="n">Isolation</span><span class="p">,</span> <span class="n">TraAccessMode</span>

<span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
    <span class="c1"># Cursor for main_transaction context</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

    <span class="c1"># Create new READ ONLY READ COMMITTED transaction</span>
    <span class="n">ro_transaction</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">transaction_manager</span><span class="p">(</span><span class="n">tpb</span><span class="p">(</span><span class="n">Isolation</span><span class="o">.</span><span class="n">READ_COMMITTED_RECORD_VERSION</span><span class="p">,</span>
                                                 <span class="n">access</span><span class="o">=</span><span class="n">TraAccessMode</span><span class="o">.</span><span class="n">READ</span><span class="p">))</span>
    <span class="c1"># and cursor</span>
    <span class="n">ro_cur</span> <span class="o">=</span> <span class="n">ro_transaction</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">'insert into country values ('</span><span class="n">Oz</span><span class="s1">','</span><span class="n">Crowns</span><span class="s1">')</span>
    <span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span> <span class="c1"># commits main transaction</span>

    <span class="c1"># Read data created by main transaction from second one</span>
    <span class="n">ro_cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"select * from COUNTRY where COUNTRY = `Oz`"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ro_cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>

    <span class="c1"># Insert more data, but don't commit</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">'insert into country values ('</span><span class="n">Barsoom</span><span class="s1">','</span><span class="n">XXX</span><span class="s1">')</span>

    <span class="c1"># Read data created by main transaction from second one</span>
    <span class="n">ro_cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"select * from COUNTRY where COUNTRY = `Barsoom`"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ro_cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</pre></div>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Distributed Transactions"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Distributed Transactions"></a><section id="distributed-transactions">
<span id="index-30"></span><span id="id8"></span><h3>Distributed Transactions<a class="headerlink" href="#distributed-transactions" title="Permalink to this heading">¶</a></h3>
<p>Distributed transactions are transactions that span multiple databases.
Firebird-driver provides this Firebird feature through <a class="reference internal" href="ref-core.html#firebird.driver.core.DistributedTransactionManager" title="firebird.driver.core.DistributedTransactionManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DistributedTransactionManager</span></code></a>
class. Instances of this class must be created manually, and managed transactions
are fully independent from all other transactions, main or secondary, of member connections.</p>
<p>Similarly to <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager" title="firebird.driver.core.TransactionManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionManager</span></code></a>, distributed transactions are managed
through <a class="reference internal" href="ref-core.html#firebird.driver.core.DistributedTransactionManager.begin" title="firebird.driver.core.DistributedTransactionManager.begin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">begin()</span></code></a>,
<a class="reference internal" href="ref-core.html#firebird.driver.core.DistributedTransactionManager.savepoint" title="firebird.driver.core.DistributedTransactionManager.savepoint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">savepoint()</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.DistributedTransactionManager.commit" title="firebird.driver.core.DistributedTransactionManager.commit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">commit()</span></code></a>
and <a class="reference internal" href="ref-core.html#firebird.driver.core.DistributedTransactionManager.rollback" title="firebird.driver.core.DistributedTransactionManager.rollback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rollback()</span></code></a> methods.
Additionally, <a class="reference internal" href="ref-core.html#firebird.driver.core.DistributedTransactionManager" title="firebird.driver.core.DistributedTransactionManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DistributedTransactionManager</span></code></a> exposes method
<a class="reference internal" href="ref-core.html#firebird.driver.core.DistributedTransactionManager.prepare" title="firebird.driver.core.DistributedTransactionManager.prepare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare()</span></code></a> that explicitly initiates the
first phase of <code class="xref py py-obj docutils literal notranslate"><span class="pre">Two-Phase</span> <span class="pre">Commit</span> <span class="pre">Protocol</span></code>. Transaction parameters are defined
similarly to <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager" title="firebird.driver.core.TransactionManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionManager</span></code></a> using <a class="reference internal" href="ref-core.html#firebird.driver.core.DistributedTransactionManager.default_tpb" title="firebird.driver.core.DistributedTransactionManager.default_tpb"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_tpb</span></code></a>
or as optional parameter to <a class="reference internal" href="ref-core.html#firebird.driver.core.DistributedTransactionManager.begin" title="firebird.driver.core.DistributedTransactionManager.begin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">begin()</span></code></a> call.</p>
<p>SQL statements that should belong to context of distributed transaction are
executed via <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor" title="firebird.driver.core.Cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code></a> instances aquired through <a class="reference internal" href="ref-core.html#firebird.driver.core.DistributedTransactionManager.cursor" title="firebird.driver.core.DistributedTransactionManager.cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DistributedTransactionManager.cursor()</span></code></a>
method, or calling <a class="reference internal" href="ref-core.html#firebird.driver.core.DistributedTransactionManager.execute_immediate" title="firebird.driver.core.DistributedTransactionManager.execute_immediate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DistributedTransactionManager.execute_immediate()</span></code></a> method.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Because <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor" title="firebird.driver.core.Cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code></a> instances can belong to only one <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a>, the
<a class="reference internal" href="ref-core.html#firebird.driver.core.DistributedTransactionManager.cursor" title="firebird.driver.core.DistributedTransactionManager.cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cursor()</span></code></a> method has mandatory parameter
<code class="xref py py-obj docutils literal notranslate"><span class="pre">connection</span></code>, to specify to which member connection cursor should belong.</p>
<p>The <a class="reference internal" href="ref-core.html#firebird.driver.core.DistributedTransactionManager.execute_immediate" title="firebird.driver.core.DistributedTransactionManager.execute_immediate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">execute_immediate()</span></code></a> method operates
on <strong>all</strong> databases in <em>group</em>.</p>
</div>
<p><strong>Example program:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">create_database</span><span class="p">,</span> <span class="n">DistributedTransactionManager</span>

<span class="c1"># First database</span>
<span class="n">con1</span> <span class="o">=</span> <span class="n">create_database</span><span class="p">(</span><span class="s1">'db1.fdb'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span>
<span class="n">con1</span><span class="o">.</span><span class="n">execute_immediate</span><span class="p">(</span><span class="s2">"recreate table T (PK integer, C1 integer)"</span><span class="p">)</span>
<span class="n">con1</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="c1"># Second database</span>
<span class="n">con2</span> <span class="o">=</span> <span class="n">create_database</span><span class="p">(</span><span class="s1">'db2.fdb'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span>
<span class="n">con2</span><span class="o">.</span><span class="n">execute_immediate</span><span class="p">(</span><span class="s2">"recreate table T (PK integer, C1 integer)"</span><span class="p">)</span>
<span class="n">con2</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="c1"># Create distributed transaction manager</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">DistributedTransactionManager</span><span class="p">((</span><span class="n">con1</span><span class="p">,</span><span class="n">con2</span><span class="p">))</span>

<span class="c1"># Prepare cursors for each connection</span>
<span class="n">dc1</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">cursor</span><span class="p">(</span><span class="n">con1</span><span class="p">)</span>
<span class="n">dc2</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">cursor</span><span class="p">(</span><span class="n">con2</span><span class="p">)</span>

<span class="c1"># Connection cursors to check content of databases</span>
<span class="n">q</span> <span class="o">=</span> <span class="s1">'select * from T order by pk'</span>

<span class="n">cc1</span> <span class="o">=</span> <span class="n">con1</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">cc1</span><span class="o">.</span><span class="n">prep</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>

<span class="n">cc2</span> <span class="o">=</span> <span class="n">con2</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">cc2</span><span class="o">.</span><span class="n">prep</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Distributed transaction: COMMIT"</span><span class="p">)</span>
<span class="c1">#      ===============================</span>
<span class="n">dc1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">'insert into t (pk) values (1)'</span><span class="p">)</span>
<span class="n">dc2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">'insert into t (pk) values (1)'</span><span class="p">)</span>
<span class="n">dt</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="c1"># check it</span>
<span class="n">con1</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">cc1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'db1:'</span><span class="p">,</span> <span class="n">cc1</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
<span class="n">con2</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">cc2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'db2:'</span><span class="p">,</span> <span class="n">cc2</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Distributed transaction: PREPARE + COMMIT"</span><span class="p">)</span>
<span class="c1">#      =========================================</span>
<span class="n">dc1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">'insert into t (pk) values (2)'</span><span class="p">)</span>
<span class="n">dc2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">'insert into t (pk) values (2)'</span><span class="p">)</span>
<span class="n">dt</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>
<span class="n">dt</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="c1"># check it</span>
<span class="n">con1</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">cc1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'db1:'</span><span class="p">,</span> <span class="n">cc1</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
<span class="n">con2</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">cc2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'db2:'</span><span class="p">,</span> <span class="n">cc2</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Distributed transaction: SAVEPOINT + ROLLBACK to it"</span><span class="p">)</span>
<span class="c1">#      ===================================================</span>
<span class="n">dc1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">'insert into t (pk) values (3)'</span><span class="p">)</span>
<span class="n">dt</span><span class="o">.</span><span class="n">savepoint</span><span class="p">(</span><span class="s1">'CG_SAVEPOINT'</span><span class="p">)</span>
<span class="n">dc2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">'insert into t (pk) values (3)'</span><span class="p">)</span>
<span class="n">dt</span><span class="o">.</span><span class="n">rollback</span><span class="p">(</span><span class="n">savepoint</span><span class="o">=</span><span class="s1">'CG_SAVEPOINT'</span><span class="p">)</span>

<span class="c1"># check it - via group cursors, as transaction is still active</span>
<span class="n">dc1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'db1:'</span><span class="p">,</span> <span class="n">dc1</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
<span class="n">dc2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'db2:'</span><span class="p">,</span> <span class="n">dc2</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Distributed transaction: ROLLBACK"</span><span class="p">)</span>
<span class="c1">#      =================================</span>
<span class="n">dt</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>

<span class="c1"># check it</span>
<span class="n">con1</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">cc1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'db1:'</span><span class="p">,</span> <span class="n">cc1</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
<span class="n">con2</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">cc2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'db2:'</span><span class="p">,</span> <span class="n">cc2</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Distributed transaction: EXECUTE_IMMEDIATE"</span><span class="p">)</span>
<span class="c1">#      ==========================================</span>
<span class="n">dt</span><span class="o">.</span><span class="n">execute_immediate</span><span class="p">(</span><span class="s1">'insert into t (pk) values (3)'</span><span class="p">)</span>
<span class="n">dt</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

<span class="c1"># check it</span>
<span class="n">con1</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">cc1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'db1:'</span><span class="p">,</span> <span class="n">cc1</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
<span class="n">con2</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="n">cc2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'db2:'</span><span class="p">,</span> <span class="n">cc2</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>

<span class="c1"># Finalize</span>
<span class="n">con1</span><span class="o">.</span><span class="n">drop_database</span><span class="p">()</span>
<span class="n">con1</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">con2</span><span class="o">.</span><span class="n">drop_database</span><span class="p">()</span>
<span class="n">con2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Distributed</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">COMMIT</span>
<span class="n">db1</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
<span class="n">db2</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
<span class="n">Distributed</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">PREPARE</span> <span class="o">+</span> <span class="n">COMMIT</span>
<span class="n">db1</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
<span class="n">db2</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
<span class="n">Distributed</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">SAVEPOINT</span> <span class="o">+</span> <span class="n">ROLLBACK</span> <span class="n">to</span> <span class="n">it</span>
<span class="n">db1</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
<span class="n">db2</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
<span class="n">Distributed</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">ROLLBACK</span>
<span class="n">db1</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
<span class="n">db2</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
<span class="n">Distributed</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">EXECUTE_IMMEDIATE</span>
<span class="n">db1</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
<span class="n">db2</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
</pre></div>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Transaction Context Manager"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Transaction Context Manager"></a><section id="transaction-context-manager">
<span id="index-31"></span><span id="id9"></span><h3>Transaction Context Manager<a class="headerlink" href="#transaction-context-manager" title="Permalink to this heading">¶</a></h3>
<p>Firebird-driver provides context manager <a class="reference internal" href="ref-core.html#firebird.driver.core.transaction" title="firebird.driver.core.transaction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transaction</span></code></a> that allows automatic
transaction management using <a class="reference external" href="https://docs.python.org/3/reference/compound_stmts.html#with" title="(in Python v3.11)"><span class="xref std std-ref">WITH statement</span></a>. It can work with
any object that supports <code class="xref py py-obj docutils literal notranslate"><span class="pre">begin()</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">commit()</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">rollback()</span></code> methods, i.e.
<a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a>, <a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager" title="firebird.driver.core.TransactionManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionManager</span></code></a> or <a class="reference internal" href="ref-core.html#firebird.driver.core.DistributedTransactionManager" title="firebird.driver.core.DistributedTransactionManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DistributedTransactionManager</span></code></a>.</p>
<p>It starts transaction when WITH block is entered and commits it if no exception
occurs within it, or calls <code class="xref py py-obj docutils literal notranslate"><span class="pre">rollback()</span></code> otherwise. Exceptions raised in WITH
block are never suppressed.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span><span class="p">,</span> <span class="n">transaction</span><span class="p">,</span> <span class="n">DistributedTransactionManager</span>

<span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>

    <span class="c1"># Uses default main transaction</span>
    <span class="k">with</span> <span class="n">transaction</span><span class="p">(</span><span class="n">con</span><span class="p">):</span>
        <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"insert into T (PK,C1) values (1,'TXT')"</span><span class="p">)</span>

    <span class="c1"># Uses separate transaction</span>
    <span class="k">with</span> <span class="n">transaction</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">transaction_manager</span><span class="p">())</span> <span class="k">as</span> <span class="n">tr</span><span class="p">:</span>
        <span class="n">cur</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"insert into T (PK,C1) values (2,'AAA')"</span><span class="p">)</span>

    <span class="c1"># Uses distributed transaction</span>
    <span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee2'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">con2</span><span class="p">,</span>
         <span class="n">DistributedTransactionManager</span><span class="p">(</span><span class="n">con</span><span class="p">,</span> <span class="n">con2</span><span class="p">)</span> <span class="k">as</span> <span class="n">dtm</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">transaction</span><span class="p">(</span><span class="n">dtm</span><span class="p">):</span>
            <span class="n">cur1</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">cursor</span><span class="p">(</span><span class="n">con</span><span class="p">)</span>
            <span class="n">cur2</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">cursor</span><span class="p">(</span><span class="n">con2</span><span class="p">)</span>
            <span class="n">cur1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"insert into T (PK,C1) values (3,'Local')"</span><span class="p">)</span>
            <span class="n">cur2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"insert into T (PK,C1) values (3,'Remote')"</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Database Events"></a><section id="database-events">
<span id="index-32"></span><h2>Database Events<a class="headerlink" href="#database-events" title="Permalink to this heading">¶</a></h2>
<a class="dashAnchor" name="//apple_ref/cpp/Section/What they are"></a><section id="what-they-are">
<h3>What they are<a class="headerlink" href="#what-they-are" title="Permalink to this heading">¶</a></h3>
<p>The Firebird engine features a distributed, inter-process communication mechanism based on
messages called <code class="xref py py-obj docutils literal notranslate"><span class="pre">database</span> <span class="pre">events</span></code>. A database event is a message passed from a trigger or
stored procedure to an application to announce the occurrence of a specified condition or
action, usually a database change such as an insertion, modification, or deletion of a record.
The Firebird event mechanism enables applications to respond to actions and database changes
made by other, concurrently running applications without the need for those applications to
communicate directly with one another, and without incurring the expense of CPU time
required for periodic polling to determine if an event has occurred.</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Why use them"></a><section id="why-use-them">
<h3>Why use them<a class="headerlink" href="#why-use-them" title="Permalink to this heading">¶</a></h3>
<p>Anything that can be accomplished with database events can also be implemented using other
techniques, so why bother with events? Since you’ve chosen to write database-centric programs
in Python rather than assembly language, you probably already know the answer to this question,
but let’s illustrate.</p>
<p>A typical application for database events is the handling of administrative messages.
Suppose you have an administrative message database with a <code class="xref py py-obj docutils literal notranslate"><span class="pre">message's</span></code> table, into which
various applications insert timestamped status reports. It may be desirable to react to
these messages in diverse ways, depending on the status they indicate: to ignore them, to
initiate the update of dependent databases upon their arrival, to forward them by e-mail
to a remote administrator, or even to set off an alarm so that on-site administrators will
know a problem has occurred.</p>
<p>It is undesirable to tightly couple the program whose status is being reported
(the <code class="xref py py-obj docutils literal notranslate"><span class="pre">message</span> <span class="pre">producer</span></code>) to the program that handles the status reports (the <code class="xref py py-obj docutils literal notranslate"><span class="pre">message</span> <span class="pre">handler</span></code>).
There are obvious losses of flexibility in doing so. For example, the message producer may
run on a separate machine from the administrative message database and may lack access rights
to the downstream reporting facilities (e.g., network access to the SMTP server, in the case
of forwarded e-mail notifications). Additionally, the actions required to handle status
reports may themselves be time-consuming and error-prone, as in accessing a remote network
to transmit e-mail.</p>
<p>In the absence of database event support, the message handler would probably be implemented
via <code class="xref py py-obj docutils literal notranslate"><span class="pre">polling</span></code>. Polling is simply the repetition of a check for a condition at a specified
interval. In this case, the message handler would check in an infinite loop to see whether
the most recent record in the <code class="xref py py-obj docutils literal notranslate"><span class="pre">messages</span></code> table was more recent than the last message it had
handled. If so, it would handle the fresh message(s); if not, it would go to sleep for
a specified interval, then loop.</p>
<p>The <code class="xref py py-obj docutils literal notranslate"><span class="pre">polling-based</span></code> implementation of the message handler is fundamentally flawed. Polling
is a form of <a class="reference external" href="http://www.catb.org/jargon/html/B/busy-wait.html">busy-wait</a>; the check for new messages is performed at the specified interval,
regardless of the actual activity level of the message producers. If the polling interval
is lengthy, messages might not be handled within a reasonable time period after their arrival;
if the polling interval is brief, the message handler program (and there may be many such
programs) will waste a large amount of CPU time on unnecessary checks.</p>
<p>The database server is necessarily aware of the exact moment when a new message arrives.
Why not let the message handler program request that the database server send it a notification
when a new message arrives? The message handler can then efficiently sleep until the moment
its services are needed. Under this <code class="xref py py-obj docutils literal notranslate"><span class="pre">event-based</span></code> scheme, the message handler becomes
aware of new messages at the instant they arrive, yet it does not waste CPU time checking
in vain for new messages when there are none available.</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/How events are exposed"></a><section id="how-events-are-exposed">
<h3>How events are exposed<a class="headerlink" href="#how-events-are-exposed" title="Permalink to this heading">¶</a></h3>
<ol class="arabic">
<li><p>Server Process (“An event just occurred!”)</p>
<p>To notify any interested listeners that a specific event has
occurred, issue the <code class="xref py py-obj docutils literal notranslate"><span class="pre">POST_EVENT</span></code> statement from Stored Procedure
or Trigger. The <code class="xref py py-obj docutils literal notranslate"><span class="pre">POST_EVENT</span></code> statement has one parameter: the name
of the event to post. In the preceding example of the administrative
message database, <code class="xref py py-obj docutils literal notranslate"><span class="pre">POST_EVENT</span></code> might be used from an <code class="xref py py-obj docutils literal notranslate"><span class="pre">after</span> <span class="pre">insert</span></code>
trigger on the <code class="xref py py-obj docutils literal notranslate"><span class="pre">messages</span></code> table, like this:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">create</span><span class="w"> </span><span class="k">trigger</span><span class="w"> </span><span class="n">trig_messages_handle_insert</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">messages</span>
<span class="w">    </span><span class="k">after</span><span class="w"> </span><span class="k">insert</span>
<span class="k">as</span>
<span class="k">begin</span>
<span class="w">  </span><span class="n">POST_EVENT</span><span class="w"> </span><span class="s1">'new_message'</span><span class="p">;</span>
<span class="k">end</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The physical notification of the client process does not
occur until the transaction in which the <code class="xref py py-obj docutils literal notranslate"><span class="pre">POST_EVENT</span></code> took place is
actually committed. Therefore, multiple events may <em>conceptually</em>
occur before the client process is <em>physically</em> informed of even one
occurrence. Furthermore, the database engine makes no guarantee that
clients will be informed of events in the same groupings in which they
conceptually occurred. If, within a single transaction, an event named
<code class="xref py py-obj docutils literal notranslate"><span class="pre">event_a</span></code> is posted once and an event named <code class="xref py py-obj docutils literal notranslate"><span class="pre">event_b</span></code> is posted once,
the client may receive those posts in separate “batches”, despite the
fact that they occurred in the same conceptual unit (a single
transaction). This also applies to multiple occurrences of <em>the same</em>
event within a single conceptual unit: the physical notifications may
arrive at the client separately.</p>
</div>
</li>
<li><p>Client Process (“Send me a message when an event occurs.”)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you don’t care about the gory details of event notification,
skip to the section that describes FDB’s Python-level event handling
API.</p>
</div>
<p>The Firebird C client library offers two forms of event notification.
The first form is <em>synchronous</em> notification, by way of the function
<code class="xref c c-func docutils literal notranslate"><span class="pre">isc_wait_for_event()</span></code>. This form is admirably simple for a C programmer
to use, but is inappropriate as a basis for FDB’s event support,
chiefly because it’s not sophisticated enough to serve as the basis for
a comfortable Python-level API. The other form of event notification
offered by the database client library is <em>asynchronous</em>, by way of the
functions <code class="xref c c-func docutils literal notranslate"><span class="pre">isc_que_events()</span></code> (note that the name of that function
is misspelled), <code class="xref c c-func docutils literal notranslate"><span class="pre">isc_cancel_events()</span></code>, and others. The details are
as nasty as they are numerous, but the essence of using asynchronous
notification from C is as follows:</p>
<ol class="arabic simple">
<li><p>Call <code class="xref c c-func docutils literal notranslate"><span class="pre">isc_event_block()</span></code> to create a formatted binary buffer that will tell
the server which events the client wants to listen for.</p></li>
<li><p>Call <code class="xref c c-func docutils literal notranslate"><span class="pre">isc_que_events()</span></code> (passing the buffer created in the previous step) to
inform the server that the client is ready to receive event notifications, and provide
a callback that will be asynchronously invoked when one or more of the registered events occurs.</p></li>
<li><p>[The thread that called <code class="xref c c-func docutils literal notranslate"><span class="pre">isc_que_events()</span></code> to initiate event listening must
now do something else.]</p></li>
<li><p>When the callback is invoked (the database client library starts a thread dedicated
to this purpose), it can use the <code class="xref c c-func docutils literal notranslate"><span class="pre">isc_event_counts()</span></code> function to determine
how many times each of the registered events has occurred since the last call to
<code class="xref c c-func docutils literal notranslate"><span class="pre">isc_event_counts()</span></code> (if any).</p></li>
<li><p>[The callback thread should now “do its thing”, which may include communicating with
the thread that called <code class="xref c c-func docutils literal notranslate"><span class="pre">isc_que_events()</span></code>.]</p></li>
<li><p>When the callback thread is finished handling an event notification, it must call
<code class="xref c c-func docutils literal notranslate"><span class="pre">isc_que_events()</span></code> again in order to receive future notifications. Future
notifications will invoke the callback again, effectively “looping” the callback
thread back to Step 4.</p></li>
</ol>
</li>
</ol>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/API for Python developers"></a><section id="api-for-python-developers">
<h3>API for Python developers<a class="headerlink" href="#api-for-python-developers" title="Permalink to this heading">¶</a></h3>
<p>The Firebird-driver database event API is comprised of the following: the method
<a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.event_collector" title="firebird.driver.core.Connection.event_collector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection.event_collector()</span></code></a> and the class <a class="reference internal" href="ref-core.html#firebird.driver.core.EventCollector" title="firebird.driver.core.EventCollector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EventCollector</span></code></a>.</p>
<p>Use the <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection.event_collector" title="firebird.driver.core.Connection.event_collector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection.event_collector()</span></code></a> method (takes a sequence of string event
names as parameter) to create <a class="reference internal" href="ref-core.html#firebird.driver.core.EventCollector" title="firebird.driver.core.EventCollector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EventCollector</span></code></a> instance, that collects database event
notifications sent from the server for given database.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>To start listening for events it’s necessary to call <a class="reference internal" href="ref-core.html#firebird.driver.core.EventCollector.begin" title="firebird.driver.core.EventCollector.begin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EventCollector.begin()</span></code></a>
method or use EventCollector’s context manager interface.</p>
</div>
<p>Immediately when <a class="reference internal" href="ref-core.html#firebird.driver.core.EventCollector.begin" title="firebird.driver.core.EventCollector.begin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">begin()</span></code></a> method is called, EventCollector starts
to accumulate notifications of any event that occur within the collector’s internal queue
until the collector is closed either explicitly (via the <a class="reference internal" href="ref-core.html#firebird.driver.core.EventCollector.close" title="firebird.driver.core.EventCollector.close"><code class="xref py py-obj docutils literal notranslate"><span class="pre">close()</span></code></a>
method) or implicitly (via garbage collection).</p>
<p>Notifications about events are aquired through call to <a class="reference internal" href="ref-core.html#firebird.driver.core.EventCollector.wait" title="firebird.driver.core.EventCollector.wait"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wait()</span></code></a> method,
that blocks the calling thread until at least one of the events occurs, or the specified
<code class="xref py py-obj docutils literal notranslate"><span class="pre">timeout</span></code> (if any) expires, and returns <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> if the wait timed out, or a dictionary that
maps <code class="xref py py-obj docutils literal notranslate"><span class="pre">event_name</span> <span class="pre">-&gt;</span> <span class="pre">event_occurrence_count</span></code>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><a class="reference internal" href="ref-core.html#firebird.driver.core.EventCollector" title="firebird.driver.core.EventCollector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EventCollector</span></code></a> can act as context manager that ensures execution of
<a class="reference internal" href="ref-core.html#firebird.driver.core.EventCollector.begin" title="firebird.driver.core.EventCollector.begin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">begin()</span></code></a> and <a class="reference internal" href="ref-core.html#firebird.driver.core.EventCollector.close" title="firebird.driver.core.EventCollector.close"><code class="xref py py-obj docutils literal notranslate"><span class="pre">close()</span></code></a> methods.
It’s strongly advised to use the <a class="reference internal" href="ref-core.html#firebird.driver.core.EventCollector" title="firebird.driver.core.EventCollector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EventCollector</span></code></a> with the <code class="xref py py-obj docutils literal notranslate"><span class="pre">with</span></code> statement.</p>
</div>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">connection</span><span class="o">.</span><span class="n">event_collector</span><span class="p">([</span><span class="s1">'event_a'</span><span class="p">,</span> <span class="s1">'event_b'</span><span class="p">])</span> <span class="k">as</span> <span class="n">collector</span><span class="p">:</span>
    <span class="n">events</span> <span class="o">=</span> <span class="n">collector</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
    <span class="n">process_events</span><span class="p">(</span><span class="n">events</span><span class="p">)</span>
</pre></div>
</div>
<p>If you want to drop notifications accumulated so far by conduit, call
<a class="reference internal" href="ref-core.html#firebird.driver.core.EventCollector.flush" title="firebird.driver.core.EventCollector.flush"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EventCollector.flush()</span></code></a> method.</p>
<p><strong>Example program:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">create_database</span><span class="p">,</span> <span class="n">transaction</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># Prepare database</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">create_database</span><span class="p">(</span><span class="s1">'event-test'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span>
<span class="k">with</span> <span class="n">transaction</span><span class="p">(</span><span class="n">con</span><span class="p">):</span>
    <span class="n">con</span><span class="o">.</span><span class="n">execute_immediate</span><span class="p">(</span><span class="s2">"CREATE TABLE T (PK Integer, C1 Integer)"</span><span class="p">)</span>
    <span class="n">con</span><span class="o">.</span><span class="n">execute_immediate</span><span class="p">(</span><span class="s2">"""CREATE TRIGGER EVENTS_AU FOR T ACTIVE</span>
<span class="s2">    BEFORE UPDATE POSITION 0</span>
<span class="s2">    AS</span>
<span class="s2">    BEGIN</span>
<span class="s2">       if (old.C1 &lt;&gt; new.C1) then</span>
<span class="s2">          post_event 'c1_updated' ;</span>
<span class="s2">    END"""</span><span class="p">)</span>
    <span class="n">con</span><span class="o">.</span><span class="n">execute_immediate</span><span class="p">(</span><span class="s2">"""CREATE TRIGGER EVENTS_AI FOR T ACTIVE</span>
<span class="s2">    AFTER INSERT POSITION 0</span>
<span class="s2">    AS</span>
<span class="s2">    BEGIN</span>
<span class="s2">       if (new.c1 = 1) then</span>
<span class="s2">         post_event 'insert_1' ;</span>
<span class="s2">       else if (new.c1 = 2) then</span>
<span class="s2">         post_event 'insert_2' ;</span>
<span class="s2">       else if (new.c1 = 3) then</span>
<span class="s2">         post_event 'insert_3' ;</span>
<span class="s2">       else</span>
<span class="s2">         post_event 'insert_other' ;</span>
<span class="s2">    END"""</span><span class="p">)</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># Utility function</span>
<span class="k">def</span> <span class="nf">send_events</span><span class="p">(</span><span class="n">command_list</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">transaction</span><span class="p">(</span><span class="n">con</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">cmd</span> <span class="ow">in</span> <span class="n">command_list</span><span class="p">:</span>
            <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"One event"</span><span class="p">)</span>
<span class="c1">#      =========</span>
<span class="n">timed_event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span><span class="n">send_events</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">[[</span><span class="s2">"insert into T (PK,C1) values (1,1)"</span><span class="p">,]])</span>
<span class="k">with</span> <span class="n">con</span><span class="o">.</span><span class="n">event_collector</span><span class="p">([</span><span class="s1">'insert_1'</span><span class="p">])</span> <span class="k">as</span> <span class="n">events</span><span class="p">:</span>
    <span class="n">timed_event</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">events</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Multiple events"</span><span class="p">)</span>
<span class="c1">#      ===============</span>
<span class="n">cmds</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"insert into T (PK,C1) values (1,1)"</span><span class="p">,</span>
        <span class="s2">"insert into T (PK,C1) values (1,2)"</span><span class="p">,</span>
        <span class="s2">"insert into T (PK,C1) values (1,3)"</span><span class="p">,</span>
        <span class="s2">"insert into T (PK,C1) values (1,1)"</span><span class="p">,</span>
        <span class="s2">"insert into T (PK,C1) values (1,2)"</span><span class="p">,]</span>
<span class="n">timed_event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span><span class="n">send_events</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">cmds</span><span class="p">])</span>
<span class="k">with</span> <span class="n">con</span><span class="o">.</span><span class="n">event_collector</span><span class="p">([</span><span class="s1">'insert_1'</span><span class="p">,</span><span class="s1">'insert_3'</span><span class="p">])</span> <span class="k">as</span> <span class="n">events</span><span class="p">:</span>
    <span class="n">timed_event</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">events</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"20 events"</span><span class="p">)</span>
<span class="c1">#      =========</span>
<span class="n">cmds</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"insert into T (PK,C1) values (1,1)"</span><span class="p">,</span>
        <span class="s2">"insert into T (PK,C1) values (1,2)"</span><span class="p">,</span>
        <span class="s2">"insert into T (PK,C1) values (1,3)"</span><span class="p">,</span>
        <span class="s2">"insert into T (PK,C1) values (1,1)"</span><span class="p">,</span>
        <span class="s2">"insert into T (PK,C1) values (1,2)"</span><span class="p">,]</span>
<span class="n">timed_event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="n">send_events</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">cmds</span><span class="p">])</span>
<span class="k">with</span> <span class="n">con</span><span class="o">.</span><span class="n">event_collector</span><span class="p">([</span><span class="s1">'insert_1'</span><span class="p">,</span><span class="s1">'A'</span><span class="p">,</span><span class="s1">'B'</span><span class="p">,</span><span class="s1">'C'</span><span class="p">,</span><span class="s1">'D'</span><span class="p">,</span>
                          <span class="s1">'E'</span><span class="p">,</span><span class="s1">'F'</span><span class="p">,</span><span class="s1">'G'</span><span class="p">,</span><span class="s1">'H'</span><span class="p">,</span><span class="s1">'I'</span><span class="p">,</span><span class="s1">'J'</span><span class="p">,</span><span class="s1">'K'</span><span class="p">,</span><span class="s1">'L'</span><span class="p">,</span><span class="s1">'M'</span><span class="p">,</span>
                          <span class="s1">'N'</span><span class="p">,</span><span class="s1">'O'</span><span class="p">,</span><span class="s1">'P'</span><span class="p">,</span><span class="s1">'Q'</span><span class="p">,</span><span class="s1">'R'</span><span class="p">,</span><span class="s1">'insert_3'</span><span class="p">])</span> <span class="k">as</span> <span class="n">events</span><span class="p">:</span>
    <span class="n">timed_event</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">events</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Flush events"</span><span class="p">)</span>
<span class="c1">#      ============</span>
<span class="n">timed_event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span><span class="n">send_events</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">[[</span><span class="s2">"insert into T (PK,C1) values (1,1)"</span><span class="p">,]])</span>
<span class="k">with</span> <span class="n">con</span><span class="o">.</span><span class="n">event_collector</span><span class="p">([</span><span class="s1">'insert_1'</span><span class="p">])</span> <span class="k">as</span> <span class="n">events</span><span class="p">:</span>
    <span class="n">send_events</span><span class="p">([</span><span class="s2">"insert into T (PK,C1) values (1,1)"</span><span class="p">,</span>
                 <span class="s2">"insert into T (PK,C1) values (1,1)"</span><span class="p">])</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">events</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">timed_event</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">events</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<span class="c1"># Finalize</span>
<span class="n">con</span><span class="o">.</span><span class="n">drop_database</span><span class="p">()</span>
<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">One</span> <span class="n">event</span>
<span class="p">{</span><span class="s1">'insert_1'</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">Multiple</span> <span class="n">events</span>
<span class="p">{</span><span class="s1">'insert_3'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'insert_1'</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="mi">20</span> <span class="n">events</span>
<span class="p">{</span><span class="s1">'A'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'C'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'B'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'E'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'D'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'G'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'insert_1'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'I'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'H'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'K'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'J'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'M'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
 <span class="s1">'L'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'O'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'N'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'Q'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'P'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'R'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'insert_3'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'F'</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
<span class="n">Flush</span> <span class="n">events</span>
<span class="p">{</span><span class="s1">'insert_1'</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
<span class="target" id="index-33"></span></section>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Working with Services"></a><a class="dashAnchor" name="//apple_ref/cpp/Section/Working with Services"></a><section id="working-with-services">
<span id="index-34"></span><span id="id10"></span><h2>Working with Services<a class="headerlink" href="#working-with-services" title="Permalink to this heading">¶</a></h2>
<p>Database server maintenance tasks such as user management, load monitoring,
and database backup have traditionally been automated by scripting the
command-line tools <strong class="program">gbak</strong>, <strong class="program">gfix</strong>, <strong class="program">gsec</strong>, and <strong class="program">gstat</strong>.</p>
<p>The API presented to the client programmer by these utilities is inelegant
because they are, after all, command-line tools rather than native components
of the client language. To address this problem, Firebird has a facility called
the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Services</span> <span class="pre">API</span></code>, which exposes a uniform interface to the administrative
functionality of the traditional command-line tools.</p>
<p>The native Services API, though consistent, is much lower-level than a Pythonic API.
If the native version were exposed directly, accomplishing a given task would probably
require more Python code than scripting the traditional command-line tools. For this
reason, the firebird-driver presents its own abstraction over the native API.</p>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Services API Connections"></a><section id="services-api-connections">
<span id="index-35"></span><h3>Services API Connections<a class="headerlink" href="#services-api-connections" title="Permalink to this heading">¶</a></h3>
<p>All Services API operations are performed in the context of a <code class="xref py py-obj docutils literal notranslate"><span class="pre">connection</span></code> to a specific
database server, represented by the <a class="reference internal" href="ref-core.html#firebird.driver.core.Server" title="firebird.driver.core.Server"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server</span></code></a> class. Similarly to database connections,
firebird-driver provides <a class="reference internal" href="ref-core.html#firebird.driver.core.connect_server" title="firebird.driver.core.connect_server"><code class="xref py py-obj docutils literal notranslate"><span class="pre">connect_server()</span></code></a> constructor function to create such connections.</p>
<p>This constructor has one positional and several keyword parameters.</p>
<p>The value of <code class="xref py py-obj docutils literal notranslate"><span class="pre">server</span></code> positional parameter must be one of:</p>
<ul class="simple">
<li><p>name of registered server configuration</p></li>
<li><p>server host name or address</p></li>
</ul>
<p>Keyword parameters are intended to override selected configuration options, or to specify
options that are not configurable.</p>
<p>A simple server connection is typically established with code such as this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span>

<span class="c1"># Attach to 'embedded' server</span>
<span class="n">srv</span> <span class="o">=</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">''</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span>

<span class="c1"># Attach to 'local' server</span>
<span class="n">srv</span> <span class="o">=</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span>

<span class="c1"># Set 'user' and 'password' via configuration</span>
<span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">driver_config</span>
<span class="n">driver_config</span><span class="o">.</span><span class="n">server_defaults</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">'SYSDBA'</span>
<span class="n">driver_config</span><span class="o">.</span><span class="n">server_defaults</span><span class="o">.</span><span class="n">password</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">'masterkey'</span>
<span class="n">srv</span> <span class="o">=</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">)</span>
</pre></div>
</div>
<p>However, it’s recommended to use specific configuration for servers.
It’s possible to register servers directly in code like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span><span class="p">,</span> <span class="n">driver_config</span>

<span class="c1"># Register Firebird server</span>
<span class="n">srv_cfg</span> <span class="o">=</span> <span class="s2">"""[main_server]</span>
<span class="s2">host = 192.168.0.15</span>
<span class="s2">user = SYSDBA</span>
<span class="s2">password = Xyzzy</span>
<span class="s2">"""</span>
<span class="n">driver_config</span><span class="o">.</span><span class="n">register_server</span><span class="p">(</span><span class="s1">'main_server'</span><span class="p">,</span> <span class="n">srv_cfg</span><span class="p">)</span>

<span class="c1"># Attach to 'main' server</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'main_server'</span><span class="p">)</span>
</pre></div>
</div>
<p>But more convenient approach is using single configuration file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># file: myapp.cfg</span>

<span class="p">[</span><span class="n">firebird</span><span class="o">.</span><span class="n">driver</span><span class="p">]</span>
<span class="n">servers</span> <span class="o">=</span> <span class="n">main_server</span>
<span class="n">databases</span> <span class="o">=</span> <span class="n">employee</span>

<span class="p">[</span><span class="n">main_server</span><span class="p">]</span>
<span class="n">host</span> <span class="o">=</span> <span class="mf">192.168.0.15</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">SYSDBA</span>
<span class="n">password</span> <span class="o">=</span> <span class="n">Xyzzy</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span><span class="p">,</span> <span class="n">driver_config</span>

<span class="n">driver_config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">'myapp.cfg'</span><span class="p">)</span>

<span class="c1"># Attach to 'main' server</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'main_server'</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Like database connections, it’s important to properly <code class="xref py py-obj docutils literal notranslate"><span class="pre">close()</span></code> them
when you don’t need them anymore.</p>
</div>
<p><a class="reference internal" href="ref-core.html#firebird.driver.core.Server" title="firebird.driver.core.Server"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server</span></code></a> object provides main infrastructure for communication with Firebird server services,
and manages number of objects that provide actual server services:</p>
<ul class="simple">
<li><p>The <a class="reference internal" href="ref-core.html#firebird.driver.core.Server.info" title="firebird.driver.core.Server.info"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server.info</span></code></a> property object provides <a class="reference internal" href="#server-configuration-and-state-information">Server Configuration and State information</a>.</p></li>
<li><p>The <a class="reference internal" href="ref-core.html#firebird.driver.core.Server.database" title="firebird.driver.core.Server.database"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server.database</span></code></a> property object provides <a class="reference internal" href="#database-options">Database options</a> and <a class="reference internal" href="#database-maintenance">Database maintenance</a>.</p></li>
<li><p>The <a class="reference internal" href="ref-core.html#firebird.driver.core.Server.user" title="firebird.driver.core.Server.user"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server.user</span></code></a> property object provides <a class="reference internal" href="#user-maintenance">User maintenance</a>.</p></li>
<li><p>The <a class="reference internal" href="ref-core.html#firebird.driver.core.Server.trace" title="firebird.driver.core.Server.trace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server.trace</span></code></a> property object provides management of <a class="reference internal" href="#trace-sessions">Trace sessions</a>.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="ref-core.html#firebird.driver.core.connect_server" title="firebird.driver.core.connect_server"><code class="xref py py-obj docutils literal notranslate"><span class="pre">connect_server()</span></code></a> and <a class="reference internal" href="ref-core.html#firebird.driver.core.Server" title="firebird.driver.core.Server"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server</span></code></a> for details.</p>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Text output from Services"></a><section id="text-output-from-services">
<span id="index-36"></span><h3>Text output from Services<a class="headerlink" href="#text-output-from-services" title="Permalink to this heading">¶</a></h3>
<p>Some services like <code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerDbServices.backup()</span></code> may return significant amount of text.
Rather than return the whole text as single string value by methods that provide access
to these services, firebird-driver isolated the transfer process to separate methods:</p>
<ul class="simple">
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Server.readline" title="firebird.driver.core.Server.readline"><code class="xref py py-obj docutils literal notranslate"><span class="pre">readline()</span></code></a> - Similar to <code class="xref py py-obj docutils literal notranslate"><span class="pre">file.readline</span></code>, returns next line of output from Service.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Server.readline_timed" title="firebird.driver.core.Server.readline_timed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">readline_timed()</span></code></a> - Like <a class="reference internal" href="ref-core.html#firebird.driver.core.Server.readline" title="firebird.driver.core.Server.readline"><code class="xref py py-obj docutils literal notranslate"><span class="pre">readline()</span></code></a> but with timeout.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Server.readlines" title="firebird.driver.core.Server.readlines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">readlines()</span></code></a> - Like <code class="xref py py-obj docutils literal notranslate"><span class="pre">file.readlines</span></code>, returns list of output lines.</p></li>
<li><p>Iteration over <a class="reference internal" href="ref-core.html#firebird.driver.core.Server" title="firebird.driver.core.Server"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server</span></code></a> object, because <a class="reference internal" href="ref-core.html#firebird.driver.core.Server" title="firebird.driver.core.Server"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server</span></code></a> has built-in support for <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#typeiter" title="(in Python v3.11)"><span class="xref std std-ref">iterator protocol</span></a>.</p></li>
<li><p>Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">callback</span></code> method provided by developer. Each <a class="reference internal" href="ref-core.html#firebird.driver.core.Server" title="firebird.driver.core.Server"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server</span></code></a> method that returns its result
asynchronously accepts an optional parameter <code class="xref py py-obj docutils literal notranslate"><span class="pre">callback</span></code>, which must be a function that accepts
one string parameter. This method is then called with each output line coming from service.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Server.wait" title="firebird.driver.core.Server.wait"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wait()</span></code></a> - Waits for Sevice to finish, ignoring rest of the output it may produce.</p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The Firebird server sends text output from services as packets, that could have two forms.
The method for packet construction used for text transfer is controlled by <a class="reference internal" href="ref-core.html#firebird.driver.core.Server.mode" title="firebird.driver.core.Server.mode"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server.mode</span></code></a>
attribute with next possible values:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="ref-types.html#firebird.driver.types.SrvInfoCode.LINE" title="firebird.driver.types.SrvInfoCode.LINE"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SrvInfoCode.LINE</span></code></a> : A single line of text.</p></li>
<li><p><a class="reference internal" href="ref-types.html#firebird.driver.types.SrvInfoCode.TO_EOF" title="firebird.driver.types.SrvInfoCode.TO_EOF"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SrvInfoCode.TO_EOF</span></code></a> : A block of text up to specified (buffer) size.</p></li>
</ol>
<p>Both methods have specific pros and cons:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="ref-types.html#firebird.driver.types.SrvInfoCode.LINE" title="firebird.driver.types.SrvInfoCode.LINE"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LINE</span></code></a> means more roundtrips and thus slower transfer of service output,
but each line is sent to client immediately when it’s available.</p></li>
<li><p><a class="reference internal" href="ref-types.html#firebird.driver.types.SrvInfoCode.TO_EOF" title="firebird.driver.types.SrvInfoCode.TO_EOF"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TO_EOF</span></code></a> means fewer roundtrips so large output is transferred quickly,
but service output is not sent until the transfer buffer is not full, or service stops.</p></li>
</ol>
<p><strong>The default mode is</strong> <a class="reference internal" href="ref-types.html#firebird.driver.types.SrvInfoCode.TO_EOF" title="firebird.driver.types.SrvInfoCode.TO_EOF"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TO_EOF</span></code></a> <strong>with 64K buffer.</strong></p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Until output is not fully fetched from service, any attempt to start another asynchronous
service will fail with exception! This constraint is set by Firebird Service API.</p>
<p>You may check the status of asynchronous Services using <a class="reference internal" href="ref-core.html#firebird.driver.core.Server.is_running" title="firebird.driver.core.Server.is_running"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server.is_running()</span></code></a> method.</p>
<p>In cases when you’re not interested in output produced by Service, call <a class="reference internal" href="ref-core.html#firebird.driver.core.Server.wait" title="firebird.driver.core.Server.wait"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wait()</span></code></a>
to wait for service to complete.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Normally, requesting output with <a class="reference internal" href="ref-core.html#firebird.driver.core.Server.readline" title="firebird.driver.core.Server.readline"><code class="xref py py-obj docutils literal notranslate"><span class="pre">readline()</span></code></a> blocks until any output is
available from server. Bacuse this method is used by iteration over <a class="reference internal" href="ref-core.html#firebird.driver.core.Server" title="firebird.driver.core.Server"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server</span></code></a> and
<a class="reference internal" href="ref-core.html#firebird.driver.core.Server.readlines" title="firebird.driver.core.Server.readlines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">readlines()</span></code></a> method, they will block as well. Most services produce output
continuously and without (much) delay, so this is usually not a problem. However, some
services (eg trace) can produce output at significantly slower intervals (if at all),
which complicates the creation of responsive applications. In this case, it is necessary
to use the <a class="reference internal" href="ref-core.html#firebird.driver.core.Server.readline_timed" title="firebird.driver.core.Server.readline_timed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">readline_timed()</span></code></a> method, which allows you to limit the waiting
time for the output.</p>
</div>
<p><strong>Examples:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span>
<span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Fetch materialized"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"=================="</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Start backup"</span><span class="p">)</span>
    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">backup</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">backup</span><span class="o">=</span><span class="s1">'employee.fbk'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"srv.running is"</span><span class="p">,</span> <span class="n">srv</span><span class="o">.</span><span class="n">isrunning</span><span class="p">())</span>
    <span class="n">report</span> <span class="o">=</span> <span class="n">srv</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">report</span><span class="p">)</span><span class="si">}</span><span class="s2"> lines returned"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"First 5 lines from output:"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">report</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"srv.running is"</span><span class="p">,</span> <span class="n">srv</span><span class="o">.</span><span class="n">isrunning</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Iterate over result"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"==================="</span><span class="p">)</span>
    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">backup</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">backup</span><span class="o">=</span><span class="s1">'employee.fbk'</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">srv</span><span class="p">:</span>
        <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">)</span><span class="si">}</span><span class="s2"> lines returned"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Last 5 lines from output:"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">output</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Callback"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"========"</span><span class="p">)</span>

    <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Callback function</span>
    <span class="k">def</span> <span class="nf">fetchline</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
        <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">backup</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">backup</span><span class="o">=</span><span class="s1">'employee.fbk'</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">fetchline</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">)</span><span class="si">}</span><span class="s2"> lines returned"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Last 5 lines from output:"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">output</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Fetch</span> <span class="n">materialized</span>
<span class="o">==================</span>
<span class="n">Start</span> <span class="n">backup</span>
<span class="n">svc</span><span class="o">.</span><span class="n">running</span> <span class="ow">is</span> <span class="kc">True</span>
<span class="mi">558</span> <span class="n">lines</span> <span class="n">returned</span>
<span class="n">First</span> <span class="mi">5</span> <span class="n">lines</span> <span class="kn">from</span> <span class="nn">output</span><span class="p">:</span>
<span class="mi">0</span> <span class="n">gbak</span><span class="p">:</span><span class="n">readied</span> <span class="n">database</span> <span class="n">employee</span> <span class="k">for</span> <span class="n">backup</span>
<span class="mi">1</span> <span class="n">gbak</span><span class="p">:</span><span class="n">creating</span> <span class="n">file</span> <span class="n">employee</span><span class="o">.</span><span class="n">fbk</span>
<span class="mi">2</span> <span class="n">gbak</span><span class="p">:</span><span class="n">starting</span> <span class="n">transaction</span>
<span class="mi">3</span> <span class="n">gbak</span><span class="p">:</span><span class="n">database</span> <span class="n">employee</span> <span class="n">has</span> <span class="n">a</span> <span class="n">page</span> <span class="n">size</span> <span class="n">of</span> <span class="mi">4096</span> <span class="nb">bytes</span><span class="o">.</span>
<span class="mi">4</span> <span class="n">gbak</span><span class="p">:</span><span class="n">writing</span> <span class="n">domains</span>
<span class="n">svc</span><span class="o">.</span><span class="n">running</span> <span class="ow">is</span> <span class="kc">False</span>

<span class="n">Iterate</span> <span class="n">over</span> <span class="n">result</span>
<span class="o">===================</span>
<span class="mi">558</span> <span class="n">lines</span> <span class="n">returned</span>
<span class="n">Last</span> <span class="mi">5</span> <span class="n">lines</span> <span class="kn">from</span> <span class="nn">output</span><span class="p">:</span>
<span class="n">gbak</span><span class="p">:</span><span class="n">writing</span> <span class="n">referential</span> <span class="n">constraints</span>
<span class="n">gbak</span><span class="p">:</span><span class="n">writing</span> <span class="n">check</span> <span class="n">constraints</span>
<span class="n">gbak</span><span class="p">:</span><span class="n">writing</span> <span class="n">SQL</span> <span class="n">roles</span>
<span class="n">gbak</span><span class="p">:</span><span class="n">writing</span> <span class="n">names</span> <span class="n">mapping</span>
<span class="n">gbak</span><span class="p">:</span><span class="n">closing</span> <span class="n">file</span><span class="p">,</span> <span class="n">committing</span><span class="p">,</span> <span class="ow">and</span> <span class="n">finishing</span><span class="o">.</span> <span class="mi">74752</span> <span class="nb">bytes</span> <span class="n">written</span>

<span class="n">Callback</span>
<span class="o">========</span>
<span class="mi">558</span> <span class="n">lines</span> <span class="n">returned</span>
<span class="n">Last</span> <span class="mi">5</span> <span class="n">lines</span> <span class="kn">from</span> <span class="nn">output</span><span class="p">:</span>
<span class="n">gbak</span><span class="p">:</span><span class="n">writing</span> <span class="n">referential</span> <span class="n">constraints</span>
<span class="n">gbak</span><span class="p">:</span><span class="n">writing</span> <span class="n">check</span> <span class="n">constraints</span>
<span class="n">gbak</span><span class="p">:</span><span class="n">writing</span> <span class="n">SQL</span> <span class="n">roles</span>
<span class="n">gbak</span><span class="p">:</span><span class="n">writing</span> <span class="n">names</span> <span class="n">mapping</span>
<span class="n">gbak</span><span class="p">:</span><span class="n">closing</span> <span class="n">file</span><span class="p">,</span> <span class="n">committing</span><span class="p">,</span> <span class="ow">and</span> <span class="n">finishing</span><span class="o">.</span> <span class="mi">74752</span> <span class="nb">bytes</span> <span class="n">written</span>
</pre></div>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Server Configuration and State information"></a><section id="server-configuration-and-state-information">
<span id="index-37"></span><h3>Server Configuration and State information<a class="headerlink" href="#server-configuration-and-state-information" title="Permalink to this heading">¶</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Because the scope and type of service information depends on the version of the Firebird
server, this information is made available through a separate class
<a class="reference internal" href="ref-core.html#firebird.driver.core.ServerInfoProvider" title="firebird.driver.core.ServerInfoProvider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerInfoProvider</span></code></a>. The <a class="reference internal" href="ref-core.html#firebird.driver.core.Server.info" title="firebird.driver.core.Server.info"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server.info</span></code></a> property provides access to
instance of <a class="reference internal" href="ref-core.html#firebird.driver.core.ServerInfoProvider" title="firebird.driver.core.ServerInfoProvider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerInfoProvider</span></code></a> or it’s <strong>ancestor</strong> class according to attached
Firebird server version.</p>
</div>
<p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerInfoProvider" title="firebird.driver.core.ServerInfoProvider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerInfoProvider</span></code></a> methods and properties:</p>
<ul>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerInfoProvider.get_log" title="firebird.driver.core.ServerInfoProvider.get_log"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log()</span></code></a> - Request the contents of the server’s log file (<code class="file docutils literal notranslate"><span class="pre">firebird.log</span></code>).</p>
<p>This method is so-called <code class="xref py py-obj docutils literal notranslate"><span class="pre">Async</span> <span class="pre">service</span></code> that only initiates log transfer. Actual log
content could be read by one from many methods for <a class="reference internal" href="#text-output-from-services">text output from Services</a> that
<a class="reference internal" href="ref-core.html#firebird.driver.core.Server" title="firebird.driver.core.Server"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server</span></code></a> provides .</p>
</li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerInfoProvider.version" title="firebird.driver.core.ServerInfoProvider.version"><code class="xref py py-obj docutils literal notranslate"><span class="pre">version</span></code></a> - Returns Firebird server version as SEMVER string.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerInfoProvider.engine_version" title="firebird.driver.core.ServerInfoProvider.engine_version"><code class="xref py py-obj docutils literal notranslate"><span class="pre">engine_version</span></code></a> - Firebird server version as &lt;major&gt;.&lt;minor&gt; float value.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerInfoProvider.manager_version" title="firebird.driver.core.ServerInfoProvider.manager_version"><code class="xref py py-obj docutils literal notranslate"><span class="pre">manager_version</span></code></a> - Firebird service manager version.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerInfoProvider.architecture" title="firebird.driver.core.ServerInfoProvider.architecture"><code class="xref py py-obj docutils literal notranslate"><span class="pre">architecture</span></code></a> - Firebird server implementation description.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerInfoProvider.home_directory" title="firebird.driver.core.ServerInfoProvider.home_directory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">home_directory</span></code></a> - Firebird server home directory.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerInfoProvider.security_database" title="firebird.driver.core.ServerInfoProvider.security_database"><code class="xref py py-obj docutils literal notranslate"><span class="pre">security_database</span></code></a> - Security database.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerInfoProvider.lock_directory" title="firebird.driver.core.ServerInfoProvider.lock_directory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lock_directory</span></code></a> - Directory with lock file(s).</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerInfoProvider.message_directory" title="firebird.driver.core.ServerInfoProvider.message_directory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">message_directory</span></code></a> - Directory with message file(s).</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerInfoProvider.capabilities" title="firebird.driver.core.ServerInfoProvider.capabilities"><code class="xref py py-obj docutils literal notranslate"><span class="pre">capabilities</span></code></a> - Firebird server capabilities (as <a class="reference internal" href="ref-types.html#firebird.driver.types.ServerCapability" title="firebird.driver.types.ServerCapability"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerCapability</span></code></a> flags).</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerInfoProvider.connection_count" title="firebird.driver.core.ServerInfoProvider.connection_count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">connection_count</span></code></a> - Current number of database attachments.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerInfoProvider.attached_databases" title="firebird.driver.core.ServerInfoProvider.attached_databases"><code class="xref py py-obj docutils literal notranslate"><span class="pre">attached_databases</span></code></a> - List of attached databases.</p></li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">driver_config</span><span class="p">,</span> <span class="n">connect</span><span class="p">,</span> <span class="n">connect_server</span>

<span class="n">srv_cfg</span> <span class="o">=</span> <span class="s2">"""[local]</span>
<span class="s2">host = localhost</span>
<span class="s2">user = SYSDBA</span>
<span class="s2">password = masterkey</span>
<span class="s2">"""</span>
<span class="n">driver_config</span><span class="o">.</span><span class="n">register_server</span><span class="p">(</span><span class="s1">'local'</span><span class="p">,</span> <span class="n">srv_cfg</span><span class="p">)</span>
<span class="n">db_cfg</span> <span class="o">=</span> <span class="s2">"""[employee]</span>
<span class="s2">server = local</span>
<span class="s2">database = employee.fdb</span>
<span class="s2">protocol = inet</span>
<span class="s2">"""</span>
<span class="n">driver_config</span><span class="o">.</span><span class="n">register_database</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">db_cfg</span><span class="p">)</span>
<span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">),</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'local'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">version</span><span class="si">=}</span><span class="s1">'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">engine_version</span><span class="si">=}</span><span class="s1">'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">manager_version</span><span class="si">=}</span><span class="s1">'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">architecture</span><span class="si">=}</span><span class="s1">'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">home_directory</span><span class="si">=}</span><span class="s1">'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">security_database</span><span class="si">=}</span><span class="s1">'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">lock_directory</span><span class="si">=}</span><span class="s1">'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">message_directory</span><span class="si">=}</span><span class="s1">'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">capabilities</span><span class="si">=!s}</span><span class="s1">'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">connection_count</span><span class="si">=}</span><span class="s1">'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">attached_databases</span><span class="si">=}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>
</div>
<p>Sample output for 64-bit Linux Firebird 4.0 Beta 2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">version</span><span class="o">=</span><span class="s1">'4.0.0.1963'</span>
<span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">engine_version</span><span class="o">=</span><span class="mf">4.0</span>
<span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">manager_version</span><span class="o">=</span><span class="mi">2</span>
<span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">architecture</span><span class="o">=</span><span class="s1">'Firebird/Linux/AMD/Intel/x64'</span>
<span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">home_directory</span><span class="o">=</span><span class="s1">'/opt/firebird/'</span>
<span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">security_database</span><span class="o">=</span><span class="s1">'/opt/firebird/security4.fdb'</span>
<span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">lock_directory</span><span class="o">=</span><span class="s1">'/tmp/firebird/'</span>
<span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">message_directory</span><span class="o">=</span><span class="s1">'/opt/firebird/'</span>
<span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">capabilities</span><span class="o">=</span><span class="n">ServerCapability</span><span class="o">.</span><span class="n">REMOTE_HOP</span><span class="o">|</span><span class="n">MULTI_CLIENT</span>
<span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">connection_count</span><span class="o">=</span><span class="mi">1</span>
<span class="n">srv</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">attached_databases</span><span class="o">=</span><span class="p">[</span><span class="s1">'/opt/firebird/examples/empbuild/employee.fdb'</span><span class="p">]</span>
</pre></div>
</div>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Database options"></a><section id="database-options">
<span id="index-38"></span><h3>Database options<a class="headerlink" href="#database-options" title="Permalink to this heading">¶</a></h3>
<p>Database options could be set using <a class="reference internal" href="ref-core.html#firebird.driver.core.ServerDbServices" title="firebird.driver.core.ServerDbServices"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerDbServices</span></code></a> instance accessible via
<a class="reference internal" href="ref-core.html#firebird.driver.core.Server.database" title="firebird.driver.core.Server.database"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server.database</span></code></a> property.</p>
<ul>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_default_cache_size()</span></code> - Sets individual page cache size for database.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">set_default_cache_size</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">'employee.fdb'</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_sweep_interval()</span></code> - Sets database sweep interval.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">set_sweep_interval</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">'employee.fdb'</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_space_reservation()</span></code> - Sets space reservation option for database.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span><span class="p">,</span> <span class="n">DbSpaceReservation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">set_space_reservation</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">'employee.fdb'</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">DbSpaceReservation</span><span class="o">.</span><span class="n">USE_FULL</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_write_mode()</span></code> - Sets database write mode (SYNC/ASYNC).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span><span class="p">,</span> <span class="n">DbWriteMode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">set_write_mode</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">'employee.fdb'</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">DbWriteMode</span><span class="o">.</span><span class="n">ASYNC</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_access_mode()</span></code> - Sets database access mode (R/W or R/O).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span><span class="p">,</span> <span class="n">DbAccessMode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">set_access_mode</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">'employee.fdb'</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">DbAccessMode</span><span class="o">.</span><span class="n">READ_ONLY</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_sql_dialect()</span></code> - Sets database SQL dialect.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Changing SQL dialect on existing database is not recommended. Only newly created
database objects would respect new dialect setting, while objects created with
previous dialect remain unchanged. That may have dire consequences.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">set_sql_dialect</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">'employee.fdb'</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">no_linger()</span></code> - Sets one-off override for database linger.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">no_linger</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">'employee.fdb'</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Database maintenance"></a><section id="database-maintenance">
<span id="index-39"></span><h3>Database maintenance<a class="headerlink" href="#database-maintenance" title="Permalink to this heading">¶</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Because available database-related actions depends on the version of the Firebird
server, they are made available through a separate class <a class="reference internal" href="ref-core.html#firebird.driver.core.ServerDbServices" title="firebird.driver.core.ServerDbServices"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerDbServices</span></code></a>.
The <a class="reference internal" href="ref-core.html#firebird.driver.core.Server.database" title="firebird.driver.core.Server.database"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server.database</span></code></a> property provides access to instance of <a class="reference internal" href="ref-core.html#firebird.driver.core.ServerDbServices" title="firebird.driver.core.ServerDbServices"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerDbServices</span></code></a> or
it’s <strong>ancestor</strong> class according to attached Firebird server version.</p>
</div>
<ul>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerDbServices3.get_statistics" title="firebird.driver.core.ServerDbServices3.get_statistics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_statistics()</span></code></a> - Returns database statistics produced by gstat
utility.</p>
<p>This method is so-called <code class="xref py py-obj docutils literal notranslate"><span class="pre">Async</span> <span class="pre">service</span></code> that only initiates report processing. Actual
report content could be read by one from many methods for <a class="reference internal" href="#text-output-from-services">text output from Services</a> that
<a class="reference internal" href="ref-core.html#firebird.driver.core.Server" title="firebird.driver.core.Server"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server</span></code></a> provides .</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span><span class="p">,</span> <span class="n">SrvStatFlag</span>
<span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">get_statistics</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">'employee.fdb'</span><span class="p">,</span>
                                <span class="n">flags</span><span class="o">=</span><span class="n">SrvStatFlag</span><span class="o">.</span><span class="n">DATA_PAGES</span> <span class="o">|</span> <span class="n">SrvStatFlag</span><span class="o">.</span><span class="n">RECORD_VERSIONS</span><span class="p">),</span>
                                <span class="n">tables</span><span class="o">=</span><span class="p">[</span><span class="s1">'EMPLOYEE'</span><span class="p">,</span><span class="s1">'PROJECT'</span><span class="p">])</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="n">srv</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerDbServices3.backup" title="firebird.driver.core.ServerDbServices3.backup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">backup()</span></code></a> - Performs logical (GBAK) database backup.</p>
<p>This method is so-called <code class="xref py py-obj docutils literal notranslate"><span class="pre">Async</span> <span class="pre">service</span></code> that only initiates the backup process. Output
from gbak could be read by one from many methods for <a class="reference internal" href="#text-output-from-services">text output from Services</a> that
<a class="reference internal" href="ref-core.html#firebird.driver.core.Server" title="firebird.driver.core.Server"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server</span></code></a> provides .</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span><span class="p">,</span> <span class="n">SrvBackupFlag</span>
<span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">backup</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">'employee.fdb'</span><span class="p">,</span>
                        <span class="n">backup</span><span class="o">=</span><span class="s1">'/backup/employee.fbk'</span><span class="p">,</span>
                        <span class="n">flags</span><span class="o">=</span><span class="n">SrvBackupFlag</span><span class="o">.</span><span class="n">IGNORE_CHECKSUMS</span> <span class="o">|</span> <span class="n">SrvBackupFlag</span><span class="o">.</span><span class="n">NO_GARBAGE_COLLECT</span><span class="p">,</span>
                        <span class="n">stats</span><span class="o">=</span><span class="s1">'TD'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">report</span> <span class="o">=</span> <span class="n">srv</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerDbServices3.local_backup" title="firebird.driver.core.ServerDbServices3.local_backup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">local_backup()</span></code></a> - Performs logical (GBAK) database backup into local byte
stream.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span><span class="p">,</span> <span class="n">SrvBackupFlag</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'/backup/employee.fbk'</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">'wb'</span><span class="p">)</span>
<span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">local_backup</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">'employee.fdb'</span><span class="p">,</span> <span class="n">backup_stream</span><span class="o">=</span><span class="n">f</span><span class="p">,</span>
                              <span class="n">flags</span><span class="o">=</span><span class="n">SrvBackupFlag</span><span class="o">.</span><span class="n">IGNORE_CHECKSUMS</span> <span class="o">|</span> <span class="n">SrvBackupFlag</span><span class="o">.</span><span class="n">NO_GARBAGE_COLLECT</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerDbServices3.restore" title="firebird.driver.core.ServerDbServices3.restore"><code class="xref py py-obj docutils literal notranslate"><span class="pre">restore()</span></code></a> - Performs database restore from logical (GBAK) backup.</p>
<p>This method is so-called <code class="xref py py-obj docutils literal notranslate"><span class="pre">Async</span> <span class="pre">service</span></code> that only initiates the restore process. Output
from gbak could be read by one from many methods for <a class="reference internal" href="#text-output-from-services">text output from Services</a> that
<a class="reference internal" href="ref-core.html#firebird.driver.core.Server" title="firebird.driver.core.Server"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server</span></code></a> provides .</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span><span class="p">,</span> <span class="n">SrvRestoreFlag</span>
<span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">restore</span><span class="p">(</span><span class="n">backup</span><span class="o">=</span><span class="s1">'/backup/employee.fbk'</span><span class="p">,</span>
                         <span class="n">database</span><span class="o">=</span><span class="s1">'/data/employee.fdb'</span><span class="p">,</span>
                         <span class="n">flags</span><span class="o">=</span><span class="n">SrvRestoreFlag</span><span class="o">.</span><span class="n">REPLACE</span><span class="p">,</span>
                         <span class="n">stats</span><span class="o">=</span><span class="s1">'TD'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">page_size</span><span class="o">=</span><span class="mi">8192</span><span class="p">)</span>
    <span class="n">report</span> <span class="o">=</span> <span class="n">srv</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerDbServices3.local_restore" title="firebird.driver.core.ServerDbServices3.local_restore"><code class="xref py py-obj docutils literal notranslate"><span class="pre">local_restore()</span></code></a> - Performs database restore from logical (GBAK) backup
stored in local byte stream.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span><span class="p">,</span> <span class="n">SrvRestoreFlag</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'/backup/employee.fbk'</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">'rb'</span><span class="p">)</span>
<span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">local_restore</span><span class="p">(</span><span class="n">backup_stream</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s1">'/data/employee.fdb'</span><span class="p">,</span>
                               <span class="n">flags</span><span class="o">=</span><span class="n">SrvRestoreFlag</span><span class="o">.</span><span class="n">REPLACE</span><span class="p">,</span> <span class="n">page_size</span><span class="o">=</span><span class="mi">8192</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerDbServices3.nbackup" title="firebird.driver.core.ServerDbServices3.nbackup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nbackup()</span></code></a> - Performs physical (NBACKUP) database backup.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span>
<span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">nbackup</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">'employee.fdb'</span><span class="p">,</span> <span class="n">backup</span><span class="o">=</span><span class="s1">'/backup/employee.bkp1'</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerDbServices3.nrestore" title="firebird.driver.core.ServerDbServices3.nrestore"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nrestore()</span></code></a> - Performs restore from physical (NBACKUP) database
backup.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span>
<span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">nrestore</span><span class="p">(</span><span class="n">backups</span><span class="o">=</span><span class="p">[</span><span class="s1">'/backup/employee.bkp0'</span><span class="p">,</span> <span class="s1">'/backup/employee.bkp1'</span><span class="p">],</span>
                          <span class="n">database</span><span class="o">=</span><span class="s1">'/data/employee.fdb'</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerDbServices3.shutdown" title="firebird.driver.core.ServerDbServices3.shutdown"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shutdown()</span></code></a> - Database shutdown.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span><span class="p">,</span> <span class="n">ShutdownMode</span><span class="p">,</span> <span class="n">ShutdownMethod</span>
<span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">'employee.fdb'</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">ShutdownMode</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">,</span>
                          <span class="n">method</span><span class="o">=</span><span class="n">ShutdownMethod</span><span class="o">.</span><span class="n">FORCED</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerDbServices3.bring_online" title="firebird.driver.core.ServerDbServices3.bring_online"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bring_online()</span></code></a> - Bring previously shut down database back online.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span><span class="p">,</span> <span class="n">OnlineMode</span>
<span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">bring_online</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">'employee.fdb'</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">OnlineMode</span><span class="o">.</span><span class="n">MULTI</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerDbServices3.sweep" title="firebird.driver.core.ServerDbServices3.sweep"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sweep()</span></code></a> - Performs database sweep operation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span>
<span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">sweep</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">'employee.fdb'</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerDbServices3.validate" title="firebird.driver.core.ServerDbServices3.validate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">validate()</span></code></a> - Performs database validation.</p>
<p>This method is so-called <code class="xref py py-obj docutils literal notranslate"><span class="pre">Async</span> <span class="pre">service</span></code> that only initiates the validation process. Output
from validation could be read by one from many methods for <a class="reference internal" href="#text-output-from-services">text output from Services</a> that
<a class="reference internal" href="ref-core.html#firebird.driver.core.Server" title="firebird.driver.core.Server"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server</span></code></a> provides .</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span>
<span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">'employee.fdb'</span><span class="p">)</span>
    <span class="n">report</span> <span class="o">=</span> <span class="n">srv</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerDbServices3.repair" title="firebird.driver.core.ServerDbServices3.repair"><code class="xref py py-obj docutils literal notranslate"><span class="pre">repair()</span></code></a> - Performs database repair operation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span><span class="p">,</span> <span class="n">SrvRepairFlag</span>
<span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
    <span class="n">srv</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">repair</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s1">'employee.fdb'</span><span class="p">,</span>
                        <span class="n">flags</span><span class="o">=</span><span class="n">SrvRepairFlag</span><span class="o">.</span><span class="n">REPAIR</span> <span class="o">|</span> <span class="n">SrvRepairFlag</span><span class="o">.</span><span class="n">KILL_SHADOWS</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerDbServices3.get_limbo_transaction_ids" title="firebird.driver.core.ServerDbServices3.get_limbo_transaction_ids"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_limbo_transaction_ids()</span></code></a> - Returns list of transactions in limbo.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerDbServices3.commit_limbo_transaction" title="firebird.driver.core.ServerDbServices3.commit_limbo_transaction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">commit_limbo_transaction()</span></code></a> - Resolves limbo transaction with commit.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerDbServices3.rollback_limbo_transaction" title="firebird.driver.core.ServerDbServices3.rollback_limbo_transaction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rollback_limbo_transaction()</span></code></a> - Resolves limbo transaction with rollback.</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nfix_database</span></code> - Fixup database after filesystem copy.</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_replica_mode</span></code> - Manage replica database.</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/User maintenance"></a><section id="user-maintenance">
<span id="index-40"></span><h3>User maintenance<a class="headerlink" href="#user-maintenance" title="Permalink to this heading">¶</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Because user maintenance functionality may depend on the version of the Firebird
server, this functionality is made available through a separate class
<a class="reference internal" href="ref-core.html#firebird.driver.core.ServerUserServices" title="firebird.driver.core.ServerUserServices"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerUserServices</span></code></a>. The <a class="reference internal" href="ref-core.html#firebird.driver.core.Server.user" title="firebird.driver.core.Server.user"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server.user</span></code></a> property provides access to
instance of <a class="reference internal" href="ref-core.html#firebird.driver.core.ServerUserServices" title="firebird.driver.core.ServerUserServices"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerUserServices</span></code></a> or it’s <strong>ancestor</strong> class according to attached
Firebird server version.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Since Firebird 2.5 you can use SQL commands (CREATE/ALTER/DROP USER) to manage users in
a security database from a regular database attachment.</p>
<p>The SQL set of DDL commands for managing user accounts has been further enhanced in Firebird 3,
thus improving the DDL capabilities in a way that exceeds capabilities of user management services.</p>
</div>
<ul class="simple">
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerUserServices.get_all" title="firebird.driver.core.ServerUserServices.get_all"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all()</span></code></a> - Returns information about all users.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerUserServices.get" title="firebird.driver.core.ServerUserServices.get"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get()</span></code></a> - Returns information about specified users.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerUserServices.add" title="firebird.driver.core.ServerUserServices.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add()</span></code></a> - Add new user.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerUserServices.update" title="firebird.driver.core.ServerUserServices.update"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update()</span></code></a> - Update user information.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerUserServices.delete" title="firebird.driver.core.ServerUserServices.delete"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delete()</span></code></a> - Delete user.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerUserServices.exists" title="firebird.driver.core.ServerUserServices.exists"><code class="xref py py-obj docutils literal notranslate"><span class="pre">exists()</span></code></a> - Returns True if user exists.</p></li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Trace sessions"></a><section id="trace-sessions">
<span id="index-41"></span><h3>Trace sessions<a class="headerlink" href="#trace-sessions" title="Permalink to this heading">¶</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Because trace functionality may depend on the version of the Firebird server, this
functionality is made available through a separate class <a class="reference internal" href="ref-core.html#firebird.driver.core.ServerTraceServices" title="firebird.driver.core.ServerTraceServices"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerTraceServices</span></code></a>.
The <a class="reference internal" href="ref-core.html#firebird.driver.core.Server.trace" title="firebird.driver.core.Server.trace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server.trace</span></code></a> property provides access to instance of <a class="reference internal" href="ref-core.html#firebird.driver.core.ServerTraceServices" title="firebird.driver.core.ServerTraceServices"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerTraceServices</span></code></a> or
its <strong>ancestor</strong> class according to attached Firebird server version.</p>
</div>
<ul>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerTraceServices.start" title="firebird.driver.core.ServerTraceServices.start"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerTraceServices.start()</span></code></a> - Start new trace session. Requires trace <code class="xref py py-obj docutils literal notranslate"><span class="pre">configuration</span></code> and returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">Session</span> <span class="pre">ID</span></code>.</p>
<p>This method is so-called <code class="xref py py-obj docutils literal notranslate"><span class="pre">Async</span> <span class="pre">service</span></code> that only starts the trace session. Output
from trace session could be read by one from many methods for <a class="reference internal" href="#text-output-from-services">text output from Services</a>
that <a class="reference internal" href="ref-core.html#firebird.driver.core.Server" title="firebird.driver.core.Server"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server</span></code></a> provides .</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect_server</span>

<span class="n">trace_config</span> <span class="o">=</span> <span class="s2">"""database = %[</span><span class="se">\\</span><span class="s2">/]employee.fdb</span>
<span class="s2">{</span>
<span class="s2">    enabled = true</span>
<span class="s2">    log_statement_finish = true</span>
<span class="s2">    print_plan = true</span>
<span class="s2">    include_filter = </span><span class="si">%%</span><span class="s2">SELECT</span><span class="si">%%</span>
<span class="s2">    exclude_filter = </span><span class="si">%%</span><span class="s2">RDB$</span><span class="si">%%</span>
<span class="s2">    time_threshold = 0</span>
<span class="s2">    max_sql_length = 2048</span>
<span class="s2">}</span>
<span class="s2">"""</span>

<span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv</span><span class="p">:</span>
    <span class="n">trace_id</span> <span class="o">=</span> <span class="n">srv</span><span class="o">.</span><span class="n">trace</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">trace_config</span><span class="p">,</span><span class="s1">'test_trace_1'</span><span class="p">)</span>
    <span class="n">trace_log</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Get first 10 lines of trace output</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">trace_log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">srv</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
    <span class="c1"># Stop trace session</span>
    <span class="c1"># Because trace session blocks the connection, we need another one to stop trace session!</span>
    <span class="k">with</span> <span class="n">connect_server</span><span class="p">(</span><span class="s1">'localhost'</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">'SYSDBA'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">'masterkey'</span><span class="p">)</span> <span class="k">as</span> <span class="n">srv_aux</span><span class="p">:</span>
        <span class="n">srv_aux</span><span class="o">.</span><span class="n">trace</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">trace_id</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerTraceServices.stop" title="firebird.driver.core.ServerTraceServices.stop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerTraceServices.stop()</span></code></a> - Stop trace session.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerTraceServices.suspend" title="firebird.driver.core.ServerTraceServices.suspend"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerTraceServices.suspend()</span></code></a> - Suspend trace session.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerTraceServices.resume" title="firebird.driver.core.ServerTraceServices.resume"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerTraceServices.resume()</span></code></a> - Resume trace session.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.ServerTraceServices.sessions" title="firebird.driver.core.ServerTraceServices.sessions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerTraceServices.sessions</span></code></a> - Dictionary with active trace sessions. The key is session ID, value is <a class="reference internal" href="ref-types.html#firebird.driver.types.TraceSession" title="firebird.driver.types.TraceSession"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TraceSession</span></code></a> instance.</p></li>
</ul>
</section>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Logging driver activities"></a><section id="logging-driver-activities">
<span id="index-42"></span><h2>Logging driver activities<a class="headerlink" href="#logging-driver-activities" title="Permalink to this heading">¶</a></h2>
<p>The firebird-driver supports <a class="reference external" href="https://firebird-base.readthedocs.io/en/latest/logging.html#module-firebird.base.logging" title="(in Firebird-base v1.6.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">context-based</span> <span class="pre">logging</span> <span class="pre">system</span></code></a>
provided by <a class="reference external" href="https://firebird-base.rtfd.io">firebird-base</a> package through use of <a class="reference external" href="https://firebird-base.readthedocs.io/en/latest/logging.html#firebird.base.logging.LoggingIdMixin" title="(in Firebird-base v1.6.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LoggingIdMixin</span></code></a>.</p>
<p>Classes that use <a class="reference external" href="https://firebird-base.readthedocs.io/en/latest/logging.html#firebird.base.logging.LoggingIdMixin" title="(in Firebird-base v1.6.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LoggingIdMixin</span></code></a>:</p>
<ul class="simple">
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a> - Internally used objects have <code class="xref py py-obj docutils literal notranslate"><span class="pre">_logging_id_</span></code> set to ‘Transaction.Main’,
‘Transaction.Query’ and ‘Cursor.internal’. The log context is not defined.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager" title="firebird.driver.core.TransactionManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransactionManager</span></code></a> - The <code class="xref py py-obj docutils literal notranslate"><span class="pre">_logging_id_</span></code> is set to ‘Transaction’. The
<a class="reference internal" href="ref-core.html#firebird.driver.core.TransactionManager.log_context" title="firebird.driver.core.TransactionManager.log_context"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_context()</span></code></a> is the <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a>.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.DistributedTransactionManager" title="firebird.driver.core.DistributedTransactionManager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DistributedTransactionManager</span></code></a> - The <code class="xref py py-obj docutils literal notranslate"><span class="pre">_logging_id_</span></code> is set to ‘DTransaction’. The
<a class="reference internal" href="ref-core.html#firebird.driver.core.DistributedTransactionManager.log_context" title="firebird.driver.core.DistributedTransactionManager.log_context"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_context()</span></code></a> is <a class="reference external" href="https://firebird-base.readthedocs.io/en/latest/types.html#firebird.base.types.UNDEFINED" title="(in Firebird-base v1.6.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UNDEFINED</span></code></a>.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Statement" title="firebird.driver.core.Statement"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Statement</span></code></a> - The <a class="reference internal" href="ref-core.html#firebird.driver.core.Statement.log_context" title="firebird.driver.core.Statement.log_context"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_context()</span></code></a> is <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a>.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.BlobReader" title="firebird.driver.core.BlobReader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BlobReader</span></code></a> - The <a class="reference internal" href="ref-core.html#firebird.driver.core.Statement.log_context" title="firebird.driver.core.Statement.log_context"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_context()</span></code></a> is the owning object or <a class="reference external" href="https://firebird-base.readthedocs.io/en/latest/types.html#firebird.base.types.UNDEFINED" title="(in Firebird-base v1.6.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UNDEFINED</span></code></a>.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor" title="firebird.driver.core.Cursor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Cursor</span></code></a> - The <a class="reference internal" href="ref-core.html#firebird.driver.core.Cursor.log_context" title="firebird.driver.core.Cursor.log_context"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_context()</span></code></a> is <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a>.</p></li>
<li><p><a class="reference internal" href="ref-core.html#firebird.driver.core.Server" title="firebird.driver.core.Server"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server</span></code></a> - The log context is not defined.</p></li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">firebird.base.logging</span> <span class="kn">import</span> <span class="n">get_logger</span><span class="p">,</span> <span class="n">LogLevel</span>
<span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span><span class="p">,</span> <span class="n">driver_config</span>

<span class="c1"># Helper function</span>
<span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="n">cur</span><span class="p">:</span> <span class="n">Cursor</span><span class="p">,</span> <span class="n">cmd</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">get_logger</span><span class="p">(</span><span class="n">cur</span><span class="p">)</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Execute [</span><span class="si">{</span><span class="n">cmd</span><span class="si">=}</span><span class="s2">]"</span><span class="p">)</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

<span class="c1"># Basic Python logging configuration</span>
<span class="n">sh</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
<span class="n">sh</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="s1">'</span><span class="si">%(levelname)-10s</span><span class="s1">: [</span><span class="si">%(agent)s</span><span class="s1">][</span><span class="si">%(context)s</span><span class="s1">] </span><span class="si">%(message)s</span><span class="s1">'</span><span class="p">))</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">sh</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">LogLevel</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

<span class="c1"># Firebird driver configuration</span>
<span class="n">srv_cfg</span> <span class="o">=</span> <span class="s2">"""[local]</span>
<span class="s2">host = localhost</span>
<span class="s2">user = SYSDBA</span>
<span class="s2">password = masterkey</span>
<span class="s2">"""</span>
<span class="n">driver_config</span><span class="o">.</span><span class="n">register_server</span><span class="p">(</span><span class="s1">'local'</span><span class="p">,</span> <span class="n">srv_cfg</span><span class="p">)</span>
<span class="n">db_cfg</span> <span class="o">=</span> <span class="s2">"""[employee]</span>
<span class="s2">server = local</span>
<span class="s2">database = employee.fdb</span>
<span class="s2">protocol = inet</span>
<span class="s2">"""</span>
<span class="n">driver_config</span><span class="o">.</span><span class="n">register_database</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">db_cfg</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Default logging ids"</span><span class="p">)</span>
<span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">)</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
    <span class="n">con_log</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">(</span><span class="n">con</span><span class="p">)</span>
    <span class="n">con_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">'Start'</span><span class="p">)</span>
    <span class="n">cur1</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cur2</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">execute</span><span class="p">(</span><span class="n">cur1</span><span class="p">,</span> <span class="s1">'select * from country'</span><span class="p">)</span>
    <span class="n">execute</span><span class="p">(</span><span class="n">cur2</span><span class="p">,</span> <span class="s1">'select * from project'</span><span class="p">)</span>
    <span class="n">con_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">'Stop'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Custom logging ids"</span><span class="p">)</span>
<span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">)</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
    <span class="n">con</span><span class="o">.</span><span class="n">_logging_id_</span> <span class="o">=</span> <span class="s1">'employee-1'</span>
    <span class="n">con_log</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">(</span><span class="n">con</span><span class="p">)</span>
    <span class="n">con_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">'Start'</span><span class="p">)</span>
    <span class="n">cur1</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cur1</span><span class="o">.</span><span class="n">_logging_id_</span> <span class="o">=</span> <span class="s1">'cursor-1'</span>
    <span class="n">cur2</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cur2</span><span class="o">.</span><span class="n">_logging_id_</span> <span class="o">=</span> <span class="s1">'cursor-2'</span>
    <span class="n">execute</span><span class="p">(</span><span class="n">cur1</span><span class="p">,</span> <span class="s1">'select * from country'</span><span class="p">)</span>
    <span class="n">execute</span><span class="p">(</span><span class="n">cur2</span><span class="p">,</span> <span class="s1">'select * from project'</span><span class="p">)</span>
    <span class="n">con_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">'Stop'</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Default</span> <span class="n">logging</span> <span class="n">ids</span>
<span class="n">INFO</span>      <span class="p">:</span> <span class="p">[</span><span class="n">Connection</span><span class="p">][</span><span class="n">UNDEFINED</span><span class="p">]</span> <span class="n">Start</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">Cursor</span><span class="p">][</span><span class="n">Connection</span><span class="p">]</span> <span class="n">Execute</span> <span class="p">[</span><span class="n">cmd</span><span class="o">=</span><span class="s1">'select * from country'</span><span class="p">]</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">Cursor</span><span class="p">][</span><span class="n">Connection</span><span class="p">]</span> <span class="n">Execute</span> <span class="p">[</span><span class="n">cmd</span><span class="o">=</span><span class="s1">'select * from project'</span><span class="p">]</span>
<span class="n">INFO</span>      <span class="p">:</span> <span class="p">[</span><span class="n">Connection</span><span class="p">][</span><span class="n">UNDEFINED</span><span class="p">]</span> <span class="n">Stop</span>
<span class="n">Custom</span> <span class="n">logging</span> <span class="n">ids</span>
<span class="n">INFO</span>      <span class="p">:</span> <span class="p">[</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">UNDEFINED</span><span class="p">]</span> <span class="n">Start</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="n">Execute</span> <span class="p">[</span><span class="n">cmd</span><span class="o">=</span><span class="s1">'select * from country'</span><span class="p">]</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="n">Execute</span> <span class="p">[</span><span class="n">cmd</span><span class="o">=</span><span class="s1">'select * from project'</span><span class="p">]</span>
<span class="n">INFO</span>      <span class="p">:</span> <span class="p">[</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">UNDEFINED</span><span class="p">]</span> <span class="n">Stop</span>
</pre></div>
</div>
<p>You can also trace the driver activities using <a class="reference external" href="https://firebird-base.readthedocs.io/en/latest/trace.html#module-firebird.base.trace" title="(in Firebird-base v1.6.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trace/audit</span> <span class="pre">for</span> <span class="pre">class</span> <span class="pre">instances</span></code></a>
provided by <a class="reference external" href="https://firebird-base.rtfd.io">firebird-base</a> package.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">firebird.base.logging</span> <span class="kn">import</span> <span class="n">get_logger</span><span class="p">,</span> <span class="n">LogLevel</span>
<span class="kn">from</span> <span class="nn">firebird.base.trace</span> <span class="kn">import</span> <span class="n">trace_manager</span><span class="p">,</span> <span class="n">add_trace</span><span class="p">,</span> <span class="n">trace_object</span><span class="p">,</span> <span class="n">traced</span><span class="p">,</span> <span class="n">TraceFlag</span>
<span class="kn">from</span> <span class="nn">firebird.driver</span> <span class="kn">import</span> <span class="n">connect</span><span class="p">,</span> <span class="n">driver_config</span>
<span class="kn">from</span> <span class="nn">firebird.driver.core</span> <span class="kn">import</span> <span class="n">TransactionManager</span>

<span class="c1"># Helper function</span>
<span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="n">cur</span><span class="p">:</span> <span class="n">Cursor</span><span class="p">,</span> <span class="n">cmd</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

<span class="c1"># Basic Python logging configuration</span>
<span class="n">sh</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
<span class="n">sh</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="s1">'</span><span class="si">%(levelname)-10s</span><span class="s1">: [</span><span class="si">%(agent)s</span><span class="s1">][</span><span class="si">%(context)s</span><span class="s1">] </span><span class="si">%(message)s</span><span class="s1">'</span><span class="p">))</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">sh</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">LogLevel</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

<span class="c1"># Firebird driver configuration</span>
<span class="n">srv_cfg</span> <span class="o">=</span> <span class="s2">"""[local]</span>
<span class="s2">host = localhost</span>
<span class="s2">user = SYSDBA</span>
<span class="s2">password = masterkey</span>
<span class="s2">"""</span>
<span class="n">driver_config</span><span class="o">.</span><span class="n">register_server</span><span class="p">(</span><span class="s1">'local'</span><span class="p">,</span> <span class="n">srv_cfg</span><span class="p">)</span>
<span class="n">db_cfg</span> <span class="o">=</span> <span class="s2">"""[employee]</span>
<span class="s2">server = local</span>
<span class="s2">database = employee.fdb</span>
<span class="s2">protocol = inet</span>
<span class="s2">"""</span>
<span class="n">driver_config</span><span class="o">.</span><span class="n">register_database</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">,</span> <span class="n">db_cfg</span><span class="p">)</span>

<span class="c1"># Trace configuration</span>
<span class="c1"># First: register classes and methods that could be traced</span>
<span class="n">trace_manager</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Connection</span><span class="p">)</span>
<span class="n">add_trace</span><span class="p">(</span><span class="n">Connection</span><span class="p">,</span> <span class="s1">'close'</span><span class="p">,</span> <span class="n">traced</span><span class="p">)</span>
<span class="n">trace_manager</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">TransactionManager</span><span class="p">)</span>
<span class="n">add_trace</span><span class="p">(</span><span class="n">TransactionManager</span><span class="p">,</span> <span class="s1">'begin'</span><span class="p">,</span> <span class="n">traced</span><span class="p">)</span>
<span class="n">add_trace</span><span class="p">(</span><span class="n">TransactionManager</span><span class="p">,</span> <span class="s1">'commit'</span><span class="p">,</span> <span class="n">traced</span><span class="p">)</span>
<span class="n">add_trace</span><span class="p">(</span><span class="n">TransactionManager</span><span class="p">,</span> <span class="s1">'rollback'</span><span class="p">,</span> <span class="n">traced</span><span class="p">)</span>
<span class="n">trace_manager</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Cursor</span><span class="p">)</span>
<span class="n">add_trace</span><span class="p">(</span><span class="n">Cursor</span><span class="p">,</span> <span class="s1">'execute'</span><span class="p">,</span> <span class="n">traced</span><span class="p">)</span>
<span class="n">add_trace</span><span class="p">(</span><span class="n">Cursor</span><span class="p">,</span> <span class="s1">'close'</span><span class="p">,</span> <span class="n">traced</span><span class="p">)</span>
<span class="c1"># Activate trace/audit</span>
<span class="n">trace_manager</span><span class="o">.</span><span class="n">trace</span> <span class="o">|=</span> <span class="p">(</span><span class="n">TraceFlag</span><span class="o">.</span><span class="n">ACTIVE</span> <span class="o">|</span> <span class="n">TraceFlag</span><span class="o">.</span><span class="n">BEFORE</span> <span class="o">|</span> <span class="n">TraceFlag</span><span class="o">.</span><span class="n">AFTER</span> <span class="o">|</span> <span class="n">TraceFlag</span><span class="o">.</span><span class="n">FAIL</span><span class="p">)</span>

<span class="c1"># Traced code</span>
<span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s1">'employee'</span><span class="p">)</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
    <span class="n">trace_object</span><span class="p">(</span><span class="n">con</span><span class="p">)</span>
    <span class="n">trace_object</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">main_transaction</span><span class="p">)</span>
    <span class="n">con</span><span class="o">.</span><span class="n">_logging_id_</span> <span class="o">=</span> <span class="s1">'employee-1'</span>
    <span class="n">cur1</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">trace_object</span><span class="p">(</span><span class="n">cur1</span><span class="p">)</span>
    <span class="n">cur1</span><span class="o">.</span><span class="n">_logging_id_</span> <span class="o">=</span> <span class="s1">'cursor-1'</span>
    <span class="n">cur2</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">trace_object</span><span class="p">(</span><span class="n">cur2</span><span class="p">)</span>
    <span class="n">cur2</span><span class="o">.</span><span class="n">_logging_id_</span> <span class="o">=</span> <span class="s1">'cursor-2'</span>
    <span class="n">execute</span><span class="p">(</span><span class="n">cur1</span><span class="p">,</span> <span class="s1">'select * from country'</span><span class="p">)</span>
    <span class="n">execute</span><span class="p">(</span><span class="n">cur2</span><span class="p">,</span> <span class="s1">'select * from project'</span><span class="p">)</span>
    <span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<p>Sample output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">execute</span><span class="p">(</span><span class="n">operation</span><span class="o">=</span><span class="s1">'select * from country'</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">Transaction</span><span class="o">.</span><span class="n">Main</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">begin</span><span class="p">(</span><span class="n">tpb</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">Transaction</span><span class="o">.</span><span class="n">Main</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;&lt;</span> <span class="n">begin</span><span class="p">[</span><span class="mf">0.00672</span><span class="p">]</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">close</span><span class="p">()</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;&lt;</span> <span class="n">close</span><span class="p">[</span><span class="mf">0.00004</span><span class="p">]</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;&lt;</span> <span class="n">execute</span><span class="p">[</span><span class="mf">0.01119</span><span class="p">]</span> <span class="n">Result</span><span class="p">:</span> <span class="n">cursor</span><span class="o">-</span><span class="mi">1</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">execute</span><span class="p">(</span><span class="n">operation</span><span class="o">=</span><span class="s1">'select * from project'</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">close</span><span class="p">()</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;&lt;</span> <span class="n">close</span><span class="p">[</span><span class="mf">0.00002</span><span class="p">]</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;&lt;</span> <span class="n">execute</span><span class="p">[</span><span class="mf">0.00352</span><span class="p">]</span> <span class="n">Result</span><span class="p">:</span> <span class="n">cursor</span><span class="o">-</span><span class="mi">2</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">Transaction</span><span class="o">.</span><span class="n">Main</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">commit</span><span class="p">(</span><span class="n">retaining</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">close</span><span class="p">()</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;&lt;</span> <span class="n">close</span><span class="p">[</span><span class="mf">0.00017</span><span class="p">]</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">close</span><span class="p">()</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;&lt;</span> <span class="n">close</span><span class="p">[</span><span class="mf">0.00012</span><span class="p">]</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">Transaction</span><span class="o">.</span><span class="n">Main</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;&lt;</span> <span class="n">commit</span><span class="p">[</span><span class="mf">0.00225</span><span class="p">]</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">UNDEFINED</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">close</span><span class="p">()</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">UNDEFINED</span><span class="p">]</span> <span class="o">&lt;&lt;&lt;</span> <span class="n">close</span><span class="p">[</span><span class="mf">0.00764</span><span class="p">]</span>
</pre></div>
</div>
<p>If you will remove the <code class="xref py py-obj docutils literal notranslate"><span class="pre">con.commit()</span></code> from the example above, the output will change to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">execute</span><span class="p">(</span><span class="n">operation</span><span class="o">=</span><span class="s1">'select * from country'</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">Transaction</span><span class="o">.</span><span class="n">Main</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">begin</span><span class="p">(</span><span class="n">tpb</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">Transaction</span><span class="o">.</span><span class="n">Main</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;&lt;</span> <span class="n">begin</span><span class="p">[</span><span class="mf">0.00338</span><span class="p">]</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">close</span><span class="p">()</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;&lt;</span> <span class="n">close</span><span class="p">[</span><span class="mf">0.00003</span><span class="p">]</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;&lt;</span> <span class="n">execute</span><span class="p">[</span><span class="mf">0.00730</span><span class="p">]</span> <span class="n">Result</span><span class="p">:</span> <span class="n">cursor</span><span class="o">-</span><span class="mi">1</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">execute</span><span class="p">(</span><span class="n">operation</span><span class="o">=</span><span class="s1">'select * from project'</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">close</span><span class="p">()</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;&lt;</span> <span class="n">close</span><span class="p">[</span><span class="mf">0.00003</span><span class="p">]</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;&lt;</span> <span class="n">execute</span><span class="p">[</span><span class="mf">0.00345</span><span class="p">]</span> <span class="n">Result</span><span class="p">:</span> <span class="n">cursor</span><span class="o">-</span><span class="mi">2</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">UNDEFINED</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">close</span><span class="p">()</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">Transaction</span><span class="o">.</span><span class="n">Main</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">rollback</span><span class="p">(</span><span class="n">retaining</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">savepoint</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">close</span><span class="p">()</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;&lt;</span> <span class="n">close</span><span class="p">[</span><span class="mf">0.00016</span><span class="p">]</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;&gt;</span> <span class="n">close</span><span class="p">()</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">cursor</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;&lt;</span> <span class="n">close</span><span class="p">[</span><span class="mf">0.00014</span><span class="p">]</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">Transaction</span><span class="o">.</span><span class="n">Main</span><span class="p">][</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;&lt;</span> <span class="n">rollback</span><span class="p">[</span><span class="mf">0.00171</span><span class="p">]</span>
<span class="n">DEBUG</span>     <span class="p">:</span> <span class="p">[</span><span class="n">employee</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">UNDEFINED</span><span class="p">]</span> <span class="o">&lt;&lt;&lt;</span> <span class="n">close</span><span class="p">[</span><span class="mf">0.01001</span><span class="p">]</span>
</pre></div>
</div>
<a class="dashAnchor" name="//apple_ref/cpp/Section/driver-hooks"></a><span class="target" id="driver-hooks"></span></section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/Driver hooks"></a><section id="index-43">
<span id="id11"></span><h2>Driver hooks<a class="headerlink" href="#index-43" title="Permalink to this heading">¶</a></h2>
<p>The firebird-driver uses <a class="reference external" href="https://firebird-base.readthedocs.io/en/latest/hooks.html#module-firebird.base.hooks" title="(in Firebird-base v1.6.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hook</span> <span class="pre">manager</span></code></a> from <a class="reference external" href="https://firebird-base.rtfd.io">firebird-base</a> package
to provide internal notification mechanism that allows installation of custom hooks into
certain driver tasks.</p>
<p>Driver hooks are divided into several types exposed as enums in <a class="reference internal" href="ref-hooks.html#module-firebird.driver.hooks" title="firebird.driver.hooks: Drivers hooks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">firebird.driver.hooks</span></code></a> module.</p>
<a class="dashAnchor" name="//apple_ref/cpp/Section/APIHook"></a><section id="apihook">
<h3>APIHook<a class="headerlink" href="#apihook" title="Permalink to this heading">¶</a></h3>
<p><a class="reference internal" href="ref-hooks.html#firebird.driver.hooks.APIHook.LOADED" title="firebird.driver.hooks.APIHook.LOADED"><code class="xref py py-obj docutils literal notranslate"><span class="pre">APIHook.LOADED</span></code></a> - This hook is invoked once when instance of <a class="reference internal" href="ref-fbapi.html#firebird.driver.fbapi.FirebirdAPI" title="firebird.driver.fbapi.FirebirdAPI"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FirebirdAPI</span></code></a> is created.
It could be used for additional initialization tasks that require Firebird API, or to manipulate
the FirebirdAPI instance itself before its use.</p>
<p>Hook routine must have signature: <code class="xref py py-obj docutils literal notranslate"><span class="pre">hook_func(api:</span> <span class="pre">FirebirdAPI)</span> <span class="pre">-&gt;</span> <span class="pre">None</span></code>. Any value returned
by hook is ignored.</p>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/ConnectionHook"></a><section id="connectionhook">
<h3>ConnectionHook<a class="headerlink" href="#connectionhook" title="Permalink to this heading">¶</a></h3>
<ul>
<li><p><a class="reference internal" href="ref-hooks.html#firebird.driver.hooks.ConnectionHook.ATTACH_REQUEST" title="firebird.driver.hooks.ConnectionHook.ATTACH_REQUEST"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ConnectionHook.ATTACH_REQUEST</span></code></a></p>
<p>This hook is invoked after all parameters are preprocessed and before <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a> is created.</p>
<p>Hook routine must have signature: <code class="xref py py-obj docutils literal notranslate"><span class="pre">hook_func(dsn:</span> <span class="pre">str,</span> <span class="pre">dpb:</span> <span class="pre">bytes)</span> <span class="pre">-&gt;</span> <span class="pre">Optional[Connection]</span></code>
where <code class="xref py py-obj docutils literal notranslate"><span class="pre">dpb</span></code> is Database Parameter Buffer that would be used to create the attachment to the
database defined by <code class="xref py py-obj docutils literal notranslate"><span class="pre">dsn</span></code>. It may return <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a> (or subclass) instance or <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>.</p>
<p>First instance returned by any hook of this type will become the return value of caller function
and other hooks of the same type are not invoked.</p>
</li>
<li><p><a class="reference internal" href="ref-hooks.html#firebird.driver.hooks.ConnectionHook.ATTACHED" title="firebird.driver.hooks.ConnectionHook.ATTACHED"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ConnectionHook.ATTACHED</span></code></a></p>
<p>This hook is invoked just before <a class="reference internal" href="ref-core.html#firebird.driver.core.Connection" title="firebird.driver.core.Connection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Connection</span></code></a> (or subclass) instance is returned to the client
application.</p>
<p>Hook routine must have signature: <code class="xref py py-obj docutils literal notranslate"><span class="pre">hook_func(con:</span> <span class="pre">Connection)</span> <span class="pre">-&gt;</span> <span class="pre">None</span></code>.</p>
</li>
<li><p><a class="reference internal" href="ref-hooks.html#firebird.driver.hooks.ConnectionHook.DETACH_REQUEST" title="firebird.driver.hooks.ConnectionHook.DETACH_REQUEST"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ConnectionHook.DETACH_REQUEST</span></code></a></p>
<p>This hook is invoked before connection is closed.</p>
<p>Hook must have signature: <code class="xref py py-obj docutils literal notranslate"><span class="pre">hook_func(con:</span> <span class="pre">Connection)</span> <span class="pre">-&gt;</span> <span class="pre">None</span></code>.</p>
<p>If any hook function returns True, connection is not closed.</p>
</li>
<li><p><a class="reference internal" href="ref-hooks.html#firebird.driver.hooks.ConnectionHook.CLOSED" title="firebird.driver.hooks.ConnectionHook.CLOSED"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ConnectionHook.CLOSED</span></code></a></p>
<p>This hook is invoked after connection is closed.</p>
<p>Hook routine must have signature: <code class="xref py py-obj docutils literal notranslate"><span class="pre">hook_func(con:</span> <span class="pre">Connection)</span> <span class="pre">-&gt;</span> <span class="pre">None</span></code>.</p>
</li>
<li><p><a class="reference internal" href="ref-hooks.html#firebird.driver.hooks.ConnectionHook.DROPPED" title="firebird.driver.hooks.ConnectionHook.DROPPED"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ConnectionHook.DROPPED</span></code></a></p>
<p>This hook is invoked after database is dropped (and connection is closed).</p>
<p>Hook routine must have signature: <code class="xref py py-obj docutils literal notranslate"><span class="pre">hook_func(con:</span> <span class="pre">Connection)</span> <span class="pre">-&gt;</span> <span class="pre">None</span></code>.</p>
</li>
</ul>
</section>
<a class="dashAnchor" name="//apple_ref/cpp/Section/ServerHook"></a><section id="serverhook">
<h3>ServerHook<a class="headerlink" href="#serverhook" title="Permalink to this heading">¶</a></h3>
<ul>
<li><p><a class="reference internal" href="ref-hooks.html#firebird.driver.hooks.ServerHook.ATTACHED" title="firebird.driver.hooks.ServerHook.ATTACHED"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ServerHook.ATTACHED</span></code></a></p>
<p>This hook is invoked before <a class="reference internal" href="ref-core.html#firebird.driver.core.Server" title="firebird.driver.core.Server"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Server</span></code></a> instance is returned.</p>
<p>Hook routine must have signature: <code class="xref py py-obj docutils literal notranslate"><span class="pre">hook_func(srv:</span> <span class="pre">Server)</span> <span class="pre">-&gt;</span> <span class="pre">None</span></code>.</p>
</li>
</ul>
</section>
</section>
</section>
</div>
</div>
</div>
<footer class="footer">
<div class="container">
<p class="pull-right">
<a href="#">Back to top</a>
</p>
<p>
        © Copyright 2020-2023, The Firebird Project.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.0.1.<br/>
</p>
</div>
</footer>
</body>
</html>